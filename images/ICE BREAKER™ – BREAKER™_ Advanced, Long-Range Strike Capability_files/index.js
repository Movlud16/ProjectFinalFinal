// 2.0.12
(function(){"use strict";(function(a,t){try{if(typeof document<"u"){const e=document.createElement("style");e.id="d-id-agent-style";for(const i in t.attributes)e.setAttribute(i,t.attributes[i]);e.appendChild(document.createTextNode(a)),document.head.appendChild(e)}}catch(e){console.error("vite-plugin-css-injected-by-js",e)}})('.didagent__maskedicon{-webkit-mask:var(--mask-url) no-repeat center;mask:var(--mask-url) no-repeat center;background-color:var(--color);-webkit-mask-size:contain;mask-size:contain;width:var(--width, var(--size, 24px));height:var(--size, var(--height, 24px));padding:var(--padding);margin:var(--margin);-webkit-transform:rotate(var(--rotation, 0deg));-ms-transform:rotate(var(--rotation, 0deg));transform:rotate(var(--rotation, 0deg));display:block;-webkit-transition:background-color .1s ease-in-out,-webkit-transform .2s ease-in-out;transition:background-color .1s ease-in-out,-webkit-transform .2s ease-in-out;transition:transform .2s ease-in-out,background-color .1s ease-in-out;transition:transform .2s ease-in-out,background-color .1s ease-in-out,-webkit-transform .2s ease-in-out}.didagent__chat__button{outline:none;border:none;background:none}.didagent__button{background:#1d1d1dcc;color:#fff;border-radius:8px;-webkit-box-flex:0;-ms-flex:none;cursor:pointer;z-index:1;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;outline:none;border:none;flex:none;position:relative}.didagent__button:disabled{cursor:not-allowed}.didagent__button[data-active=true]{background:#fff;color:#090604}.didagent__button__dark{background:#1d1d1dcc;-webkit-transition:background .2s ease;transition:background .2s ease}.didagent__button__dark:hover{background:#1d1d1d}.didagent__button__disabled{opacity:.7}.didagent__button__disabled:hover{background:#1d1d1dcc}.didagent__light__opacity__hover{opacity:.7;-webkit-transition:opacity .2s ease;transition:opacity .2s ease}.didagent__light__opacity__hover:hover{opacity:1}.didagent__button__badge{display:-webkit-box;display:-ms-flexbox;display:flex;width:24px;height:24px;padding:7px 0;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border-radius:100%;position:absolute;top:-2px;right:-2px}.didagent__button__warning{background:#ff882eb3}.didagent__button__warning>.didagent__button__badge{background:#ff882e;z-index:1}.didagent__button__blurred{-webkit-filter:blur(5px);filter:blur(5px);pointer-events:none}.didagent__button__controller{height:52px;width:52px;border-radius:50%}.didagent__button__nested__controller{border-radius:50%;height:24px;width:24px;padding:0;background:transparent;-webkit-backdrop-filter:none;backdrop-filter:none}.didagent__button__nested__big{height:38px;width:38px}.didagent__button__extended__controller{width:auto;height:52px;border-radius:26px}.didagent__button__header{height:32px;width:32px;padding:4px}.didagent__button__extended__header{height:32px;width:auto;border-radius:16px}.didagent__link__notification__badge{position:absolute;top:10px;right:8px;z-index:1;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.didagent__wave__container{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;height:23px;z-index:1}.wave{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;gap:4px;height:23px}.bar{border-radius:4px;width:2px;height:2px;background-color:#fff;-webkit-transition:height .1s ease-in-out;transition:height .1s ease-in-out}.didagent__button__response__active{color:var(--Blacks-400, #b8b8b8);text-align:center;font-size:12px;font-style:normal;font-weight:400;line-height:130%;width:163px;-ms-flex-negative:0;flex-shrink:0}.didagent__button__response__active{opacity:0;-webkit-animation:didagentFadeIn .2s ease-in forwards;animation:didagentFadeIn .2s ease-in forwards}.didagaent__wave__container{width:153px;height:52px;border-radius:26px;cursor:auto}.didagent__banner{margin:0 auto;max-width:calc(100% - 24px);-webkit-box-align:center;-ms-flex-align:center;display:-webkit-box;display:-ms-flexbox;display:flex;padding:12px;align-items:center;gap:8px;border-radius:8px;opacity:.85;background:var(--Secondary-Primary, #090604)}.didagent__banner__icon__container{display:-webkit-box;display:-ms-flexbox;display:flex;padding:4px 0;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start;gap:8px;-ms-flex-item-align:stretch;align-self:stretch;color:#fff}.didagent__banner__text__container{color:var(--Blacks-White, #fff);font-size:14px;font-style:normal;font-weight:400;line-height:20px}.didagent__tooltip{position:relative}.didagent__tooltip .didagent__tooltip__content{visibility:hidden;width:302px;background-color:#090604;color:#fff;border-radius:8px;padding:12px;font-size:12px;position:absolute;z-index:1;bottom:65px;right:-130px;text-align:left;opacity:0;-webkit-transform:translateY(10px);-ms-transform:translateY(10px);transform:translateY(10px);-webkit-transition:opacity .3s ease,-webkit-transform .3s ease;transition:opacity .3s ease,-webkit-transform .3s ease;transition:opacity .3s ease,transform .3s ease;transition:opacity .3s ease,transform .3s ease,-webkit-transform .3s ease}@media (min-width: 768px){.didagent__tooltip__hover:hover .didagent__tooltip__content{visibility:visible;opacity:1;-webkit-transform:translateY(0);-ms-transform:translateY(0);transform:translateY(0)}}.didagent__tooltip__persistent .didagent__tooltip__content{visibility:visible;opacity:1;-webkit-transform:translateY(0);-ms-transform:translateY(0);transform:translateY(0)}.didagent__tooltip__link .didagent__tooltip__content{background:#fff;color:#090604;border-radius:8px;padding:8px 12px;-webkit-box-shadow:.3px .8px 1.1px 0px rgba(187,187,187,.12),1.1px 2.8px 3.9px -.4px rgba(187,187,187,.17),2.4px 6.1px 8.6px -.8px rgba(187,187,187,.23),5.3px 13.3px 18.8px -1.2px rgba(187,187,187,.29);box-shadow:.3px .8px 1.1px #bbbbbb1f,1.1px 2.8px 3.9px -.4px #bbbbbb2b,2.4px 6.1px 8.6px -.8px #bbbbbb3b,5.3px 13.3px 18.8px -1.2px #bbbbbb4a;width:auto;min-width:120px;max-width:200px;font-family:Manrope,sans-serif;font-size:12px;font-weight:400;line-height:16px;letter-spacing:-.12px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;gap:4px;bottom:65px;left:50%;right:auto;-webkit-transform:translateX(-50%) translateY(0);-ms-transform:translateX(-50%) translateY(0);transform:translate(-50%) translateY(0);cursor:pointer;text-decoration:none}.didagent__tooltip__link .didagent__tooltip__content>div{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;gap:4px;width:100%}.didagent__tooltip__link .didagent__tooltip__content span{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;-webkit-box-flex:1;-ms-flex:1;flex:1;min-width:0}.didagent__tooltip__link__icon{width:12px;height:12px;-ms-flex-negative:0;flex-shrink:0}.didagent__tooltip__link .didagent__tooltip__content:after{content:"";position:absolute;bottom:-6px;left:50%;width:12px;height:12px;background:#fff;-webkit-transform:translateX(-50%) rotate(45deg);-ms-transform:translateX(-50%) rotate(45deg);transform:translate(-50%) rotate(45deg);-webkit-box-shadow:.3px .8px 1.1px 0px rgba(187,187,187,.12),1.1px 2.8px 3.9px -.4px rgba(187,187,187,.17),2.4px 6.1px 8.6px -.8px rgba(187,187,187,.23),5.3px 13.3px 18.8px -1.2px rgba(187,187,187,.29);box-shadow:.3px .8px 1.1px #bbbbbb1f,1.1px 2.8px 3.9px -.4px #bbbbbb2b,2.4px 6.1px 8.6px -.8px #bbbbbb3b,5.3px 13.3px 18.8px -1.2px #bbbbbb4a}.didagent__button__controller__with__label{height:52px;width:auto;border-radius:25px;gap:8px;padding:0 36px}.didagent__button__controller__with__label>span{text-shadow:0px 1px 2px rgba(0,0,0,.15);font-size:14px;font-style:normal;font-weight:500;line-height:24px}.didagent__info_message_agent_unavailable_container{height:100%}.didagent__info_message_agent_unavailable_danger{width:100%;height:100%;z-index:2;margin-bottom:-4px;color:#fff;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;font-weight:500;font-size:12px;opacity:.85;background-color:var(--did-secondary-main);border-radius:8px;padding:0 8px;gap:8px;overflow:auto}.didagent__info_message_agent_unavailable_danger svg{color:var(--did-danger-main);display:-webkit-box;display:-ms-flexbox;display:flex;width:16px;height:16px;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.didagent__info_message_agent_unavailable_danger pre{margin:0 0 2px;white-space:pre-wrap}.didagent__info_message_agent_unavailable_message{display:-webkit-box;display:-ms-flexbox;display:flex;margin:0;-ms-flex-negative:0;flex-shrink:0;white-space:break-spaces;word-wrap:break-word;font-size:12px;-webkit-box-sizing:border-box;box-sizing:border-box;background:var(--did-secondary-main);opacity:.8;border-radius:4px;padding:4px;color:#fff;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.didagent__info_message_indication{background:var(--did-secondary-main);display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:#fff;margin:0;border-radius:8px;padding-left:10px;max-width:70%}.didagent__info_message_indication pre{font-family:Inter,system-ui,Avenir,Helvetica,sans-serif;font-size:14px;white-space:pre-wrap;padding:10px 10px 10px 8px;width:90%}.didagent__info_message_indication svg{margin-left:8px}@-webkit-keyframes fadeIn{0%{opacity:0;-webkit-transform:translateY(-10px);transform:translateY(-10px)}to{opacity:.8;-webkit-transform:translateY(0);transform:translateY(0)}}@keyframes fadeIn{0%{opacity:0;-webkit-transform:translateY(-10px);transform:translateY(-10px)}to{opacity:.8;-webkit-transform:translateY(0);transform:translateY(0)}}@-webkit-keyframes fadeOut{0%{opacity:.8;-webkit-transform:translateY(0);transform:translateY(0)}to{opacity:0;-webkit-transform:translateY(-10px);transform:translateY(-10px)}}@keyframes fadeOut{0%{opacity:.8;-webkit-transform:translateY(0);transform:translateY(0)}to{opacity:0;-webkit-transform:translateY(-10px);transform:translateY(-10px)}}.fade-in{-webkit-animation:fadeIn .5s forwards;animation:fadeIn .5s forwards}.fade-out{-webkit-animation:fadeOut .5s forwards;animation:fadeOut .5s forwards}.didagaent__send__button{display:-webkit-box;display:-ms-flexbox;display:flex;height:32px;width:32px;aspect-ratio:1;outline:none;border:none;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border-radius:var(--1, 8px);-webkit-box-shadow:0px 2.909px 2.909px 0px rgba(0,0,0,.07);box-shadow:0 2.909px 2.909px #00000012;-webkit-transition:background-color .1s ease-out;transition:background-color .1s ease-out;background-color:#090604;border-radius:50%}.didagaent__send__button:hover{background-color:#2b2a28}.didagaent__send__button:not(:disabled){cursor:pointer}.didagaent__send__button:disabled{background:var(--Secondary-Primary, #090604);cursor:not-allowed;opacity:.5}.didagaent__send__button>svg{-ms-flex-negative:0;flex-shrink:0}.didagaent__send__button_actions:hover{background:#2b2a28;opacity:.8}.didagaent__send__button_actions:active{opacity:.5}.didagaent__send__button.didagaent__send__button__loader{background:var(--Secondary-Primary, #090604);opacity:1;-webkit-animation:spin 1s linear infinite;animation:spin 1s linear infinite}@-webkit-keyframes spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0)}to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0)}to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}.didagaent__send__button__record{background:#fff9}.didagaent__send__button__record:hover{background-color:#fff}.didagaent__send__button__record:disabled{opacity:.5}.didagaent__send__button__reload{background:var(--did-secondary-main)}.didagent__thumb__container{--flip-y: 1;--hover-color: var(--did-primary-black-00030);--color: var(--did-primary-black-00012);--cursor: pointer;cursor:var(--cursor);-webkit-transform:scaleY(var(--flip-y));-ms-transform:scaleY(var(--flip-y));transform:scaleY(var(--flip-y));border-radius:4px;border:none;background:none;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;line-height:1;padding:2px}.didagent__thumb__container[data-active=true],.didagent__thumb__container:hover{background-color:#f3f3f3}.didagent__thumb__container:disabled{cursor:default;opacity:.6}.appear-animation{opacity:1}.appear-animation span{opacity:0;-webkit-animation:character-appear .3s ease-out forwards;animation:character-appear .3s ease-out forwards}@-webkit-keyframes character-appear{0%{opacity:0}to{opacity:1}}@keyframes character-appear{0%{opacity:0}to{opacity:1}}.didagent__messages__wrapper{padding:16px;gap:8px;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;display:-webkit-box;display:-ms-flexbox;display:flex}.didagent__messages__wrapper .didagent__message__container{position:relative;min-width:50px;max-width:75%;-webkit-user-select:auto;-moz-user-select:auto;-ms-user-select:auto;user-select:auto;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.didagent__messages__wrapper .didagent__message__container .didagent__message{-webkit-box-sizing:border-box;box-sizing:border-box;padding:10px;font-family:inherit;margin:0;-ms-flex-negative:0;flex-shrink:0;white-space:pre-line;word-wrap:break-word;font-size:.875em;max-width:100%;cursor:text}.didagent__messages__wrapper .didagent__message__container .didagent__message__user{border-radius:14px;background:var(--blacks-100, #f3f3f3);display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;padding:10px 16px;-webkit-box-align:center;-ms-flex-align:center;align-items:center;gap:10px;font-size:14px;font-style:normal;font-weight:400;color:var(--Secondary-Primary, #090604);line-height:150%}.didagent__messages__wrapper .didagent__message__container .didagent__message__assistant{border-radius:0 16px 16px;border:1px solid var(--Blacks-300, #dbdbdb);background:var(--Blacks-0, #fff);font-size:14px;font-style:normal;font-weight:400;line-height:150%;min-height:43px;min-width:60px}.didagent__messages__wrapper .didagent__message__container .didagent__message__assistant:has(.didagent__empty__message){display:none}.didagent__messages__wrapper .didagent__message__container .didagent__message__assistant__loader{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding-left:14px;gap:8px;min-height:43px;min-width:60px}.didagent__messages__wrapper .didagent__message__container .didagent__message__url{color:#497cff}.didagent__messages__wrapper .didagent__message__container:hover .didagent__message__rating{display:-webkit-box;display:-ms-flexbox;display:flex}.didagent__messages__wrapper .didagent__message__container .didagent__message__rating{display:none;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;gap:6px;-webkit-transition:opacity .2s ease-in-out;transition:opacity .2s ease-in-out;margin-bottom:-6px}.didagent__messages__wrapper .didagent__message__container__assistant{margin-right:auto}.didagent__messages__wrapper .didagent__message__container__user{margin-left:auto}.didagent__messages__wrapper .didagent__message__container_loader{opacity:0;position:absolute}.didagent__messages__wrapper .didagent__message__container_loader.didagent__message__container__assistant__loading{opacity:0;position:unset;-webkit-animation:fadeIn .3s ease-in-out .7s forwards;animation:fadeIn .3s ease-in-out .7s forwards}@-webkit-keyframes fadeIn{0%{opacity:0}to{opacity:1}}@keyframes fadeIn{0%{opacity:0}to{opacity:1}}.didagent__messages__container{font-family:Inter,system-ui,Avenir,Helvetica,sans-serif;opacity:0;-webkit-transition:opacity .2s ease,height .3s ease,width .3s ease;transition:opacity .2s ease,height .3s ease,width .3s ease;background:#fff;color:#000;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;overflow:hidden}.didagent__messages__container .didagent__messages__scrollable{gap:8px;-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text;overflow-x:hidden;overflow-y:scroll;width:100%;height:100%;background-color:#fff;z-index:1}.didagent__messages__container .didagent__messages__scrollable::-webkit-scrollbar{display:none}.didagent__messages__container[data-chat=closed-bottom],.didagent__messages__container[data-chat=closed-side]{pointer-events:none}.didagent__messages__container[data-chat=closed-side]{position:absolute;height:100%;right:0}.didagent__messages__container[data-chat=closed-bottom]{height:0;left:0;right:0;bottom:0;border-top-left-radius:24px;border-top-right-radius:24px;width:100%}.didagent__messages__container:not([data-chat=closed-bottom],[data-chat=closed-side]){opacity:1;padding-bottom:67px;-webkit-transition:opacity .2s ease,height .3s ease,width .3s ease;transition:opacity .2s ease,height .3s ease,width .3s ease}.didagent__messages__container[data-chat=side]{position:absolute;z-index:10;right:0;width:max(328px,min(33.33vw,424px));height:-webkit-fill-available;border-left:1px solid var(--did-primary-black-300)}.didagent__messages__container[data-chat=bottom]{left:0;right:0;bottom:0;border-top-left-radius:24px;border-top-right-radius:24px;height:min(50%,322px);width:100%}.didagent__messages__container[data-chatmode=Playground][data-chat=bottom]{height:calc(100% - 65px + 68px - (var(--didWidth) * (9 / 16)));border-top-left-radius:0;border-top-right-radius:0}.didagent__messages__footer{position:absolute;bottom:0;left:0;right:0;z-index:1;padding:0 12px;height:67px;background-color:#fff;border-top:1px solid var(--Blacks-300, #dbdbdb);display:-webkit-box;display:-ms-flexbox;display:flex}.didagent__messages__header{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:16px;position:sticky;top:0;z-index:1;background:#fff;border-bottom:1px solid var(--Blacks-300, #dbdbdb)}.didagent__messages__header .didagent__messages__header__title{color:#010101;-webkit-font-feature-settings:"liga" off,"clig" off;font-feature-settings:"liga" off,"clig" off;font-family:Inter,system-ui,Avenir,Helvetica,sans-serif;font-size:14px;font-style:normal;font-weight:500;line-height:24px}.didagent__messages__header svg{cursor:pointer}.didagent__main__input{width:100%;height:100%;-ms-flex-item-align:center;align-self:center;position:relative;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;gap:12px;-webkit-box-sizing:border-box;box-sizing:border-box}.didagent__main__input>textarea{width:100%;height:auto;max-height:100%;border:none;outline:none;resize:none;font-family:inherit;background:transparent;color:var(--did-secondary-shades-800);margin:0;overflow:hidden;-webkit-box-sizing:border-box;box-sizing:border-box;display:block;font-size:14px;font-style:normal;font-weight:400;line-height:24px}@media (max-width: 768px){.didagent__main__input>textarea{font-size:16px}}.didagent__main__input>textarea::-webkit-input-placeholder{color:var(--did-primary-black-700);line-height:24px;font-size:14px;opacity:1}.didagent__main__input>textarea::-moz-placeholder{color:var(--did-primary-black-700);line-height:24px;font-size:14px;opacity:1}.didagent__main__input>textarea:-ms-input-placeholder{color:var(--did-primary-black-700);line-height:24px;font-size:14px;opacity:1}.didagent__main__input>textarea::-ms-input-placeholder{color:var(--did-primary-black-700);line-height:24px;font-size:14px;opacity:1}.didagent__main__input>textarea::placeholder{color:var(--did-primary-black-700);line-height:24px;font-size:14px;opacity:1}.didagent__main__input>textarea::-webkit-scrollbar{display:none}.didagent__loader{--loader-size: 80px;--loader-color: #fff;width:var(--loader-size);height:var(--loader-size);display:inline-block}.didagent__svg{width:100%;height:100%;display:block;-webkit-transform-origin:50% 50%;-ms-transform-origin:50% 50%;transform-origin:50% 50%;-webkit-animation:did-spin 10s linear infinite;animation:did-spin 10s linear infinite}.didagent__arc{fill:none;stroke:var(--loader-color);stroke-width:max(8px,calc(var(--loader-size) * .1));stroke-linecap:round;stroke-dasharray:12.566 238.761;-webkit-animation:did-dash 1.6s ease-in-out infinite,did-offset 1s linear infinite;animation:did-dash 1.6s ease-in-out infinite,did-offset 1s linear infinite}@-webkit-keyframes did-spin{to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes did-spin{to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-webkit-keyframes did-dash{0%{stroke-dasharray:12.566 238.761}50%{stroke-dasharray:125.664 125.664}to{stroke-dasharray:12.566 238.761}}@keyframes did-dash{0%{stroke-dasharray:12.566 238.761}50%{stroke-dasharray:125.664 125.664}to{stroke-dasharray:12.566 238.761}}@-webkit-keyframes did-offset{to{stroke-dashoffset:-251.327}}@keyframes did-offset{to{stroke-dashoffset:-251.327}}.didagent__audio__dropdown__item{padding:3px 0;cursor:pointer;-webkit-transition:background-color .3s ease;transition:background-color .3s ease;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;gap:4px;font-size:12px;border:none;background:none;color:inherit;font-family:inherit;text-align:left;width:100%}.didagent__audio__controller__wrapper{position:relative}.didagent__audio__dropdown__header{color:#c5c6c6;font-size:12px;font-style:normal;font-weight:400;line-height:24px;padding-left:16px}.didagent__audio__dropdown__bottom__spacer{border-bottom:1px solid #707171}.didagent__audio__list__wrapper{padding:12px}.didagent__audio__list__title{font-weight:700;font-size:12px}.didagent__audio__mobile__dropdown__wrapper{position:absolute;width:100%;height:100%;top:0;left:0;right:0}.didagent__audio__mic__dropdown__wrapper{bottom:60px;left:0;min-width:312px;min-height:104px}.didagent__audio__speaker__dropdown__wrapper{top:46px;right:0;left:-220px}.didagent__audio__dropdown__container{position:absolute;-webkit-transform:translateX(0);-ms-transform:translateX(0);transform:translate(0);background:#1d1d1dcc;color:#fff;border-radius:16px;z-index:999999999;opacity:0;-webkit-animation:didagent__fadeIn .3s ease-in-out forwards;animation:didagent__fadeIn .3s ease-in-out forwards;overflow-y:auto;font-size:12px;scrollbar-width:none}.didagent__audio__mobile__dropdown__container{bottom:16px;right:16px;left:16px;min-width:150px;max-height:calc(100% - 42px);padding:12px}.didagent__transform__180{-webkit-transform:rotate(180deg);-ms-transform:rotate(180deg);transform:rotate(180deg)}.didagent__buttton__vertical__divider{background:#dddee04d;height:24px;width:1px}.didagent__audio__selector__container{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.didagent__mic__selector__container{padding:27px 12px 27px 9px;gap:8px;z-index:1}.didagent__speaker__selector__container{padding:4px;gap:10px}.didagent__audio__dropdown__container ul{list-style:none;padding:0;margin:0}.didagent__audio__dropdown__container li{list-style:none}.didagent__dropdown__container{position:absolute;top:48px;right:8px;-webkit-transform:translateX(0);-ms-transform:translateX(0);transform:translate(0);background:#1d1d1dcc;color:#fff;border-radius:16px;z-index:999999999;min-width:150px;opacity:0;-webkit-animation:didagent__fadeIn .3s ease-in-out forwards;animation:didagent__fadeIn .3s ease-in-out forwards;max-height:calc(100% - 56px);overflow-y:auto;font-size:12px;scrollbar-width:none}.didagent__dropdown__header{font-weight:700;padding:12px;border-bottom:1px solid rgba(255,255,255,.1)}.didagent__dropdown__list{list-style:none;padding:0;margin:0}.didagent__dropdown__item{padding:8px 12px;cursor:pointer;-webkit-transition:background-color .3s ease;transition:background-color .3s ease}.didagent__dropdown__item:hover{background-color:#ffffff1a}.didagent__dropdown__item:active{background-color:#fff3}.didagent__language__button{text-transform:uppercase}.didagent__header{width:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:16px 16px 0 12px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-box-flex:1;-ms-flex:1;flex:1;z-index:2;gap:8px;max-height:54px}@media (max-width: 768px){.didagent__header{gap:10px;max-height:68px}}.didagent__header .didagent__header-bg{border-radius:100vmax;background-color:var(--did-primary-black-00050);display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;border:none;outline:none}.didagent__header .didagent__header-left,.didagent__header .didagent__header-right{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;gap:8px}.didagent__header .didagent__header-left>button,.didagent__header .didagent__header-right>button{height:32px;width:32px;cursor:pointer;border:none;outline:none;color:#fff;-webkit-transition:background-color .2s;transition:background-color .2s;z-index:10000}@media (max-width: 768px){.didagent__header .didagent__header-left>button,.didagent__header .didagent__header-right>button{height:42px;width:42px}}.didagent__header .didagent__header-left button.didagent__header__menu__item-active,.didagent__header .didagent__header-right button.didagent__header__menu__item-active{background-color:#fff;color:var(--did-secondary-900)}.didagent__header .didagent__header-left button.didagent__header__menu__item-active:hover,.didagent__header .didagent__header-right button.didagent__header__menu__item-active:hover{background-color:#fff!important}.didagent__header .didagent__header-center{display:-webkit-box;display:-ms-flexbox;display:flex;gap:8px;height:32px;margin:0 auto}.didagent__header .didagent__header__menu__item{cursor:pointer;color:var(--did-secondary-main);height:100%;aspect-ratio:1;border:none}.didagent__header .didagent__header__menu__item:disabled{cursor:not-allowed;opacity:.5}.didagent__header .didagent__header__menu__item:active:not(:disabled){border:1px solid var(--did-primary-black-300)}.didagent__header .didagent__header__menu__item-rotate{-webkit-animation:rotate 1s linear infinite;animation:rotate 1s linear infinite}.didagent__header__name{background:#000000bf;-webkit-backdrop-filter:blur(8px);backdrop-filter:blur(8px);display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;padding:4px 13px;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;gap:10px;color:#fff;position:absolute;bottom:0;left:0;z-index:1;font-size:14px;font-style:normal;font-weight:500;line-height:24px}.didagent__header__name img{max-height:64px;height:100%;-o-object-fit:contain;object-fit:contain;display:block}.didagent__starter_messages__container{width:100%;padding:8px 8px 20px;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-transition:max-height .6s ease-out,margin-bottom .6s ease-out,padding-bottom .6s ease-out,opacity .6s ease-out;transition:max-height .6s ease-out,margin-bottom .6s ease-out,padding-bottom .6s ease-out,opacity .6s ease-out;z-index:1}.didagent__starter_messages__container::-webkit-scrollbar{display:none}.didagent__starter_messages__container .didagent__starter_message__container{display:-webkit-box;display:-ms-flexbox;display:flex;padding:8px 16px;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border-radius:20px;border:none;background:#1d1d1dcc;-webkit-backdrop-filter:blur(12px);backdrop-filter:blur(12px);color:#fff;font-family:Inter,system-ui,Avenir,Helvetica,sans-serif;font-style:normal;font-weight:400;line-height:20px;cursor:pointer}.didagent__starter_messages__container .didagent__starter_message__container:hover{background:#1d1d1d}.didagent__starter_messages__container .didagent__starter_message__container:disabled{background:#78787829;cursor:not-allowed}.didagent__starter_messages__container .didagent__starter_message__container_text{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;padding-right:8px;font-size:14px;-webkit-box-flex:1;-ms-flex:1;flex:1;display:block}@media (min-width: 768px){.didagent__starter_messages__container{display:grid;grid-template-columns:1fr 1fr;gap:4px;max-width:440px;margin:0 auto}.didagent__starter_messages__container>:nth-child(odd):last-child{grid-column:1 / -1;justify-self:center;width:50%}.didagent__starter_messages__container:has(>:first-child:last-child){grid-template-columns:20% 1fr 20%}.didagent__starter_message__container{margin:0;font-size:14px;-webkit-box-sizing:border-box;box-sizing:border-box;min-width:0;overflow:hidden}}@media (max-width: 768px){.didagent__starter_messages__container{display:-webkit-box;display:-ms-flexbox;display:flex;overflow-x:auto;white-space:nowrap;-ms-scroll-snap-type:x mandatory;scroll-snap-type:x mandatory;padding-bottom:16px;scroll-padding-left:16px}.didagent__starter_message__container{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;min-width:70vw;margin-right:4px;scroll-snap-align:start;font-size:12px}}.didagent__embedded__video__container{position:absolute;top:0;width:100%;height:100%;margin:0 auto;overflow:hidden;-webkit-transition:scale .2s ease;transition:scale .2s ease}.didagent__embedded__video__container[data-blur=true]{-webkit-filter:blur(7px);filter:blur(7px)}.didagent__embedded__video__container video{position:absolute;display:block;-o-object-fit:contain;object-fit:contain;height:100%;width:auto;top:0;left:50%;-webkit-transform:translateX(-50%);-ms-transform:translateX(-50%);transform:translate(-50%);-webkit-transition:height .3s ease;transition:height .3s ease}@media (max-width: 768px){.didagent__embedded__video__container video{-o-object-fit:cover;object-fit:cover;width:100%}}.didagent__embedded__video__container .didagent__video__skeleton{height:100%;aspect-ratio:1;margin:auto}.didagent__embedded__video__container[data-orientation=vertical][data-chat=bottom] video{height:max(100% - 305px,60%)}.didagent__embedded__video__container[data-chatmode=Playground][data-chat=bottom] video{aspect-ratio:16 / 9;width:100%;height:var(--didWidth) * (9 / 16)}.didagent__embedded__video__idle{opacity:1;-webkit-transition:height .1s ease;transition:height .1s ease}.didagent__embedded__video__stream{opacity:0;-webkit-transition:opacity .2s ease-in-out,height .1s ease;transition:opacity .2s ease-in-out,height .1s ease}.didagent__embedded__video__stream[data-active=true]{opacity:1}*:focus-visible{outline:2px solid #3047ec;outline-offset:2px;border-radius:4px}.didagent__button:focus-visible,.didagent__button__dark:focus-visible{outline-color:#fff;outline-offset:1px}.didagent__chevron__button{background:none;border:none;padding:0;margin:0;cursor:pointer;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;color:inherit;opacity:inherit;-webkit-transition:inherit;transition:inherit}.didagent__chevron__button .didagent__light__opacity__hover{opacity:.7;-webkit-transition:opacity .2s ease;transition:opacity .2s ease}.didagent__chevron__button:hover .didagent__light__opacity__hover{opacity:1}:host{--did-primary-black-50: #f1f2f6;--did-primary-black-70: #c0bfbd;--did-primary-black-80: #5a5a5a;--did-primary-black-90: #1d1d1d;--did-primary-black-9060: #1d1d1d99;--did-primary-black-9080: #1d1d1dcc;--did-primary-black-100: #242625;--did-primary-black-10090: #242625ba;--did-primary-black-200: #ebebeb;--did-primary-black-300: #dbdbdb;--did-primary-black-400: #b8b8b8;--did-primary-black-500: #989898;--did-primary-black-700: #5c5c5c;--did-primary-black-00012: rgba(0, 0, 0, .125);--did-primary-black-00030: rgba(0, 0, 0, .3);--did-primary-black-00040: rgba(0, 0, 0, .4);--did-primary-black-00050: rgba(0, 0, 0, .5);--did-primary-50: #fffee9;--did-primary-100: #fffac7;--did-primary-200: #fff6a0;--did-primary-300: #fff17b;--did-primary-400: #ffec5c;--did-primary-500: #fee640;--did-primary-600: #ffdd45;--did-primary-700: #ffc941;--did-primary-800: #ffb13a;--did-primary-900: #ff882e;--did-primary-950: #ed7921;--did-primary-main: #ff882e;--did-primary-light: #fff6ef;--did-primary-bg: #ff882e1f;--did-primary-bgDark: #493021;--did-primary-hover: #ed7921;--did-primary-disabled: #94979c;--did-secondary-50: #f8f5f4;--did-secondary-60: #f3f3f3;--did-secondary-100: #eceae8;--did-secondary-200: #dedcda;--did-secondary-300: #c9c7c6;--did-secondary-400: #a4a1a0;--did-secondary-500: #82807e;--did-secondary-550: #707070;--did-secondary-600: #5b5958;--did-secondary-700: #494745;--did-secondary-800: #2b2a28;--did-secondary-900: #090604;--did-secondary-main: #090604;--did-secondary-hover: #2b2a28;--did-secondary-shades-800: rgba(43, 42, 40, 1);--did-success-main: #29cc6a;--did-danger-main: #ed254e;--did-danger-light: #fef2f2;--did-danger-dark: #cc0037}.didagent__embedded__container__loading{width:100%;height:100%;-webkit-backdrop-filter:var(--backdrop-filter);backdrop-filter:var(--backdrop-filter);background-color:var(--background-color);display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;pointer-events:none;opacity:1;-webkit-transition:opacity .2s ease,height .3s ease,width .3s ease;transition:opacity .2s ease,height .3s ease,width .3s ease;position:absolute;z-index:3}.didagent__embedded__container__loading>span{color:var(--did-secondary-60);font-weight:500}.didagent__embedded__loader{-webkit-animation:rotate 1s linear infinite;animation:rotate 1s linear infinite;width:64px;height:64px}.didagent__embedded__container{font-family:Inter,system-ui,Avenir,Helvetica,sans-serif;width:100%;height:100%;position:relative;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;gap:4px;min-width:250px;font-size:16px;isolation:isolate;overflow:hidden;-webkit-transition:opacity .2s ease,height .3s ease,width .3s ease;transition:opacity .2s ease,height .3s ease,width .3s ease}.didagent__embedded__container .didagent__filler{-webkit-box-flex:1;-ms-flex:1;flex:1;width:100%;pointer-events:none}.didagent__embedded__container *{-webkit-box-sizing:border-box;box-sizing:border-box;font-family:Inter,system-ui,Avenir,Helvetica,sans-serif}.didagent__embedded__container[data-chat=side]{width:calc(100% - max(328px,min(33.33vw,424px)))}.didagent__embedded__container .didagent__embedded__container>.didagent__main__bottom__spacer{height:28px}.didagent__fabio__container[data-expanded=false] .didagent__embedded__container{width:100%;height:100%}.didagent__background{width:100%;height:100%;position:absolute;top:0;left:0;-o-object-fit:cover;object-fit:cover;-webkit-filter:blur(15px);filter:blur(15px);scale:105%;opacity:.6;z-index:-1}.didagent__main__container{padding:0 12px 16px;margin:0 auto;display:-webkit-box;display:-ms-flexbox;display:flex;width:100%;max-width:450px;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;gap:16px}@media (max-width: 960px){.didagent__main__container{gap:12px}}@media (min-width: 768px){.didagent__backdrop{position:fixed;top:0;right:0;bottom:0;left:0;width:100vw;height:100vh;background:#00000080;z-index:2;-webkit-animation:didagentFadeIn .2s ease-in forwards;animation:didagentFadeIn .2s ease-in forwards;pointer-events:none}}@media (min-width: 768px){.didagent__fabio__container .didagent__main__wrapper{border-radius:16px}}@media (min-width: 768px){.didagent__fabio__container .didagent__main__wrapper[data-expanded=false]{-webkit-box-sizing:content-box;box-sizing:content-box;border:1px solid #dbdbdb}}.didagent__main__wrapper{overflow:hidden;position:relative;height:100%;width:100%}@media (min-width: 768px){.didagent__main__wrapper[data-expanded=true]{position:fixed!important;z-index:99999;top:0;left:0;right:0;bottom:0;margin:auto;aspect-ratio:16 / 9;height:auto;width:80vw}}@media (min-width: 1440px){.didagent__main__wrapper[data-expanded=true]{max-width:1280px;max-height:720px}}.didagent__resize__handle{position:absolute;background:transparent;z-index:11}.didagent__resize__handle.top-left,.didagent__resize__handle.top-right,.didagent__resize__handle.bottom-left,.didagent__resize__handle.bottom-right{width:16px;height:16px}.didagent__resize__handle.top-left{top:0;left:0;cursor:nwse-resize}.didagent__resize__handle.top-right{top:0;right:0;cursor:nesw-resize}.didagent__resize__handle.bottom-left{bottom:0;left:0;cursor:nesw-resize}.didagent__resize__handle.bottom-right{bottom:0;right:0;cursor:nwse-resize}.didagent__resize__handle.top,.didagent__resize__handle.bottom{height:8px;width:calc(100% - 32px)}.didagent__resize__handle.top{top:0;left:16px;cursor:ns-resize}.didagent__resize__handle.bottom{bottom:0;left:16px;cursor:ns-resize}.didagent__resize__handle.left,.didagent__resize__handle.right{width:8px;height:calc(100% - 32px)}.didagent__resize__handle.left{left:0;top:16px;cursor:ew-resize}.didagent__resize__handle.right{right:0;top:16px;cursor:ew-resize}.didagent__mobile__rotate{display:-webkit-box;display:-ms-flexbox;display:flex;width:296px;padding:12px;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;gap:8px;border-radius:8px;background:#0000004d}.didagent__mobile__rotate .didagent__mobile__rotate__content{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start;-webkit-box-flex:1;-ms-flex:1 0 0px;flex:1 0 0;color:var(--Blacks-White, #fff);font-size:14px;font-style:normal;line-height:20px;letter-spacing:-.28px}.didagent__mobile__rotate .didagent__mobile__rotate__content .didagent__mobile__rotate__title{font-weight:700}.didagent__mobile__rotate .didagent__mobile__rotate__content .didagent__mobile__rotate__description{font-weight:400}.didagent__intro{opacity:0;-webkit-animation:didagentFadeIn .2s ease-in forwards;animation:didagentFadeIn .2s ease-in forwards;z-index:1;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;gap:8px;-webkit-box-align:center;-ms-flex-align:center;align-items:center;position:absolute;width:100%;height:100%;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1}.didagent__intro .didagent__intro__footer{margin-bottom:5%}@media (max-width: 768px){.didagent__intro .didagent__intro__footer{margin-bottom:20%}}.didagent__intro .didagent__intro__button{cursor:pointer;border-radius:8px;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;padding:12px 18px;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;gap:6px;font-size:16px;font-style:normal;font-weight:600;line-height:20px;max-height:46px}.didagent__intro .didagent__intro__button:disabled{cursor:not-allowed;pointer-events:none;opacity:.9}.didagent__intro .didagent__intro__button__primary{border:1px solid var(--Blacks-White, #fff);background:#ffffffe6;color:var(--Secondary-Primary, #090604);font-size:18px;font-style:normal;font-weight:400}.didagent__intro .didagent__intro__button__secondary{font-size:16px;font-style:normal;font-weight:700;border:1px solid #fff;background-color:transparent;color:#fff}.didagent__intro .didagent__intro__button__secondary:hover{background-color:#ffffff1a}.didagent__intro .didagent__start__conversation__button{-webkit-transition:width .3s ease-out;transition:width .3s ease-out;overflow:hidden;white-space:nowrap;height:40px;width:var(--button-width, auto);min-width:0;padding:0;text-align:center;font-size:14px;font-style:normal;font-weight:500;line-height:20px}.didagent__intro .didagent__intro__content{color:#fff;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-ms-flex-align:center;align-items:center;gap:12px;max-width:550px}.didagent__intro .didagent__intro__content>span{font-size:18px;letter-spacing:-.32px;font-weight:500}.didagent__intro .didagent__intro__content.didagent__intro__content__top{margin-top:10%}.didagent__intro .didagent__intro__content:not(.didagent__intro__content__top){margin-top:auto;margin-bottom:auto}.didagent__intro .didagent__intro__content h2{text-align:center;font-size:18px;font-style:normal;font-weight:700;line-height:24px;margin:0}.didagent__intro .didagent__intro__content p{margin:0;font-family:Inter,system-ui,Avenir,Helvetica,sans-serif;text-align:center;font-size:16px;font-style:normal;font-weight:500;line-height:normal;letter-spacing:-.32px}.didagent__intro__content.didagent__intro__content__reconnect{gap:32px}.didagent__intro__content.didagent__intro__content__reconnect h2{font-family:Inter,system-ui,Avenir,Helvetica,sans-serif;color:var(--Blacks-White, #fff);font-size:28px;font-weight:400}.didagent__intro__content.didagent__intro__content__reconnect .didagent__intro__button{border:none;background:var(--Blacks-White, #fff);color:var(--Secondary-Primary, #090604);font-style:normal;font-weight:500}.didagent__intro__content.didagent__intro__content__reconnect .didagent__intro__button span{font-size:16px;color:var(--Secondary-Primary, #090604)}.didagent__intro__content.didagent__intro__content__reconnect .didagent__intro__button.didagent__intro__button__chat__history{position:absolute;bottom:24px;border-radius:999px;-webkit-backdrop-filter:blur(12px);backdrop-filter:blur(12px);height:52px;gap:8px;padding:14px 19px;background-color:#1d1d1dcc;color:#fff}.didagent__intro__content.didagent__intro__content__reconnect .didagent__intro__button.didagent__intro__button__chat__history span{color:#fff}.didagent__intro__content.didagent__intro__content__reconnect .didagent__intro__button.didagent__intro__button__chat__history:hover{background-color:#1d1d1d;color:#fff}.didagent__intro__content.didagent__intro__content__reconnect .didagent__intro__button.didagent__intro__button__chat__history:hover span{color:#fff}.didagent__intro__content.didagent__intro__content__reconnect .didagent__intro__button.didagent__intro__button__chat__history.didagent__intro__button__chat__history__active{background-color:#fff;color:#010101}.didagent__intro__content.didagent__intro__content__reconnect .didagent__intro__button.didagent__intro__button__chat__history.didagent__intro__button__chat__history__active span{color:#010101}.didagent__intro__content.didagent__intro__content__reconnect__mobile h2{font-size:30px}.didagent__intro__content.didagent__intro__content__reconnect__mobile .didagent__intro__button{height:40px}.didagent__intro__content span,.didagent__intro__content h2,.didagent__intro__content p{color:#fff;font-weight:600}.didagent__intro__content h2{font-weight:700;font-size:18px}.didagent__intro__content span{font-size:18px;font-weight:500}.didagent__intro__backdrop{background:#00000026}.didagent__intro__bgblur{-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px)}.didagent__intro__blur{-webkit-filter:blur(6px);filter:blur(6px)}.didagent__connecting__overlay{opacity:0;-webkit-animation:connectingOverlayFadeIn 2s forwards,blurIn .8s 2s ease forwards;animation:connectingOverlayFadeIn 2s forwards,blurIn .8s 2s ease forwards}@-webkit-keyframes blurIn{0%{-webkit-backdrop-filter:blur(0px);backdrop-filter:blur(0px)}to{-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px)}}@keyframes blurIn{0%{-webkit-backdrop-filter:blur(0px);backdrop-filter:blur(0px)}to{-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px)}}.didagent__connecting__text{opacity:0;-webkit-animation:connectingTextFadeIn 5s forwards;animation:connectingTextFadeIn 5s forwards}@-webkit-keyframes didagentFadeIn{0%{opacity:0}to{opacity:1}}@keyframes didagentFadeIn{0%{opacity:0}to{opacity:1}}.didagent__mic__permission__container{-ms-flex-negative:0;flex-shrink:0;-ms-flex-item-align:stretch;align-self:stretch;background:#ebebeb;z-index:3;position:absolute;width:100%;height:100%;justify-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.didagent__mic__permission__container>div{padding:16px;max-width:570px;width:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-ms-flex-item-align:stretch;align-self:stretch;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;margin:auto}.didagent__mic__permission__container>div>ol>li{margin-bottom:8px;font-size:16px}.didagent__mic__permission__container>div button{cursor:pointer;display:-webkit-box;display:-ms-flexbox;display:flex;padding:10px 16px;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;gap:6px;border-radius:8px;background:#090604;color:#fff;font-size:16px;font-style:normal;font-weight:400;line-height:24px;border:none;outline:none}.didagent__draggable__resizable{cursor:-webkit-grab;cursor:grab}.didagent__draggable__resizable:active{cursor:-webkit-grabbing;cursor:grabbing}@media (max-width: 768px){.didagent__mic__permission__container>div>img{width:150px;height:auto}}.didagent__mic__permission__container:is([data-chat=closed],[data-chat=closed-bottom])>div>img{width:125px;height:auto}.didagent__mic__permission__container div{max-height:100%}.didagent__mic__permission__container div>img{width:271px;height:288px;max-height:30%}.didagent__mic__permission__container__close{display:-webkit-box;display:-ms-flexbox;display:flex;width:32px;height:32px;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;gap:10px;border-radius:var(--1, 8px);background:#000c;position:absolute;top:8px;left:8px;outline:none;border:none;cursor:pointer}.didagent__delayed__fade{opacity:0;-webkit-animation:delayedFadeIn .75s forwards;animation:delayedFadeIn .75s forwards}@-webkit-keyframes delayedFadeIn{0%{opacity:0}90%{opacity:0}to{opacity:1}}@keyframes delayedFadeIn{0%{opacity:0}90%{opacity:0}to{opacity:1}}@-webkit-keyframes connectingOverlayFadeIn{0%{opacity:0}99%{opacity:0}to{opacity:1}}@keyframes connectingOverlayFadeIn{0%{opacity:0}99%{opacity:0}to{opacity:1}}@-webkit-keyframes connectingTextFadeIn{0%{opacity:0}80%{opacity:0}to{opacity:1}}@keyframes connectingTextFadeIn{0%{opacity:0}80%{opacity:0}to{opacity:1}}@-webkit-keyframes didagent__fadeIn{0%{opacity:0;-webkit-transform:translateY(-10px);transform:translateY(-10px)}to{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}}@keyframes didagent__fadeIn{0%{opacity:0;-webkit-transform:translateY(-10px);transform:translateY(-10px)}to{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}}@media (max-width: 768px){.didagent__hide__sm{display:none}}@-webkit-keyframes rotate{0%{-webkit-transform:rotate(0deg);transform:rotate(0)}to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes rotate{0%{-webkit-transform:rotate(0deg);transform:rotate(0)}to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}.didagent__fabio{position:fixed;aspect-ratio:1;-webkit-transition:opacity .2s ease-in-out,width .4s ease-in-out,height .4s ease-in-out;transition:opacity .2s ease-in-out,width .4s ease-in-out,height .4s ease-in-out;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:99999;isolation:isolate;bottom:2vh;width:96px;height:96px;-ms-flex-negative:0;flex-shrink:0}.didagent__fabio[data-position=left]{left:2vh}.didagent__fabio[data-position=right]{right:2vh}.didagent__fabio *{-webkit-box-sizing:border-box;box-sizing:border-box}.didagent__fabio>button{width:100%;height:100%;padding:0;cursor:pointer;outline:0;position:relative;border-radius:16px;-webkit-transition:opacity .3s ease-in-out,scale .2s ease-in-out;transition:opacity .3s ease-in-out,scale .2s ease-in-out}.didagent__fabio>button:hover{scale:1.03}.didagent__fabio>button>video{border:3px solid var(--did-primary-black-300)}.didagent__fabio>button>video,.didagent__fabio>button img{border-radius:16px;overflow:hidden;position:absolute;top:50%;left:50%;translate:-50% -50%;-o-object-fit:cover;object-fit:cover;-webkit-transition:opacity .2s ease-in-out;transition:opacity .2s ease-in-out}.didagent__fabio>button>video{width:100%;height:100%}.didagent__fabio>button:hover,.didagent__fabio>button:active{background:#494949}.didagent__fabio .didagent__fabio__speak_with{z-index:-1;position:absolute;top:50%;right:110%;background:#494949e6;font-size:14px;text-align:center;border-radius:10px 10px 0;translate:0px -50%;width:90px;-webkit-transition:all .5s ease-in-out;transition:all .5s ease-in-out;height:50px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;cursor:pointer;pointer-events:none}.didagent__fabio .didagent__fabio__speak_with>div{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;font-weight:400;color:#fff}.didagent__fabio .didagent__fabio__speak_with:after{position:absolute;top:0;left:100%;width:30px;height:100%;background:inherit}.didagent__fabio .didagent__transition_out{-webkit-transition:all .4s ease-in-out;transition:all .4s ease-in-out}.didagent__fabio .didagent__fabio__container{-webkit-transition:opacity .2s ease-in-out;transition:opacity .2s ease-in-out;position:absolute;bottom:0}.didagent__fabio .didagent__fabio__container>.didagent__embedded__container{overflow:hidden;border:none}.didagent__fabio .didagent__fabio__container .didagent__close__button{display:-webkit-box;display:-ms-flexbox;display:flex}.didagent__fabio .didagent__fabio__container[data-position=left]{left:0}.didagent__fabio .didagent__fabio__container[data-position=right]{right:0}@media (max-width: 768px),(max-height: 600px) and (orientation: landscape){.didagent__fabio .didagent__fabio__container[data-enabled=true]{position:fixed;border-radius:0;width:100%;height:100%;max-height:100vh;max-width:100vw;bottom:0;left:0}}.didagent__fabio .didagent__fabio__container[data-enabled=false]{opacity:0;pointer-events:none;z-index:-1;height:0}.didagent__fabio .didagent__fabio__container[data-enabled=true]{opacity:1;pointer-events:auto;z-index:100}.didagent__fabio .didagent__fabio__container[data-enabled=true][data-chat=side]>.didagent__main__wrapper>.didagent__messages__container{width:min(max(328px,33%),424px);float:right;cursor:default}.didagent__fabio .didagent__fabio__container[data-enabled=true][data-chat=side]>.didagent__main__wrapper>.didagent__embedded__container{float:left;width:calc(100% - min(max(328px,33%),424px))}@media (max-width: 768px){.didagent__embedded__video__container>video,.didagent__embedded__video__container img{-o-object-fit:cover;object-fit:cover}}@media (min-width: 768px){.didagent__fabio{width:120px;height:120px}}@media (min-width: 960px){.didagent__fabio{width:160px;height:160px}}@media (min-width: 1280px){.didagent__fabio{width:208px;height:208px}}.didagent__fabio__notification{display:-webkit-box;display:-ms-flexbox;display:flex;width:20px;height:20px;padding:0 8px 0 7px;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-ms-flex-negative:0;flex-shrink:0;border-radius:5555555px;border:1px solid #fff;background:var(--Danger-Main, #3047ec);color:#fff;position:absolute;right:-8px;top:-8px;z-index:1}',{})})();
var Na = Object.defineProperty;
var Ta = (t, e, n) => e in t ? Na(t, e, { enumerable: !0, configurable: !0, writable: !0, value: n }) : t[e] = n;
var Ee = (t, e, n) => Ta(t, typeof e != "symbol" ? e + "" : e, n);
var Aa = Object.defineProperty, Ea = (t, e, n) => e in t ? Aa(t, e, { enumerable: !0, configurable: !0, writable: !0, value: n }) : t[e] = n, on = (t, e, n) => Ea(t, typeof e != "symbol" ? e + "" : e, n);
class wn extends Error {
  constructor({ kind: e, description: n, error: r }) {
    super(JSON.stringify({ kind: e, description: n })), on(this, "kind"), on(this, "description"), on(this, "error"), this.kind = e, this.description = n, this.error = r;
  }
}
class Da extends wn {
  constructor(e, n) {
    super({
      kind: "ChatCreationFailed",
      description: `Failed to create ${n ? "persistent" : ""} chat, mode: ${e}`
    });
  }
}
class Oa extends wn {
  constructor(e) {
    super({ kind: "ChatModeDowngraded", description: `Chat mode downgraded to ${e}` });
  }
}
class St extends wn {
  constructor(e, n) {
    super({ kind: "ValidationError", description: e }), on(this, "key"), this.key = n;
  }
}
class Pa extends wn {
  constructor(e) {
    super({ kind: "WSError", description: e });
  }
}
var rt = /* @__PURE__ */ ((t) => (t.Unrated = "Unrated", t.Positive = "Positive", t.Negative = "Negative", t))(rt || {}), T = /* @__PURE__ */ ((t) => (t.Functional = "Functional", t.TextOnly = "TextOnly", t.Maintenance = "Maintenance", t.Playground = "Playground", t.DirectPlayback = "DirectPlayback", t.Off = "Off", t))(T || {}), Je = /* @__PURE__ */ ((t) => (t.Embed = "embed", t.Query = "query", t.Partial = "partial", t.Answer = "answer", t.Transcribe = "transcribe", t.Complete = "done", t))(Je || {}), vi = /* @__PURE__ */ ((t) => (t.Clip = "clip", t.Talk = "talk", t.Expressive = "expressive", t))(vi || {}), he = /* @__PURE__ */ ((t) => (t.Start = "START", t.Stop = "STOP", t))(he || {}), it = /* @__PURE__ */ ((t) => (t.Strong = "STRONG", t.Weak = "WEAK", t.Unknown = "UNKNOWN", t))(it || {}), Qe = /* @__PURE__ */ ((t) => (t.Idle = "IDLE", t.Talking = "TALKING", t))(Qe || {}), Ie = /* @__PURE__ */ ((t) => (t.ChatAnswer = "chat/answer", t.ChatPartial = "chat/partial", t.ChatAudioTranscribed = "chat/audio-transcribed", t.StreamDone = "stream/done", t.StreamStarted = "stream/started", t.StreamFailed = "stream/error", t.StreamReady = "stream/ready", t.StreamCreated = "stream/created", t.StreamInterrupt = "stream/interrupt", t.StreamVideoCreated = "stream-video/started", t.StreamVideoDone = "stream-video/done", t.StreamVideoError = "stream-video/error", t.StreamVideoRejected = "stream-video/rejected", t))(Ie || {}), F = /* @__PURE__ */ ((t) => (t.New = "new", t.Fail = "fail", t.Connected = "connected", t.Connecting = "connecting", t.Closed = "closed", t.Completed = "completed", t.Disconnected = "disconnected", t))(F || {}), $e = /* @__PURE__ */ ((t) => (t.Legacy = "legacy", t.Fluent = "fluent", t))($e || {}), yn = /* @__PURE__ */ ((t) => (t.Livekit = "livekit", t))(yn || {});
const Ra = 45 * 1e3, za = "X-Playground-Chat", Wt = "https://api.d-id.com", ja = "wss://notifications.d-id.com", Fa = "79f81a83a67430be2bc0fd61042b8faa", wi = (t) => new Promise((e) => setTimeout(e, t)), Lt = (t = 16) => {
  const e = new Uint8Array(t);
  return window.crypto.getRandomValues(e), Array.from(e, (n) => n.toString(16).padStart(2, "0")).join("").slice(0, 13);
}, yi = (t) => t.type === "clip" && t.presenter_id.startsWith("v2_") ? "clip_v2" : t.type, er = (t) => t === vi.Expressive, $a = (t) => [T.TextOnly, T.Playground, T.Maintenance].includes(t), Ci = (t) => t && [T.DirectPlayback, T.Off].includes(t);
function Ba(t, e) {
  let n;
  return {
    promise: new Promise((r, i) => {
      n = setTimeout(() => i(new Error(e)), t);
    }),
    clear: () => clearTimeout(n)
  };
}
async function On(t, e) {
  const n = {
    limit: (e == null ? void 0 : e.limit) ?? 3,
    delayMs: (e == null ? void 0 : e.delayMs) ?? 0,
    timeout: (e == null ? void 0 : e.timeout) ?? 3e4,
    timeoutErrorMessage: (e == null ? void 0 : e.timeoutErrorMessage) || "Timeout error",
    shouldRetryFn: (e == null ? void 0 : e.shouldRetryFn) ?? (() => !0),
    onRetry: (e == null ? void 0 : e.onRetry) ?? (() => {
    })
  };
  let r;
  for (let i = 1; i <= n.limit; i++)
    try {
      if (!n.timeout)
        return await t();
      const { promise: a, clear: o } = Ba(n.timeout, n.timeoutErrorMessage), s = t().finally(o);
      return await Promise.race([s, a]);
    } catch (a) {
      if (r = a, !n.shouldRetryFn(a) || i >= n.limit)
        throw a;
      await wi(n.delayMs), n.onRetry(a);
    }
  throw r;
}
function Pn(t) {
  if (t !== void 0)
    return window.localStorage.setItem("did_external_key_id", t), t;
  let e = window.localStorage.getItem("did_external_key_id");
  if (!e) {
    let n = Lt();
    window.localStorage.setItem("did_external_key_id", n), e = n;
  }
  return e;
}
let Ua = Lt();
function bi(t, e) {
  if (t.type === "bearer")
    return `Bearer ${t.token}`;
  if (t.type === "basic")
    return `Basic ${btoa(`${t.username}:${t.password}`)}`;
  if (t.type === "key")
    return `Client-Key ${t.clientKey}.${Pn(e)}_${Ua}`;
  throw new Error(`Unknown auth type: ${t}`);
}
const Va = (t) => On(t, {
  limit: 3,
  delayMs: 1e3,
  timeout: 0,
  shouldRetryFn: (e) => e.status === 429
});
function tr(t, e = Wt, n, r) {
  const i = async (a, o) => {
    const { skipErrorHandler: s, ...l } = o || {}, c = await Va(
      () => fetch(e + (a != null && a.startsWith("/") ? a : `/${a}`), {
        ...l,
        headers: {
          ...l.headers,
          Authorization: bi(t, r),
          "Content-Type": "application/json"
        }
      })
    );
    if (!c.ok) {
      let g = await c.text().catch(() => `Failed to fetch with status ${c.status}`);
      const d = new Error(g);
      throw n && !s && n(d, { url: a, options: l, headers: c.headers }), d;
    }
    return c.json();
  };
  return {
    get(a, o) {
      return i(a, { ...o, method: "GET" });
    },
    post(a, o, s) {
      return i(a, { ...s, body: JSON.stringify(o), method: "POST" });
    },
    delete(a, o, s) {
      return i(a, { ...s, body: JSON.stringify(o), method: "DELETE" });
    },
    patch(a, o, s) {
      return i(a, { ...s, body: JSON.stringify(o), method: "PATCH" });
    }
  };
}
function Ha(t, e = Wt, n, r) {
  const i = tr(t, `${e}/agents`, n, r);
  return {
    create(a, o) {
      return i.post("/", a, o);
    },
    getAgents(a, o) {
      return i.get(`/${a ? `?tag=${a}` : ""}`, o).then((s) => s ?? []);
    },
    getById(a, o) {
      return i.get(`/${a}`, o);
    },
    delete(a, o) {
      return i.delete(`/${a}`, void 0, o);
    },
    update(a, o, s) {
      return i.patch(`/${a}`, o, s);
    },
    newChat(a, o, s) {
      return i.post(`/${a}/chat`, o, s);
    },
    chat(a, o, s, l) {
      return i.post(`/${a}/chat/${o}`, s, l);
    },
    createRating(a, o, s, l) {
      return i.post(`/${a}/chat/${o}/ratings`, s, l);
    },
    updateRating(a, o, s, l, c) {
      return i.patch(`/${a}/chat/${o}/ratings/${s}`, l, c);
    },
    deleteRating(a, o, s, l) {
      return i.delete(`/${a}/chat/${o}/ratings/${s}`, l);
    },
    getSTTToken(a, o) {
      return i.get(`/${a}/stt-token`, o);
    }
  };
}
function Za(t) {
  var e, n, r, i;
  const a = () => /Mobi|Android/i.test(navigator.userAgent) ? "Mobile" : "Desktop", o = () => {
    const l = navigator.platform;
    return l.toLowerCase().includes("win") ? "Windows" : l.toLowerCase().includes("mac") ? "Mac OS X" : l.toLowerCase().includes("linux") ? "Linux" : "Unknown";
  }, s = t.presenter;
  return {
    $os: `${o()}`,
    isMobile: `${a() == "Mobile"}`,
    browser: navigator.userAgent,
    origin: window.location.origin,
    agentType: yi(s),
    agentVoice: {
      voiceId: (n = (e = t.presenter) == null ? void 0 : e.voice) == null ? void 0 : n.voice_id,
      provider: (i = (r = t.presenter) == null ? void 0 : r.voice) == null ? void 0 : i.type
    }
  };
}
function Ka(t) {
  var e, n, r, i, a, o;
  const s = (e = t.llm) == null ? void 0 : e.prompt_customization;
  return {
    agentType: yi(t.presenter),
    owner_id: t.owner_id ?? "",
    promptVersion: (n = t.llm) == null ? void 0 : n.prompt_version,
    behavior: {
      role: s == null ? void 0 : s.role,
      personality: s == null ? void 0 : s.personality,
      instructions: (r = t.llm) == null ? void 0 : r.instructions
    },
    temperature: (i = t.llm) == null ? void 0 : i.temperature,
    knowledgeSource: s == null ? void 0 : s.knowledge_source,
    starterQuestionsCount: (o = (a = t.knowledge) == null ? void 0 : a.starter_message) == null ? void 0 : o.length,
    topicsToAvoid: s == null ? void 0 : s.topics_to_avoid,
    maxResponseLength: s == null ? void 0 : s.max_response_length,
    agentId: t.id,
    access: t.access,
    name: t.preview_name,
    ...t.access === "public" ? { from: "agent-template" } : {}
  };
}
const Wa = (t) => t.reduce((e, n) => e + n, 0), _r = (t) => Wa(t) / t.length;
function Ga(t, e, n) {
  var r, i, a;
  const { event: o, ...s } = t, { template: l } = (e == null ? void 0 : e.llm) || {}, { language: c } = ((r = e == null ? void 0 : e.presenter) == null ? void 0 : r.voice) || {};
  return {
    ...s,
    llm: { ...s.llm, template: l },
    script: { ...s.script, provider: { ...(i = s == null ? void 0 : s.script) == null ? void 0 : i.provider, language: c } },
    stitch: (e == null ? void 0 : e.presenter.type) === "talk" ? (a = e == null ? void 0 : e.presenter) == null ? void 0 : a.stitch : void 0,
    ...n
  };
}
function vr(t) {
  "requestIdleCallback" in window ? requestIdleCallback(t, { timeout: 2e3 }) : setTimeout(t, 0);
}
let xn = {};
const qa = "https://api-js.mixpanel.com/track/?verbose=1&ip=1";
function Ya(t) {
  const e = window != null && window.hasOwnProperty("DID_AGENTS_API") ? "agents-ui" : "agents-sdk";
  return {
    token: t.token || "testKey",
    distinct_id: Pn(t.externalId),
    agentId: t.agentId,
    additionalProperties: {
      id: Pn(t.externalId),
      ...t.mixpanelAdditionalProperties || {}
    },
    isEnabled: t.isEnabled ?? !0,
    getRandom: Lt,
    enrich(n) {
      this.additionalProperties = { ...this.additionalProperties, ...n };
    },
    async track(n, r, i) {
      if (!this.isEnabled)
        return Promise.resolve();
      const { audioPath: a, ...o } = r || {}, s = i || Date.now(), l = {
        method: "POST",
        headers: {
          "Content-Type": "application/x-www-form-urlencoded"
        },
        body: new URLSearchParams({
          data: JSON.stringify([
            {
              event: n,
              properties: {
                ...this.additionalProperties,
                ...o,
                agentId: this.agentId,
                source: e,
                token: this.token,
                time: s,
                $insert_id: this.getRandom(),
                origin: window.location.href,
                "Screen Height": window.screen.height || window.innerWidth,
                "Screen Width": window.screen.width || window.innerHeight,
                "User Agent": navigator.userAgent
              }
            }
          ])
        })
      };
      return fetch(qa, {
        ...l,
        keepalive: !0
      }).catch((c) => console.error("Analytics tracking error:", c)), Promise.resolve();
    },
    linkTrack(n, r, i, a) {
      xn[n] || (xn[n] = { events: {}, resolvedDependencies: [] }), a.includes(i) || a.push(i);
      const o = xn[n];
      if (o.events[i] = { props: r }, o.resolvedDependencies.push(i), a.every(
        (s) => o.resolvedDependencies.includes(s)
      )) {
        const s = a.reduce((l, c) => o.events[c] ? { ...l, ...o.events[c].props } : l, {});
        this.track(n, s), o.resolvedDependencies = o.resolvedDependencies.filter(
          (l) => !a.includes(l)
        ), a.forEach((l) => {
          delete o.events[l];
        });
      }
    }
  };
}
function nr() {
  let t = 0;
  return {
    reset: () => t = 0,
    update: () => t = Date.now(),
    get: (e = !1) => e ? Date.now() - t : t
  };
}
const at = nr(), Rn = nr(), wr = nr();
function Si(t) {
  return t === T.Playground ? { headers: { [za]: "true" } } : {};
}
async function Mi(t, e, n, r, i = !1, a) {
  try {
    return !a && !Ci(r) && (a = await e.newChat(t.id, { persist: i }, Si(r)), n.track("agent-chat", {
      event: "created",
      chatId: a.id,
      mode: r
    })), { chat: a, chatMode: (a == null ? void 0 : a.chat_mode) ?? r };
  } catch (o) {
    throw Ja(o) === "InsufficientCreditsError" ? new Error("InsufficientCreditsError") : new Error("Cannot create new chat");
  }
}
const Ja = (t) => {
  try {
    const e = JSON.parse(t.message);
    return e == null ? void 0 : e.kind;
  } catch {
    return "UnknownError";
  }
};
function Qa(t) {
  return t && t.length > 0 ? t : [];
}
function Xa(t, e, n, r) {
  const i = tr(t, `${e}/v2/agents/${n}`, r);
  return {
    async createStream(a) {
      return i.post("/sessions", a);
    }
  };
}
const ki = (t, e) => (n, r) => t && console.log(`[${e}] ${n}`, r ?? "");
async function Ln() {
  try {
    return await import("./livekit-client.esm-C1GRQdZY-Bo6p8cUq.js");
  } catch {
    throw new Error(
      "LiveKit client is required for this streaming manager. Please install it using: npm install livekit-client"
    );
  }
}
const eo = {
  excellent: it.Strong,
  good: it.Strong,
  poor: it.Weak,
  lost: it.Unknown,
  unknown: it.Unknown
}, Ot = JSON.stringify({
  kind: "InternalServerError",
  description: "Stream Error"
});
var rr = /* @__PURE__ */ ((t) => (t.Chat = "lk.chat", t.Speak = "did.speak", t.Interrupt = "did.interrupt", t))(rr || {});
function zn(t, e, n, r) {
  var i, a;
  throw e("Failed to connect to LiveKit room:", t), r(), (i = n.onConnectionStateChange) == null || i.call(n, F.Fail), (a = n.onError) == null || a.call(n, t, { sessionId: "" }), t;
}
async function to(t, e, n) {
  var r, i;
  const a = ki(n.debug || !1, "LiveKitStreamingManager"), { Room: o, RoomEvent: s, ConnectionState: l } = await Ln(), { callbacks: c, auth: g, baseURL: d, analytics: f, microphoneStream: p } = n;
  let u = null, m = !1;
  const y = $e.Fluent;
  let C = !0, v = null, M = null;
  u = new o({
    adaptiveStream: !1,
    // Must be false to use mediaStreamTrack directly
    dynacast: !0
  });
  const k = Xa(g, d || Wt, t, c.onError);
  let L, P, A;
  try {
    const N = await k.createStream({
      transport_provider: yn.Livekit,
      chat_persist: e.chat_persist ?? !0
    }), { id: $, session_token: J, session_url: ae } = N;
    (r = c.onStreamCreated) == null || r.call(c, { session_id: $, stream_id: $, agent_id: t }), L = $, P = J, A = ae, await u.prepareConnection(A, P);
  } catch (N) {
    zn(N, a, c, () => {
      C = !1;
    });
  }
  if (!A || !P || !L)
    return Promise.reject(new Error("Failed to initialize LiveKit stream"));
  u.on(s.ConnectionStateChanged, _).on(s.ConnectionQualityChanged, S).on(s.ActiveSpeakersChanged, w).on(s.ParticipantConnected, b).on(s.ParticipantDisconnected, z).on(s.TrackSubscribed, D).on(s.TrackUnsubscribed, q).on(s.DataReceived, V).on(s.MediaDevicesError, B).on(s.EncryptionError, H).on(s.TrackSubscriptionFailed, Y), (i = c.onConnectionStateChange) == null || i.call(c, F.New);
  try {
    await u.connect(A, P), a("LiveKit room joined successfully"), C = !1;
  } catch (N) {
    zn(N, a, c, () => {
      C = !1;
    });
  }
  f.enrich({
    "stream-type": y
  });
  function _(N) {
    var $, J, ae, oe, ce;
    switch (a("Connection state changed:", N), N) {
      case l.Connecting:
        ($ = c.onConnectionStateChange) == null || $.call(c, F.Connecting);
        break;
      case l.Connected:
        a("LiveKit room connected successfully"), m = !0, C ? queueMicrotask(() => {
          var ye;
          (ye = c.onConnectionStateChange) == null || ye.call(c, F.Connected);
        }) : (J = c.onConnectionStateChange) == null || J.call(c, F.Connected);
        break;
      case l.Disconnected:
        a("LiveKit room disconnected"), m = !1, (ae = c.onConnectionStateChange) == null || ae.call(c, F.Disconnected);
        break;
      case l.Reconnecting:
        a("LiveKit room reconnecting..."), (oe = c.onConnectionStateChange) == null || oe.call(c, F.Connecting);
        break;
      case l.SignalReconnecting:
        a("LiveKit room signal reconnecting..."), (ce = c.onConnectionStateChange) == null || ce.call(c, F.Connecting);
        break;
    }
  }
  function S(N, $) {
    var J;
    a("Connection quality:", N), $ != null && $.isLocal && ((J = c.onConnectivityStateChange) == null || J.call(c, eo[N]));
  }
  function w(N) {
    var $, J;
    a("Active speakers changed:", N), N[0] ? ($ = c.onAgentActivityStateChange) == null || $.call(c, Qe.Talking) : (J = c.onAgentActivityStateChange) == null || J.call(c, Qe.Idle);
  }
  function b(N) {
    a("Participant connected:", N.identity);
  }
  function z(N) {
    a("Participant disconnected:", N.identity), ee();
  }
  function D(N, $, J) {
    var ae, oe, ce;
    a(`Track subscribed: ${N.kind} from ${J.identity}`);
    const ye = N.mediaStreamTrack;
    if (!ye) {
      a(`No mediaStreamTrack available for ${N.kind}`);
      return;
    }
    v ? (v.addTrack(ye), a(`Added ${N.kind} track to shared MediaStream`)) : (v = new MediaStream([ye]), a(`Created shared MediaStream with ${N.kind} track`)), N.kind === "video" && ((ae = c.onStreamReady) == null || ae.call(c), (oe = c.onSrcObjectReady) == null || oe.call(c, v), (ce = c.onVideoStateChange) == null || ce.call(c, he.Start));
  }
  function q(N, $, J) {
    var ae;
    a(`Track unsubscribed: ${N.kind} from ${J.identity}`), N.kind === "video" && ((ae = c.onVideoStateChange) == null || ae.call(c, he.Stop));
  }
  function V(N, $, J, ae) {
    var oe, ce, ye;
    const ke = new TextDecoder().decode(N);
    a("Data received:", ke);
    try {
      const Ne = JSON.parse(ke), Ze = ae || Ne.subject;
      if (Ze === Ie.ChatAnswer) {
        const je = Je.Answer;
        (oe = c.onMessage) == null || oe.call(c, je, {
          event: je,
          ...Ne
        });
      } else if ([Ie.StreamVideoCreated, Ie.StreamVideoDone].includes(Ze)) {
        const je = (Ne == null ? void 0 : Ne.role) || ($ == null ? void 0 : $.identity) || "datachannel";
        (ce = c.onMessage) == null || ce.call(c, Ze, {
          [je]: Ne
        });
      } else if (Ze === Ie.ChatAudioTranscribed) {
        const je = Je.Transcribe;
        (ye = c.onMessage) == null || ye.call(c, je, {
          event: je,
          ...Ne
        });
      }
    } catch (Ne) {
      a("Failed to parse data channel message:", Ne);
    }
  }
  function B(N) {
    var $;
    a("Media devices error:", N), ($ = c.onError) == null || $.call(c, new Error(Ot), { sessionId: L });
  }
  function H(N) {
    var $;
    a("Encryption error:", N), ($ = c.onError) == null || $.call(c, new Error(Ot), { sessionId: L });
  }
  function Y(N, $, J) {
    a("Track subscription failed:", { trackSid: N, participant: $, reason: J });
  }
  async function X(N) {
    if (!u) return null;
    const { Track: $ } = await Ln(), J = u.localParticipant.audioTrackPublications;
    if (J) {
      for (const [ae, oe] of J)
        if (oe.source === $.Source.Microphone && oe.track) {
          const ce = oe.track.mediaStreamTrack;
          if (ce === N || ce && ce.id === N.id)
            return oe;
        }
    }
    return null;
  }
  function K(N) {
    if (!M || !M.track)
      return !1;
    const $ = M.track.mediaStreamTrack;
    return $ !== N && ($ == null ? void 0 : $.id) !== N.id;
  }
  async function U(N) {
    var $, J;
    if (!m || !u)
      throw a("Room is not connected, cannot publish microphone stream"), new Error("Room is not connected");
    const ae = N.getAudioTracks();
    if (ae.length === 0) {
      a("No audio track found in the provided MediaStream");
      return;
    }
    const oe = ae[0], { Track: ce } = await Ln(), ye = await X(oe);
    if (ye) {
      a("Microphone track is already published, skipping", {
        trackId: oe.id,
        publishedTrackId: (J = ($ = ye.track) == null ? void 0 : $.mediaStreamTrack) == null ? void 0 : J.id
      }), M = ye;
      return;
    }
    K(oe) && (a("Unpublishing existing microphone track before publishing new one"), await Z()), a("Publishing microphone track from provided MediaStream", { trackId: oe.id });
    try {
      M = await u.localParticipant.publishTrack(oe, {
        source: ce.Source.Microphone
      }), a("Microphone track published successfully", { trackSid: M.trackSid });
    } catch (ke) {
      throw a("Failed to publish microphone track:", ke), ke;
    }
  }
  async function Z() {
    if (!(!M || !M.track))
      try {
        u && (await u.localParticipant.unpublishTrack(M.track), a("Microphone track unpublished"));
      } catch (N) {
        a("Error unpublishing microphone track:", N);
      } finally {
        M = null;
      }
  }
  function x() {
    v && (v.getTracks().forEach((N) => N.stop()), v = null);
  }
  async function R(N, $) {
    var J, ae;
    if (!m || !u) {
      a("Room is not connected for sending messages"), (J = c.onError) == null || J.call(c, new Error(Ot), {
        sessionId: L
      });
      return;
    }
    try {
      await u.localParticipant.sendText(N, { topic: $ }), a("Message sent successfully:", N);
    } catch (oe) {
      a("Failed to send message:", oe), (ae = c.onError) == null || ae.call(c, new Error(Ot), { sessionId: L });
    }
  }
  async function se(N) {
    var $;
    try {
      const J = JSON.parse(N).topic;
      return R("", J);
    } catch (J) {
      a("Failed to send data channel message:", J), ($ = c.onError) == null || $.call(c, new Error(Ot), { sessionId: L });
    }
  }
  function ge(N) {
    return R(
      N,
      "lk.chat"
      /* Chat */
    );
  }
  async function ee() {
    var N, $;
    u && (await Z(), await u.disconnect()), x(), m = !1, (N = c.onConnectionStateChange) == null || N.call(c, F.Disconnected), ($ = c.onAgentActivityStateChange) == null || $.call(c, Qe.Idle);
  }
  return {
    speak(N) {
      const $ = typeof N == "string" ? N : JSON.stringify(N);
      return R(
        $,
        "did.speak"
        /* Speak */
      );
    },
    disconnect: ee,
    async reconnect() {
      var N, $, J;
      if ((u == null ? void 0 : u.state) === l.Connected) {
        a("Room is already connected");
        return;
      }
      if (!u || !A || !P)
        throw a("Cannot reconnect: missing room, URL or token"), new Error("Cannot reconnect: session not available");
      a("Reconnecting to LiveKit room, state:", u.state), (N = c.onConnectionStateChange) == null || N.call(c, F.Connecting);
      try {
        if (await u.connect(A, P), a("Room reconnected"), m = !0, u.remoteParticipants.size === 0) {
          if (a("Waiting for agent to join..."), !await new Promise((ae) => {
            const oe = setTimeout(() => {
              u == null || u.off(s.ParticipantConnected, ce), ae(!1);
            }, 5e3), ce = () => {
              clearTimeout(oe), u == null || u.off(s.ParticipantConnected, ce), ae(!0);
            };
            u == null || u.on(s.ParticipantConnected, ce);
          }))
            throw a("Agent did not join within timeout"), await u.disconnect(), new Error("Agent did not rejoin the room");
          a("Agent joined");
        }
        ($ = c.onConnectionStateChange) == null || $.call(c, F.Connected);
      } catch (ae) {
        throw a("Failed to reconnect:", ae), (J = c.onConnectionStateChange) == null || J.call(c, F.Fail), ae;
      }
    },
    sendDataChannelMessage: se,
    sendTextMessage: ge,
    publishMicrophoneStream: U,
    unpublishMicrophoneStream: Z,
    sessionId: L,
    streamId: L,
    streamType: y,
    interruptAvailable: !0,
    triggersAvailable: !1
  };
}
const no = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  DataChannelTopic: rr,
  createLiveKitStreamingManager: to,
  handleInitError: zn
}, Symbol.toStringTag, { value: "Module" }));
function ro(t, e, n) {
  if (!t)
    throw new Error("Please connect to the agent first");
  if (!t.interruptAvailable)
    throw new Error("Interrupt is not enabled for this stream");
  if (e !== $e.Fluent)
    throw new Error("Interrupt only available for Fluent streams");
  if (!n)
    throw new Error("No active video to interrupt");
}
async function io(t, e) {
  const n = {
    type: Ie.StreamInterrupt,
    videoId: e,
    timestamp: Date.now()
  };
  t.sendDataChannelMessage(JSON.stringify(n));
}
async function ao(t) {
  const e = {
    topic: rr.Interrupt
  };
  t.sendDataChannelMessage(JSON.stringify(e));
}
function oo(t) {
  return new Promise((e, n) => {
    const { callbacks: r, host: i, auth: a, externalId: o } = t, { onMessage: s = null, onOpen: l = null, onClose: c = null, onError: g = null } = r || {}, d = new WebSocket(`${i}?authorization=${encodeURIComponent(bi(a, o))}`);
    d.onmessage = s, d.onclose = c, d.onerror = (f) => {
      console.error(f), g == null || g("Websocket failed to connect", f), n(f);
    }, d.onopen = (f) => {
      l == null || l(f), e(d);
    };
  });
}
async function so(t) {
  const { retries: e = 1 } = t;
  let n = null;
  for (let r = 0; (n == null ? void 0 : n.readyState) !== WebSocket.OPEN; r++)
    try {
      n = await oo(t);
    } catch (i) {
      if (r === e)
        throw i;
      await wi(r * 500);
    }
  return n;
}
async function co(t, e, n, r) {
  const i = n != null && n.onMessage ? [n.onMessage] : [], a = await so({
    auth: t,
    host: e,
    externalId: r,
    callbacks: {
      onError: (o) => {
        var s;
        return (s = n.onError) == null ? void 0 : s.call(n, new Pa(o));
      },
      onMessage(o) {
        const s = JSON.parse(o.data);
        i.forEach((l) => l(s.event, s));
      }
    }
  });
  return {
    socket: a,
    disconnect: () => a.close(),
    subscribeToEvents: (o) => i.push(o)
  };
}
function lo(t) {
  if (t.answer !== void 0)
    return t.answer;
  let e = 0, n = "";
  for (; e in t; )
    n += t[e++];
  return n;
}
function uo(t, e, n) {
  if (!t.content)
    return;
  const r = {
    id: t.id || `user-${Date.now()}`,
    role: t.role,
    content: t.content,
    created_at: t.created_at || (/* @__PURE__ */ new Date()).toISOString(),
    transcribed: !0
  };
  e.messages.push(r), n == null || n([...e.messages], "user");
}
function ho(t, e, n, r, i) {
  if (t === Je.Transcribe && e.content) {
    uo(e, r, i);
    return;
  }
  if (!(t === Je.Partial || t === Je.Answer))
    return;
  const a = r.messages[r.messages.length - 1];
  let o;
  if (a != null && a.transcribed && a.role === "user")
    t === Je.Answer && e.content, o = {
      id: e.id || `assistant-${Date.now()}`,
      role: e.role || "assistant",
      content: e.content || "",
      created_at: e.created_at || (/* @__PURE__ */ new Date()).toISOString()
    }, r.messages.push(o);
  else if ((a == null ? void 0 : a.role) === "assistant")
    o = a;
  else
    return;
  const { content: s, sequence: l } = e;
  t === Je.Partial ? n[l] = s : n.answer = s;
  const c = lo(n);
  (o.content !== c || t === Je.Answer) && (o.content = c, i == null || i([...r.messages], t));
}
function go(t, e, n, r, i) {
  let a = {};
  return {
    clearQueue: () => a = {},
    onMessage: (o, s) => {
      var l, c;
      if ("content" in s) {
        const g = o === Ie.ChatAnswer ? Je.Answer : o === Ie.ChatAudioTranscribed ? Je.Transcribe : o;
        ho(g, s, a, e, n.callbacks.onNewMessage), g === Je.Answer && t.track("agent-message-received", {
          messages: e.messages.length,
          mode: e.chatMode
        });
      } else {
        const g = Ie, d = [g.StreamVideoDone, g.StreamVideoError, g.StreamVideoRejected], f = [g.StreamFailed, g.StreamVideoError, g.StreamVideoRejected], p = Ga(s, r, { mode: e.chatMode });
        if (o = o, o === g.StreamVideoCreated)
          t.linkTrack("agent-video", p, g.StreamVideoCreated, ["start"]);
        else if (d.includes(o)) {
          const u = o.split("/")[1];
          f.includes(o) ? t.track("agent-video", { ...p, event: u }) : t.linkTrack("agent-video", { ...p, event: u }, o, ["done"]);
        }
        f.includes(o) && ((c = (l = n.callbacks).onError) == null || c.call(l, new Error(`Stream failed with event ${o}`), { data: s })), s.event === g.StreamDone && i();
      }
    }
  };
}
function fo(t, e, n, r) {
  const i = tr(t, `${e}/agents/${n}`, r);
  return {
    createStream(a, o) {
      return i.post("/streams", a, { signal: o });
    },
    startConnection(a, o, s, l) {
      return i.post(
        `/streams/${a}/sdp`,
        {
          session_id: s,
          answer: o
        },
        { signal: l }
      );
    },
    addIceCandidate(a, o, s, l) {
      return i.post(
        `/streams/${a}/ice`,
        {
          session_id: s,
          ...o
        },
        { signal: l }
      );
    },
    sendStreamRequest(a, o, s) {
      return i.post(`/streams/${a}`, {
        session_id: o,
        ...s
      });
    },
    close(a, o) {
      return i.delete(`/streams/${a}`, { session_id: o });
    }
  };
}
function po(t, e, n) {
  const r = (e.timestamp - t.timestamp) / 1e3;
  return {
    duration: r,
    bytesReceived: e.bytesReceived - t.bytesReceived,
    bitrate: Math.round((e.bytesReceived - t.bytesReceived) * 8 / r),
    packetsReceived: e.packetsReceived - t.packetsReceived,
    packetsLost: e.packetsLost - t.packetsLost,
    framesDropped: e.framesDropped - t.framesDropped,
    framesDecoded: e.framesDecoded - t.framesDecoded,
    jitter: e.jitter,
    avgJitterDelayInInterval: (e.jitterBufferDelay - t.jitterBufferDelay) / (e.jitterBufferEmittedCount - t.jitterBufferEmittedCount),
    jitterBufferEmittedCount: e.jitterBufferEmittedCount - t.jitterBufferEmittedCount,
    jitterBufferDelay: (e.jitterBufferDelay - t.jitterBufferDelay) / r,
    framesPerSecond: e.framesPerSecond,
    freezeCount: e.freezeCount - t.freezeCount,
    freezeDuration: e.freezeDuration - t.freezeDuration,
    lowFpsCount: n
  };
}
function mo(t) {
  return t.filter(
    (e) => e.freezeCount > 0 || e.framesPerSecond < 21 || e.framesDropped > 0 || e.packetsLost > 0
  ).map((e) => {
    const { timestamp: n, ...r } = e, i = [];
    return e.freezeCount > 0 && i.push("freeze"), e.framesPerSecond < 21 && i.push("low fps"), e.framesDropped > 0 && i.push("frames dropped"), e.packetsLost > 0 && i.push("packet loss"), {
      ...r,
      causes: i
    };
  });
}
function _o(t) {
  let e = "", n = 0;
  for (const r of t.values()) {
    if (r && r.type === "codec" && r.mimeType.startsWith("video") && (e = r.mimeType.split("/")[1]), r && r.type === "candidate-pair") {
      const i = r.currentRoundTripTime, a = r.nominated === !0;
      i > 0 && (a || n === 0) && (n = i);
    }
    if (r && r.type === "inbound-rtp" && r.kind === "video")
      return {
        codec: e,
        rtt: n,
        timestamp: r.timestamp,
        bytesReceived: r.bytesReceived,
        packetsReceived: r.packetsReceived,
        packetsLost: r.packetsLost,
        framesDropped: r.framesDropped,
        framesDecoded: r.framesDecoded,
        jitter: r.jitter,
        jitterBufferDelay: r.jitterBufferDelay,
        jitterBufferEmittedCount: r.jitterBufferEmittedCount,
        avgJitterDelayInInterval: r.jitterBufferDelay / r.jitterBufferEmittedCount,
        frameWidth: r.frameWidth,
        frameHeight: r.frameHeight,
        framesPerSecond: r.framesPerSecond,
        freezeCount: r.freezeCount,
        freezeDuration: r.totalFreezesDuration
      };
  }
  return {};
}
function vo(t, e, n) {
  const r = t.map((l, c) => c === 0 ? n ? {
    timestamp: l.timestamp,
    duration: 0,
    rtt: l.rtt,
    bytesReceived: l.bytesReceived - n.bytesReceived,
    bitrate: (l.bytesReceived - n.bytesReceived) * 8 / (e / 1e3),
    packetsReceived: l.packetsReceived - n.packetsReceived,
    packetsLost: l.packetsLost - n.packetsLost,
    framesDropped: l.framesDropped - n.framesDropped,
    framesDecoded: l.framesDecoded - n.framesDecoded,
    jitter: l.jitter,
    jitterBufferDelay: l.jitterBufferDelay - n.jitterBufferDelay,
    jitterBufferEmittedCount: l.jitterBufferEmittedCount - n.jitterBufferEmittedCount,
    avgJitterDelayInInterval: (l.jitterBufferDelay - n.jitterBufferDelay) / (l.jitterBufferEmittedCount - n.jitterBufferEmittedCount),
    framesPerSecond: l.framesPerSecond,
    freezeCount: l.freezeCount - n.freezeCount,
    freezeDuration: l.freezeDuration - n.freezeDuration
  } : {
    timestamp: l.timestamp,
    rtt: l.rtt,
    duration: 0,
    bytesReceived: l.bytesReceived,
    bitrate: l.bytesReceived * 8 / (e / 1e3),
    packetsReceived: l.packetsReceived,
    packetsLost: l.packetsLost,
    framesDropped: l.framesDropped,
    framesDecoded: l.framesDecoded,
    jitter: l.jitter,
    jitterBufferDelay: l.jitterBufferDelay,
    jitterBufferEmittedCount: l.jitterBufferEmittedCount,
    avgJitterDelayInInterval: l.jitterBufferDelay / l.jitterBufferEmittedCount,
    framesPerSecond: l.framesPerSecond,
    freezeCount: l.freezeCount,
    freezeDuration: l.freezeDuration
  } : {
    timestamp: l.timestamp,
    duration: e * c / 1e3,
    rtt: l.rtt,
    bytesReceived: l.bytesReceived - t[c - 1].bytesReceived,
    bitrate: (l.bytesReceived - t[c - 1].bytesReceived) * 8 / (e / 1e3),
    packetsReceived: l.packetsReceived - t[c - 1].packetsReceived,
    packetsLost: l.packetsLost - t[c - 1].packetsLost,
    framesDropped: l.framesDropped - t[c - 1].framesDropped,
    framesDecoded: l.framesDecoded - t[c - 1].framesDecoded,
    jitter: l.jitter,
    jitterBufferDelay: l.jitterBufferDelay - t[c - 1].jitterBufferDelay,
    jitterBufferEmittedCount: l.jitterBufferEmittedCount - t[c - 1].jitterBufferEmittedCount,
    avgJitterDelayInInterval: (l.jitterBufferDelay - t[c - 1].jitterBufferDelay) / (l.jitterBufferEmittedCount - t[c - 1].jitterBufferEmittedCount),
    framesPerSecond: l.framesPerSecond,
    freezeCount: l.freezeCount - t[c - 1].freezeCount,
    freezeDuration: l.freezeDuration - t[c - 1].freezeDuration
  }), i = mo(r), a = i.reduce((l, c) => l + (c.causes.includes("low fps") ? 1 : 0), 0), o = r.filter((l) => !!l.avgJitterDelayInInterval).map((l) => l.avgJitterDelayInInterval), s = r.filter((l) => !!l.rtt).map((l) => l.rtt);
  return {
    webRTCStats: {
      anomalies: i,
      minRtt: Math.min(...s),
      avgRtt: _r(s),
      maxRtt: Math.max(...s),
      aggregateReport: po(t[0], t[t.length - 1], a),
      minJitterDelayInInterval: Math.min(...o),
      maxJitterDelayInInterval: Math.max(...o),
      avgJitterDelayInInterval: _r(o)
    },
    codec: t[0].codec,
    resolution: `${t[0].frameWidth}x${t[0].frameHeight}`
  };
}
const jn = 100, wo = Math.max(Math.ceil(400 / jn), 1), yo = 0.25, Co = 0.28;
function bo() {
  let t = 0, e, n, r = 0;
  return (i) => {
    for (const a of i.values())
      if (a && a.type === "inbound-rtp" && a.kind === "video") {
        const o = a.jitterBufferDelay, s = a.jitterBufferEmittedCount;
        if (n && s > n) {
          const g = o - e, d = s - n;
          r = g / d;
        }
        e = o, n = s;
        const l = a.framesDecoded, c = l - t > 0;
        return t = l, { isReceiving: c, avgJitterDelayInInterval: r, freezeCount: a.freezeCount };
      }
    return { isReceiving: !1, avgJitterDelayInInterval: r };
  };
}
function So(t, e, n, r, i) {
  let a = [], o, s = 0, l = !1, c = it.Unknown, g = it.Unknown, d = 0, f = 0;
  const p = bo();
  return setInterval(async () => {
    const u = await t.getStats(), { isReceiving: m, avgJitterDelayInInterval: y, freezeCount: C } = p(u), v = _o(u);
    if (m)
      s = 0, d = C - f, g = y < yo ? it.Strong : y > Co && d > 1 ? it.Weak : c, g !== c && (i == null || i(g), c = g, f += d, d = 0), l || (r == null || r(he.Start), o = a[a.length - 1], a = [], l = !0), a.push(v);
    else if (l && (s++, s >= wo)) {
      const M = vo(a, jn, o);
      r == null || r(he.Stop, M), e() || n(), f = C, l = !1;
    }
  }, jn);
}
const Mo = (window.RTCPeerConnection || window.webkitRTCPeerConnection || window.mozRTCPeerConnection).bind(window);
function yr(t) {
  switch (t) {
    case "connected":
      return F.Connected;
    case "checking":
      return F.Connecting;
    case "failed":
      return F.Fail;
    case "new":
      return F.New;
    case "closed":
      return F.Closed;
    case "disconnected":
      return F.Disconnected;
    case "completed":
      return F.Completed;
    default:
      return F.New;
  }
}
const ko = (t) => (e) => {
  const [n, r = ""] = e.split(/:(.+)/);
  try {
    const i = JSON.parse(r);
    return t("parsed data channel message", { subject: n, data: i }), { subject: n, data: i };
  } catch (i) {
    return t("Failed to parse data channel message, returning data as string", { subject: n, rawData: r, error: i }), { subject: n, data: r };
  }
};
function xo({
  statsSignal: t,
  dataChannelSignal: e,
  onVideoStateChange: n,
  report: r
}) {
  t === he.Start && e === he.Start ? n == null || n(he.Start) : t === he.Stop && e === he.Stop && (n == null || n(he.Stop, r));
}
function Lo({
  statsSignal: t,
  dataChannelSignal: e,
  onVideoStateChange: n,
  onAgentActivityStateChange: r,
  report: i
}) {
  t === he.Start ? n == null || n(he.Start) : t === he.Stop && (n == null || n(he.Stop, i)), e === he.Start ? r == null || r(Qe.Talking) : e === he.Stop && (r == null || r(Qe.Idle));
}
function Cr({
  statsSignal: t,
  dataChannelSignal: e,
  onVideoStateChange: n,
  onAgentActivityStateChange: r,
  streamType: i,
  report: a
}) {
  i === $e.Legacy ? xo({ statsSignal: t, dataChannelSignal: e, onVideoStateChange: n, report: a }) : i === $e.Fluent && Lo({
    statsSignal: t,
    dataChannelSignal: e,
    onVideoStateChange: n,
    onAgentActivityStateChange: r,
    report: a
  });
}
async function Io(t, e, { debug: n = !1, callbacks: r, auth: i, baseURL: a = Wt, analytics: o }, s) {
  var l;
  const c = ki(n, "WebRTCStreamingManager"), g = ko(c);
  let d = !1, f = !1, p = he.Stop, u = he.Stop;
  const { startConnection: m, sendStreamRequest: y, close: C, createStream: v, addIceCandidate: M } = fo(
    i,
    a,
    t,
    r.onError
  ), {
    id: k,
    offer: L,
    ice_servers: P,
    session_id: A,
    fluent: _,
    interrupt_enabled: S,
    triggers_enabled: w
  } = await v(e, s);
  (l = r.onStreamCreated) == null || l.call(r, { stream_id: k, session_id: A, agent_id: t });
  const b = new Mo({ iceServers: P }), z = b.createDataChannel("JanusDataChannel");
  if (!A)
    throw new Error("Could not create session_id");
  const D = _ ? $e.Fluent : $e.Legacy;
  o.enrich({
    "stream-type": D
  });
  const q = e.stream_warmup && !_, V = () => d, B = () => {
    var x;
    d = !0, f && ((x = r.onConnectionStateChange) == null || x.call(r, F.Connected));
  }, H = So(
    b,
    V,
    B,
    (x, R) => Cr({
      statsSignal: u = x,
      dataChannelSignal: D === $e.Legacy ? p : void 0,
      onVideoStateChange: r.onVideoStateChange,
      onAgentActivityStateChange: r.onAgentActivityStateChange,
      report: R,
      streamType: D
    }),
    (x) => {
      var R;
      return (R = r.onConnectivityStateChange) == null ? void 0 : R.call(r, x);
    }
  );
  b.onicecandidate = (x) => {
    var R;
    c("peerConnection.onicecandidate", x);
    try {
      x.candidate && x.candidate.sdpMid && x.candidate.sdpMLineIndex !== null ? M(
        k,
        {
          candidate: x.candidate.candidate,
          sdpMid: x.candidate.sdpMid,
          sdpMLineIndex: x.candidate.sdpMLineIndex
        },
        A,
        s
      ) : M(k, { candidate: null }, A, s);
    } catch (se) {
      (R = r.onError) == null || R.call(r, se, { streamId: k });
    }
  }, z.onopen = () => {
    f = !0, (!q || d) && B();
  };
  const Y = (x) => {
    var R;
    (R = r.onVideoIdChange) == null || R.call(r, x);
  };
  function X(x, R) {
    if (x === Ie.StreamStarted && typeof R == "object" && "metadata" in R) {
      const se = R.metadata;
      Y(se.videoId);
    }
    x === Ie.StreamDone && Y(null), p = x === Ie.StreamStarted ? he.Start : he.Stop, Cr({
      statsSignal: D === $e.Legacy ? u : void 0,
      dataChannelSignal: p,
      onVideoStateChange: r.onVideoStateChange,
      onAgentActivityStateChange: r.onAgentActivityStateChange,
      streamType: D
    });
  }
  function K(x, R) {
    var se;
    const ge = typeof R == "string" ? R : R == null ? void 0 : R.metadata;
    ge && o.enrich({ streamMetadata: ge }), (se = r.onStreamReady) == null || se.call(r);
  }
  const U = {
    [Ie.StreamStarted]: X,
    [Ie.StreamDone]: X,
    [Ie.StreamReady]: K
  };
  z.onmessage = (x) => {
    var R;
    const { subject: se, data: ge } = g(x.data);
    (R = U[se]) == null || R.call(U, se, ge);
  }, b.oniceconnectionstatechange = () => {
    var x;
    c("peerConnection.oniceconnectionstatechange => " + b.iceConnectionState);
    const R = yr(b.iceConnectionState);
    R !== F.Connected && ((x = r.onConnectionStateChange) == null || x.call(r, R));
  }, b.ontrack = (x) => {
    var R;
    c("peerConnection.ontrack", x), (R = r.onSrcObjectReady) == null || R.call(r, x.streams[0]);
  }, await b.setRemoteDescription(L), c("set remote description OK");
  const Z = await b.createAnswer();
  return c("create answer OK"), await b.setLocalDescription(Z), c("set local description OK"), await m(k, Z, A, s), c("start connection OK"), {
    /**
     * Method to send request to server to get clip or talk depend on you payload
     * @param payload
     */
    speak(x) {
      return y(k, A, x);
    },
    /**
     * Method to close RTC connection
     */
    async disconnect() {
      var x;
      if (k) {
        const R = yr(b.iceConnectionState);
        if (b) {
          if (R === F.New) {
            clearInterval(H);
            return;
          }
          b.close(), b.oniceconnectionstatechange = null, b.onnegotiationneeded = null, b.onicecandidate = null, b.ontrack = null;
        }
        try {
          R === F.Connected && await C(k, A).catch((se) => {
          });
        } catch (se) {
          c("Error on close stream connection", se);
        }
        (x = r.onAgentActivityStateChange) == null || x.call(r, Qe.Idle), clearInterval(H);
      }
    },
    /**
     * Method to send data channel messages to the server
     */
    sendDataChannelMessage(x) {
      var R, se;
      if (!d || z.readyState !== "open") {
        c("Data channel is not ready for sending messages"), (R = r.onError) == null || R.call(r, new Error("Data channel is not ready for sending messages"), {
          streamId: k
        });
        return;
      }
      try {
        z.send(x);
      } catch (ge) {
        c("Error sending data channel message", ge), (se = r.onError) == null || se.call(r, ge, { streamId: k });
      }
    },
    /**
     * Session identifier information, should be returned in the body of all streaming requests
     */
    sessionId: A,
    /**
     * Id of current RTC stream
     */
    streamId: k,
    streamType: D,
    interruptAvailable: S ?? !1,
    triggersAvailable: w ?? !1
  };
}
var Fn = /* @__PURE__ */ ((t) => (t.V1 = "v1", t.V2 = "v2", t))(Fn || {});
async function No(t, e, n, r) {
  const i = t.id;
  switch (e.version) {
    case "v1": {
      const { version: a, ...o } = e;
      return Io(i, o, n, r);
    }
    case "v2": {
      const { version: a, ...o } = e;
      switch (o.transport_provider) {
        case yn.Livekit:
          const { createLiveKitStreamingManager: s } = await Promise.resolve().then(() => no);
          return s(i, o, n);
        default:
          throw new Error(`Unsupported transport provider: ${o.transport_provider}`);
      }
    }
    default:
      throw new Error(`Invalid stream version: ${e.version}`);
  }
}
const To = "cht";
function Ao() {
  return {
    transport_provider: yn.Livekit
  };
}
function Eo(t) {
  var e, n;
  const { streamOptions: r } = t ?? {}, i = ((e = t == null ? void 0 : t.mixpanelAdditionalProperties) == null ? void 0 : e.plan) !== void 0 ? {
    plan: (n = t.mixpanelAdditionalProperties) == null ? void 0 : n.plan
  } : void 0;
  return { output_resolution: r == null ? void 0 : r.outputResolution, session_timeout: r == null ? void 0 : r.sessionTimeout, stream_warmup: r == null ? void 0 : r.streamWarmup, compatibility_mode: r == null ? void 0 : r.compatibilityMode, fluent: r == null ? void 0 : r.fluent, ...i && { end_user_data: i } };
}
function Do(t, e) {
  return er(t.presenter.type) ? { version: Fn.V2, ...Ao() } : { version: Fn.V1, ...Eo(e) };
}
function Oo(t, e, n, r, i) {
  i === $e.Fluent ? Po(t, e, n, r, i) : zo(t, e, n, r, i);
}
function Po(t, e, n, r, i) {
  t === he.Start ? r.track("stream-session", { event: "start", "stream-type": i }) : t === he.Stop && r.track("stream-session", {
    event: "stop",
    is_greenscreen: e.presenter.type === "clip" && e.presenter.is_greenscreen,
    background: e.presenter.type === "clip" && e.presenter.background,
    "stream-type": i,
    ...n
  });
}
function Ro(t, e, n, r) {
  at.get() <= 0 || (t === he.Start ? n.linkTrack(
    "agent-video",
    { event: "start", latency: at.get(!0), "stream-type": r },
    "start",
    [Ie.StreamVideoCreated]
  ) : t === he.Stop && n.linkTrack(
    "agent-video",
    {
      event: "stop",
      is_greenscreen: e.presenter.type === "clip" && e.presenter.is_greenscreen,
      background: e.presenter.type === "clip" && e.presenter.background,
      "stream-type": r
    },
    "done",
    [Ie.StreamVideoDone]
  ));
}
function zo(t, e, n, r, i) {
  at.get() <= 0 || (t === he.Start ? r.linkTrack(
    "agent-video",
    { event: "start", latency: at.get(!0), "stream-type": i },
    "start",
    [Ie.StreamVideoCreated]
  ) : t === he.Stop && r.linkTrack(
    "agent-video",
    {
      event: "stop",
      is_greenscreen: e.presenter.type === "clip" && e.presenter.is_greenscreen,
      background: e.presenter.type === "clip" && e.presenter.background,
      "stream-type": i,
      ...n
    },
    "done",
    [Ie.StreamVideoDone]
  ));
}
function br(t, e, n, r) {
  return at.reset(), wr.update(), new Promise(async (i, a) => {
    try {
      let o, s = !1;
      const l = Do(t, e);
      n.enrich({
        "stream-version": l.version.toString()
      }), o = await No(
        t,
        l,
        {
          ...e,
          analytics: n,
          callbacks: {
            ...e.callbacks,
            onConnectionStateChange: (c) => {
              var g, d;
              (d = (g = e.callbacks).onConnectionStateChange) == null || d.call(g, c), c === F.Connected && (o ? i(o) : s = !0);
            },
            onVideoStateChange: (c, g) => {
              var d, f;
              (f = (d = e.callbacks).onVideoStateChange) == null || f.call(d, c), Oo(
                c,
                t,
                g,
                n,
                o.streamType
              );
            },
            onAgentActivityStateChange: (c) => {
              var g, d;
              (d = (g = e.callbacks).onAgentActivityStateChange) == null || d.call(g, c), c === Qe.Talking ? Rn.update() : Rn.reset(), Ro(
                c === Qe.Talking ? he.Start : he.Stop,
                t,
                n,
                o.streamType
              );
            },
            onStreamReady: () => {
              const c = wr.get(!0);
              n.track("agent-chat", { event: "ready", latency: c });
            }
          }
        },
        r
      ), s && i(o);
    } catch (o) {
      a(o);
    }
  });
}
async function jo(t, e, n, r, i) {
  var a, o, s, l;
  const c = async () => {
    if (er(t.presenter.type)) {
      const u = await br(t, e, r), m = `${To}_${u.sessionId}`, y = (/* @__PURE__ */ new Date()).toISOString();
      return { chatResult: {
        chatMode: T.Functional,
        chat: {
          id: m,
          agent_id: t.id,
          owner_id: t.owner_id ?? "",
          created: y,
          modified: y,
          agent_id__created_at: y,
          agent_id__modified_at: y,
          chat_mode: T.Functional,
          messages: []
        }
      }, streamingManager: u };
    } else {
      const u = new AbortController(), m = u.signal;
      let y;
      try {
        const C = Mi(
          t,
          n,
          r,
          e.mode,
          e.persistentChat,
          i
        ), v = br(t, e, r, m).then((L) => (y = L, L)), [M, k] = await Promise.all([C, v]);
        return { chatResult: M, streamingManager: k };
      } catch (C) {
        throw u.abort(), y && await y.disconnect().catch(() => {
        }), C;
      }
    }
  }, { chatResult: g, streamingManager: d } = await c(), { chat: f, chatMode: p } = g;
  return p && e.mode !== void 0 && p !== e.mode && (e.mode = p, (o = (a = e.callbacks).onModeChange) == null || o.call(a, p), p !== T.Functional) ? ((l = (s = e.callbacks).onError) == null || l.call(s, new Oa(p)), d == null || d.disconnect(), { chat: f }) : { chat: f, streamingManager: d };
}
async function Fo(t, e) {
  var n, r, i;
  let a = !0, o = null;
  const s = e.mixpanelKey || Fa, l = e.wsURL || ja, c = e.baseURL || Wt, g = e.mode || T.Functional, d = {
    messages: [],
    chatMode: g
  }, f = Ya({
    token: s,
    agentId: t,
    isEnabled: e.enableAnalitics,
    externalId: e.externalId,
    mixpanelAdditionalProperties: e.mixpanelAdditionalProperties
  }), p = Date.now();
  vr(() => {
    f.track("agent-sdk", { event: "init" }, p);
  });
  const u = Ha(e.auth, c, e.callbacks.onError, e.externalId), m = await u.getById(t), y = er(m.presenter.type);
  f.enrich(Ka(m));
  const { onMessage: C, clearQueue: v } = go(
    f,
    d,
    e,
    m,
    () => {
      var _;
      return (_ = d.socketManager) == null ? void 0 : _.disconnect();
    }
  );
  d.messages = Qa(e.initialMessages), (r = (n = e.callbacks).onNewMessage) == null || r.call(n, [...d.messages], "answer");
  const M = (_) => {
    o = _;
  }, k = Date.now();
  vr(() => {
    f.track("agent-sdk", { event: "loaded", ...Za(m) }, k);
  });
  async function L(_) {
    var S, w, b, z, D, q, V;
    (w = (S = e.callbacks).onConnectionStateChange) == null || w.call(S, F.Connecting), at.reset(), _ && !a && (delete d.chat, (z = (b = e.callbacks).onNewMessage) == null || z.call(b, [...d.messages], "answer"));
    const B = g === T.DirectPlayback || y ? Promise.resolve(void 0) : co(
      e.auth,
      l,
      { onMessage: C, onError: e.callbacks.onError },
      e.externalId
    ), H = On(
      () => jo(
        m,
        {
          ...e,
          mode: g,
          callbacks: { ...e.callbacks, onVideoIdChange: M, onMessage: C }
        },
        u,
        f,
        d.chat
      ),
      {
        limit: 3,
        timeout: Ra,
        timeoutErrorMessage: "Timeout initializing the stream",
        shouldRetryFn: (U) => (U == null ? void 0 : U.message) !== "Could not connect" && U.status !== 429 && (U == null ? void 0 : U.message) !== "InsufficientCreditsError",
        delayMs: 1e3
      }
    ).catch((U) => {
      var Z, x;
      throw A(T.Maintenance), (x = (Z = e.callbacks).onConnectionStateChange) == null || x.call(Z, F.Fail), U;
    }), [Y, { streamingManager: X, chat: K }] = await Promise.all([B, H]);
    K && K.id !== ((D = d.chat) == null ? void 0 : D.id) && ((V = (q = e.callbacks).onNewChat) == null || V.call(q, K.id)), d.streamingManager = X, d.socketManager = Y, d.chat = K, a = !1, f.enrich({
      chatId: K == null ? void 0 : K.id,
      streamId: X == null ? void 0 : X.streamId,
      mode: d.chatMode
    }), A((K == null ? void 0 : K.chat_mode) ?? g);
  }
  async function P() {
    var _, S, w, b;
    (_ = d.socketManager) == null || _.disconnect(), await ((S = d.streamingManager) == null ? void 0 : S.disconnect()), delete d.streamingManager, delete d.socketManager, (b = (w = e.callbacks).onConnectionStateChange) == null || b.call(w, F.Disconnected);
  }
  async function A(_) {
    var S, w;
    _ !== d.chatMode && (f.track("agent-mode-change", { mode: _ }), d.chatMode = _, d.chatMode !== T.Functional && await P(), (w = (S = e.callbacks).onModeChange) == null || w.call(S, _));
  }
  return {
    agent: m,
    getStreamType: () => {
      var _;
      return (_ = d.streamingManager) == null ? void 0 : _.streamType;
    },
    getIsInterruptAvailable: () => {
      var _;
      return ((_ = d.streamingManager) == null ? void 0 : _.interruptAvailable) ?? !1;
    },
    getIsTriggersAvailable: () => {
      var _;
      return ((_ = d.streamingManager) == null ? void 0 : _.triggersAvailable) ?? !1;
    },
    starterMessages: ((i = m.knowledge) == null ? void 0 : i.starter_message) || [],
    getSTTToken: () => u.getSTTToken(m.id),
    changeMode: A,
    enrichAnalytics: f.enrich,
    async connect() {
      await L(!0), f.track("agent-chat", {
        event: "connect",
        mode: d.chatMode
      });
    },
    async reconnect() {
      const _ = d.streamingManager;
      if (y && _ != null && _.reconnect) {
        try {
          await _.reconnect(), f.track("agent-chat", {
            event: "reconnect",
            mode: d.chatMode
          });
        } catch {
          await P(), await L(!1);
        }
        return;
      }
      await P(), await L(!1), f.track("agent-chat", {
        event: "reconnect",
        mode: d.chatMode
      });
    },
    async disconnect() {
      await P(), f.track("agent-chat", {
        event: "disconnect",
        mode: d.chatMode
      });
    },
    async publishMicrophoneStream(_) {
      var S;
      if (!((S = d.streamingManager) != null && S.publishMicrophoneStream))
        throw new Error("publishMicrophoneStream is not available for this streaming manager");
      return d.streamingManager.publishMicrophoneStream(_);
    },
    async unpublishMicrophoneStream() {
      var _;
      if (!((_ = d.streamingManager) != null && _.unpublishMicrophoneStream))
        throw new Error("unpublishMicrophoneStream is not available for this streaming manager");
      return d.streamingManager.unpublishMicrophoneStream();
    },
    async chat(_) {
      var S, w, b, z, D;
      const q = () => {
        if (Ci(g))
          throw new St(`${g} is enabled, chat is disabled`);
        if (_.length >= 800)
          throw new St("Message cannot be more than 800 characters");
        if (_.length === 0)
          throw new St("Message cannot be empty");
        if (d.chatMode === T.Maintenance)
          throw new St("Chat is in maintenance mode");
        if (![T.TextOnly, T.Playground].includes(d.chatMode)) {
          if (!d.streamingManager)
            throw new St("Streaming manager is not initialized");
          if (!d.chat)
            throw new St("Chat is not initialized");
        }
      }, V = async () => {
        var H, Y;
        if (!d.chat) {
          const X = await Mi(
            m,
            u,
            f,
            d.chatMode,
            e.persistentChat
          );
          if (!X.chat)
            throw new Da(d.chatMode, !!e.persistentChat);
          d.chat = X.chat, (Y = (H = e.callbacks).onNewChat) == null || Y.call(H, d.chat.id);
        }
        return d.chat.id;
      }, B = async (H, Y) => On(y ? async () => {
        var X, K;
        return await ((K = (X = d.streamingManager) == null ? void 0 : X.sendTextMessage) == null ? void 0 : K.call(X, _)), Promise.resolve({});
      } : async () => {
        var X, K;
        return u.chat(
          m.id,
          Y,
          {
            chatMode: d.chatMode,
            streamId: (X = d.streamingManager) == null ? void 0 : X.streamId,
            sessionId: (K = d.streamingManager) == null ? void 0 : K.sessionId,
            messages: H.map(({ matches: U, ...Z }) => Z)
          },
          {
            ...Si(d.chatMode),
            skipErrorHandler: !0
          }
        );
      }, {
        limit: 2,
        shouldRetryFn: (X) => {
          var K, U, Z, x;
          const R = (K = X == null ? void 0 : X.message) == null ? void 0 : K.includes("missing or invalid session_id");
          return !((U = X == null ? void 0 : X.message) != null && U.includes("Stream Error")) && !R ? ((x = (Z = e.callbacks).onError) == null || x.call(Z, X), !1) : !0;
        },
        onRetry: async () => {
          await P(), await L(!1);
        }
      });
      try {
        v(), q(), d.messages.push({
          id: Lt(),
          role: "user",
          content: _,
          created_at: new Date(at.update()).toISOString()
        }), (w = (S = e.callbacks).onNewMessage) == null || w.call(S, [...d.messages], "user");
        const H = await V(), Y = await B([...d.messages], H);
        return d.messages.push({
          id: Lt(),
          role: "assistant",
          content: Y.result || "",
          created_at: (/* @__PURE__ */ new Date()).toISOString(),
          context: Y.context,
          matches: Y.matches
        }), f.track("agent-message-send", {
          event: "success",
          messages: d.messages.length + 1
        }), Y.result && ((z = (b = e.callbacks).onNewMessage) == null || z.call(b, [...d.messages], "answer"), f.track("agent-message-received", {
          latency: at.get(!0),
          messages: d.messages.length
        })), Y;
      } catch (H) {
        throw ((D = d.messages[d.messages.length - 1]) == null ? void 0 : D.role) === "assistant" && d.messages.pop(), f.track("agent-message-send", {
          event: "error",
          messages: d.messages.length
        }), H;
      }
    },
    rate(_, S, w) {
      var b, z, D, q;
      const V = d.messages.find((H) => H.id === _);
      if (d.chat) {
        if (!V)
          throw new Error("Message not found");
      } else throw new Error("Chat is not initialized");
      const B = ((b = V.matches) == null ? void 0 : b.map((H) => [H.document_id, H.id])) ?? [];
      return f.track("agent-rate", {
        event: w ? "update" : "create",
        thumb: S === 1 ? "up" : "down",
        knowledge_id: ((z = m.knowledge) == null ? void 0 : z.id) ?? "",
        matches: B,
        score: S
      }), w ? u.updateRating(m.id, d.chat.id, w, {
        knowledge_id: ((D = m.knowledge) == null ? void 0 : D.id) ?? "",
        message_id: _,
        matches: B,
        score: S
      }) : u.createRating(m.id, d.chat.id, {
        knowledge_id: ((q = m.knowledge) == null ? void 0 : q.id) ?? "",
        message_id: _,
        matches: B,
        score: S
      });
    },
    deleteRate(_) {
      if (!d.chat)
        throw new Error("Chat is not initialized");
      return f.track("agent-rate-delete", { type: "text" }), u.deleteRating(m.id, d.chat.id, _);
    },
    async speak(_) {
      var S, w, b;
      function z() {
        if (typeof _ == "string") {
          if (!m.presenter.voice)
            throw new Error("Presenter voice is not initialized");
          return {
            type: "text",
            provider: m.presenter.voice,
            input: _,
            ssml: !1
          };
        }
        if (_.type === "text" && !_.provider) {
          if (!m.presenter.voice)
            throw new Error("Presenter voice is not initialized");
          return {
            type: "text",
            provider: m.presenter.voice,
            input: _.input,
            ssml: _.ssml
          };
        }
        return _;
      }
      const D = z();
      if (f.track("agent-speak", D), at.update(), d.messages && D.type === "text" && (d.messages.push({
        id: Lt(),
        role: "assistant",
        content: D.input,
        created_at: (/* @__PURE__ */ new Date()).toISOString()
      }), (w = (S = e.callbacks).onNewMessage) == null || w.call(S, [...d.messages], "answer")), $a(d.chatMode))
        return {
          duration: 0,
          video_id: "",
          status: "success"
        };
      if (!d.streamingManager)
        throw new Error("Please connect to the agent first");
      return d.streamingManager.speak({
        script: D,
        metadata: { chat_id: (b = d.chat) == null ? void 0 : b.id, agent_id: m.id }
      });
    },
    async interrupt({ type: _ }) {
      var S, w, b;
      const z = d.messages[d.messages.length - 1];
      f.track("agent-video-interrupt", {
        type: _ || "click",
        video_duration_to_interrupt: Rn.get(!0),
        message_duration_to_interrupt: at.get(!0)
      }), z.interrupted = !0, (w = (S = e.callbacks).onNewMessage) == null || w.call(S, [...d.messages], "answer"), y ? ao(d.streamingManager) : (ro(d.streamingManager, (b = d.streamingManager) == null ? void 0 : b.streamType, o), io(d.streamingManager, o));
    }
  };
}
const Z2 = "false", xi = "prod", $o = "https://api.d-id.com", Bo = "wss://notifications.d-id.com", Li = "2.0.12", Uo = "38dcaccd-d46b-4105-a147-bd4c02409450", Vo = "pubfe3af4ae9f9aaa132f5c0ade5068028b", Ho = "62d004045797ac11b0801d86", $n = {
  mixpanelKey: "1a34d015dabbfa3d87482f1a647861fd"
}, Q = (t) => typeof t == "string", Pt = () => {
  let t, e;
  const n = new Promise((r, i) => {
    t = r, e = i;
  });
  return n.resolve = t, n.reject = e, n;
}, Sr = (t) => t == null ? "" : "" + t, Zo = (t, e, n) => {
  t.forEach((r) => {
    e[r] && (n[r] = e[r]);
  });
}, Ko = /###/g, Mr = (t) => t && t.indexOf("###") > -1 ? t.replace(Ko, ".") : t, kr = (t) => !t || Q(t), jt = (t, e, n) => {
  const r = Q(e) ? e.split(".") : e;
  let i = 0;
  for (; i < r.length - 1; ) {
    if (kr(t)) return {};
    const a = Mr(r[i]);
    !t[a] && n && (t[a] = new n()), Object.prototype.hasOwnProperty.call(t, a) ? t = t[a] : t = {}, ++i;
  }
  return kr(t) ? {} : {
    obj: t,
    k: Mr(r[i])
  };
}, xr = (t, e, n) => {
  const {
    obj: r,
    k: i
  } = jt(t, e, Object);
  if (r !== void 0 || e.length === 1) {
    r[i] = n;
    return;
  }
  let a = e[e.length - 1], o = e.slice(0, e.length - 1), s = jt(t, o, Object);
  for (; s.obj === void 0 && o.length; )
    a = `${o[o.length - 1]}.${a}`, o = o.slice(0, o.length - 1), s = jt(t, o, Object), s != null && s.obj && typeof s.obj[`${s.k}.${a}`] < "u" && (s.obj = void 0);
  s.obj[`${s.k}.${a}`] = n;
}, Wo = (t, e, n, r) => {
  const {
    obj: i,
    k: a
  } = jt(t, e, Object);
  i[a] = i[a] || [], i[a].push(n);
}, dn = (t, e) => {
  const {
    obj: n,
    k: r
  } = jt(t, e);
  if (n && Object.prototype.hasOwnProperty.call(n, r))
    return n[r];
}, Go = (t, e, n) => {
  const r = dn(t, n);
  return r !== void 0 ? r : dn(e, n);
}, Ii = (t, e, n) => {
  for (const r in e)
    r !== "__proto__" && r !== "constructor" && (r in t ? Q(t[r]) || t[r] instanceof String || Q(e[r]) || e[r] instanceof String ? n && (t[r] = e[r]) : Ii(t[r], e[r], n) : t[r] = e[r]);
  return t;
}, Mt = (t) => t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g, "\\$&");
var qo = {
  "&": "&amp;",
  "<": "&lt;",
  ">": "&gt;",
  '"': "&quot;",
  "'": "&#39;",
  "/": "&#x2F;"
};
const Yo = (t) => Q(t) ? t.replace(/[&<>"'\/]/g, (e) => qo[e]) : t;
class Jo {
  constructor(e) {
    this.capacity = e, this.regExpMap = /* @__PURE__ */ new Map(), this.regExpQueue = [];
  }
  getRegExp(e) {
    const n = this.regExpMap.get(e);
    if (n !== void 0)
      return n;
    const r = new RegExp(e);
    return this.regExpQueue.length === this.capacity && this.regExpMap.delete(this.regExpQueue.shift()), this.regExpMap.set(e, r), this.regExpQueue.push(e), r;
  }
}
const Qo = [" ", ",", "?", "!", ";"], Xo = new Jo(20), es = (t, e, n) => {
  e = e || "", n = n || "";
  const r = Qo.filter((o) => e.indexOf(o) < 0 && n.indexOf(o) < 0);
  if (r.length === 0) return !0;
  const i = Xo.getRegExp(`(${r.map((o) => o === "?" ? "\\?" : o).join("|")})`);
  let a = !i.test(t);
  if (!a) {
    const o = t.indexOf(n);
    o > 0 && !i.test(t.substring(0, o)) && (a = !0);
  }
  return a;
}, Bn = (t, e, n = ".") => {
  if (!t) return;
  if (t[e])
    return Object.prototype.hasOwnProperty.call(t, e) ? t[e] : void 0;
  const r = e.split(n);
  let i = t;
  for (let a = 0; a < r.length; ) {
    if (!i || typeof i != "object")
      return;
    let o, s = "";
    for (let l = a; l < r.length; ++l)
      if (l !== a && (s += n), s += r[l], o = i[s], o !== void 0) {
        if (["string", "number", "boolean"].indexOf(typeof o) > -1 && l < r.length - 1)
          continue;
        a += l - a + 1;
        break;
      }
    i = o;
  }
  return i;
}, Bt = (t) => t == null ? void 0 : t.replace("_", "-"), ts = {
  type: "logger",
  log(t) {
    this.output("log", t);
  },
  warn(t) {
    this.output("warn", t);
  },
  error(t) {
    this.output("error", t);
  },
  output(t, e) {
    var n, r;
    (r = (n = console == null ? void 0 : console[t]) == null ? void 0 : n.apply) == null || r.call(n, console, e);
  }
};
class un {
  constructor(e, n = {}) {
    this.init(e, n);
  }
  init(e, n = {}) {
    this.prefix = n.prefix || "i18next:", this.logger = e || ts, this.options = n, this.debug = n.debug;
  }
  log(...e) {
    return this.forward(e, "log", "", !0);
  }
  warn(...e) {
    return this.forward(e, "warn", "", !0);
  }
  error(...e) {
    return this.forward(e, "error", "");
  }
  deprecate(...e) {
    return this.forward(e, "warn", "WARNING DEPRECATED: ", !0);
  }
  forward(e, n, r, i) {
    return i && !this.debug ? null : (Q(e[0]) && (e[0] = `${r}${this.prefix} ${e[0]}`), this.logger[n](e));
  }
  create(e) {
    return new un(this.logger, {
      prefix: `${this.prefix}:${e}:`,
      ...this.options
    });
  }
  clone(e) {
    return e = e || this.options, e.prefix = e.prefix || this.prefix, new un(this.logger, e);
  }
}
var ot = new un();
class Cn {
  constructor() {
    this.observers = {};
  }
  on(e, n) {
    return e.split(" ").forEach((r) => {
      this.observers[r] || (this.observers[r] = /* @__PURE__ */ new Map());
      const i = this.observers[r].get(n) || 0;
      this.observers[r].set(n, i + 1);
    }), this;
  }
  off(e, n) {
    if (this.observers[e]) {
      if (!n) {
        delete this.observers[e];
        return;
      }
      this.observers[e].delete(n);
    }
  }
  emit(e, ...n) {
    this.observers[e] && Array.from(this.observers[e].entries()).forEach(([i, a]) => {
      for (let o = 0; o < a; o++)
        i(...n);
    }), this.observers["*"] && Array.from(this.observers["*"].entries()).forEach(([i, a]) => {
      for (let o = 0; o < a; o++)
        i.apply(i, [e, ...n]);
    });
  }
}
class Lr extends Cn {
  constructor(e, n = {
    ns: ["translation"],
    defaultNS: "translation"
  }) {
    super(), this.data = e || {}, this.options = n, this.options.keySeparator === void 0 && (this.options.keySeparator = "."), this.options.ignoreJSONStructure === void 0 && (this.options.ignoreJSONStructure = !0);
  }
  addNamespaces(e) {
    this.options.ns.indexOf(e) < 0 && this.options.ns.push(e);
  }
  removeNamespaces(e) {
    const n = this.options.ns.indexOf(e);
    n > -1 && this.options.ns.splice(n, 1);
  }
  getResource(e, n, r, i = {}) {
    var c, g;
    const a = i.keySeparator !== void 0 ? i.keySeparator : this.options.keySeparator, o = i.ignoreJSONStructure !== void 0 ? i.ignoreJSONStructure : this.options.ignoreJSONStructure;
    let s;
    e.indexOf(".") > -1 ? s = e.split(".") : (s = [e, n], r && (Array.isArray(r) ? s.push(...r) : Q(r) && a ? s.push(...r.split(a)) : s.push(r)));
    const l = dn(this.data, s);
    return !l && !n && !r && e.indexOf(".") > -1 && (e = s[0], n = s[1], r = s.slice(2).join(".")), l || !o || !Q(r) ? l : Bn((g = (c = this.data) == null ? void 0 : c[e]) == null ? void 0 : g[n], r, a);
  }
  addResource(e, n, r, i, a = {
    silent: !1
  }) {
    const o = a.keySeparator !== void 0 ? a.keySeparator : this.options.keySeparator;
    let s = [e, n];
    r && (s = s.concat(o ? r.split(o) : r)), e.indexOf(".") > -1 && (s = e.split("."), i = n, n = s[1]), this.addNamespaces(n), xr(this.data, s, i), a.silent || this.emit("added", e, n, r, i);
  }
  addResources(e, n, r, i = {
    silent: !1
  }) {
    for (const a in r)
      (Q(r[a]) || Array.isArray(r[a])) && this.addResource(e, n, a, r[a], {
        silent: !0
      });
    i.silent || this.emit("added", e, n, r);
  }
  addResourceBundle(e, n, r, i, a, o = {
    silent: !1,
    skipCopy: !1
  }) {
    let s = [e, n];
    e.indexOf(".") > -1 && (s = e.split("."), i = r, r = n, n = s[1]), this.addNamespaces(n);
    let l = dn(this.data, s) || {};
    o.skipCopy || (r = JSON.parse(JSON.stringify(r))), i ? Ii(l, r, a) : l = {
      ...l,
      ...r
    }, xr(this.data, s, l), o.silent || this.emit("added", e, n, r);
  }
  removeResourceBundle(e, n) {
    this.hasResourceBundle(e, n) && delete this.data[e][n], this.removeNamespaces(n), this.emit("removed", e, n);
  }
  hasResourceBundle(e, n) {
    return this.getResource(e, n) !== void 0;
  }
  getResourceBundle(e, n) {
    return n || (n = this.options.defaultNS), this.getResource(e, n);
  }
  getDataByLanguage(e) {
    return this.data[e];
  }
  hasLanguageSomeTranslations(e) {
    const n = this.getDataByLanguage(e);
    return !!(n && Object.keys(n) || []).find((i) => n[i] && Object.keys(n[i]).length > 0);
  }
  toJSON() {
    return this.data;
  }
}
var Ni = {
  processors: {},
  addPostProcessor(t) {
    this.processors[t.name] = t;
  },
  handle(t, e, n, r, i) {
    return t.forEach((a) => {
      var o;
      e = ((o = this.processors[a]) == null ? void 0 : o.process(e, n, r, i)) ?? e;
    }), e;
  }
};
const Ti = Symbol("i18next/PATH_KEY");
function ns() {
  const t = [], e = /* @__PURE__ */ Object.create(null);
  let n;
  return e.get = (r, i) => {
    var a;
    return (a = n == null ? void 0 : n.revoke) == null || a.call(n), i === Ti ? t : (t.push(i), n = Proxy.revocable(r, e), n.proxy);
  }, Proxy.revocable(/* @__PURE__ */ Object.create(null), e).proxy;
}
function Un(t, e) {
  const {
    [Ti]: n
  } = t(ns());
  return n.join((e == null ? void 0 : e.keySeparator) ?? ".");
}
const Ir = {}, Nr = (t) => !Q(t) && typeof t != "boolean" && typeof t != "number";
class hn extends Cn {
  constructor(e, n = {}) {
    super(), Zo(["resourceStore", "languageUtils", "pluralResolver", "interpolator", "backendConnector", "i18nFormat", "utils"], e, this), this.options = n, this.options.keySeparator === void 0 && (this.options.keySeparator = "."), this.logger = ot.create("translator");
  }
  changeLanguage(e) {
    e && (this.language = e);
  }
  exists(e, n = {
    interpolation: {}
  }) {
    const r = {
      ...n
    };
    if (e == null) return !1;
    const i = this.resolve(e, r);
    return (i == null ? void 0 : i.res) !== void 0;
  }
  extractFromKey(e, n) {
    let r = n.nsSeparator !== void 0 ? n.nsSeparator : this.options.nsSeparator;
    r === void 0 && (r = ":");
    const i = n.keySeparator !== void 0 ? n.keySeparator : this.options.keySeparator;
    let a = n.ns || this.options.defaultNS || [];
    const o = r && e.indexOf(r) > -1, s = !this.options.userDefinedKeySeparator && !n.keySeparator && !this.options.userDefinedNsSeparator && !n.nsSeparator && !es(e, r, i);
    if (o && !s) {
      const l = e.match(this.interpolator.nestingRegexp);
      if (l && l.length > 0)
        return {
          key: e,
          namespaces: Q(a) ? [a] : a
        };
      const c = e.split(r);
      (r !== i || r === i && this.options.ns.indexOf(c[0]) > -1) && (a = c.shift()), e = c.join(i);
    }
    return {
      key: e,
      namespaces: Q(a) ? [a] : a
    };
  }
  translate(e, n, r) {
    let i = typeof n == "object" ? {
      ...n
    } : n;
    if (typeof i != "object" && this.options.overloadTranslationOptionHandler && (i = this.options.overloadTranslationOptionHandler(arguments)), typeof i == "object" && (i = {
      ...i
    }), i || (i = {}), e == null) return "";
    typeof e == "function" && (e = Un(e, {
      ...this.options,
      ...i
    })), Array.isArray(e) || (e = [String(e)]);
    const a = i.returnDetails !== void 0 ? i.returnDetails : this.options.returnDetails, o = i.keySeparator !== void 0 ? i.keySeparator : this.options.keySeparator, {
      key: s,
      namespaces: l
    } = this.extractFromKey(e[e.length - 1], i), c = l[l.length - 1];
    let g = i.nsSeparator !== void 0 ? i.nsSeparator : this.options.nsSeparator;
    g === void 0 && (g = ":");
    const d = i.lng || this.language, f = i.appendNamespaceToCIMode || this.options.appendNamespaceToCIMode;
    if ((d == null ? void 0 : d.toLowerCase()) === "cimode")
      return f ? a ? {
        res: `${c}${g}${s}`,
        usedKey: s,
        exactUsedKey: s,
        usedLng: d,
        usedNS: c,
        usedParams: this.getUsedParamsDetails(i)
      } : `${c}${g}${s}` : a ? {
        res: s,
        usedKey: s,
        exactUsedKey: s,
        usedLng: d,
        usedNS: c,
        usedParams: this.getUsedParamsDetails(i)
      } : s;
    const p = this.resolve(e, i);
    let u = p == null ? void 0 : p.res;
    const m = (p == null ? void 0 : p.usedKey) || s, y = (p == null ? void 0 : p.exactUsedKey) || s, C = ["[object Number]", "[object Function]", "[object RegExp]"], v = i.joinArrays !== void 0 ? i.joinArrays : this.options.joinArrays, M = !this.i18nFormat || this.i18nFormat.handleAsObject, k = i.count !== void 0 && !Q(i.count), L = hn.hasDefaultValue(i), P = k ? this.pluralResolver.getSuffix(d, i.count, i) : "", A = i.ordinal && k ? this.pluralResolver.getSuffix(d, i.count, {
      ordinal: !1
    }) : "", _ = k && !i.ordinal && i.count === 0, S = _ && i[`defaultValue${this.options.pluralSeparator}zero`] || i[`defaultValue${P}`] || i[`defaultValue${A}`] || i.defaultValue;
    let w = u;
    M && !u && L && (w = S);
    const b = Nr(w), z = Object.prototype.toString.apply(w);
    if (M && w && b && C.indexOf(z) < 0 && !(Q(v) && Array.isArray(w))) {
      if (!i.returnObjects && !this.options.returnObjects) {
        this.options.returnedObjectHandler || this.logger.warn("accessing an object - but returnObjects options is not enabled!");
        const D = this.options.returnedObjectHandler ? this.options.returnedObjectHandler(m, w, {
          ...i,
          ns: l
        }) : `key '${s} (${this.language})' returned an object instead of string.`;
        return a ? (p.res = D, p.usedParams = this.getUsedParamsDetails(i), p) : D;
      }
      if (o) {
        const D = Array.isArray(w), q = D ? [] : {}, V = D ? y : m;
        for (const B in w)
          if (Object.prototype.hasOwnProperty.call(w, B)) {
            const H = `${V}${o}${B}`;
            L && !u ? q[B] = this.translate(H, {
              ...i,
              defaultValue: Nr(S) ? S[B] : void 0,
              joinArrays: !1,
              ns: l
            }) : q[B] = this.translate(H, {
              ...i,
              joinArrays: !1,
              ns: l
            }), q[B] === H && (q[B] = w[B]);
          }
        u = q;
      }
    } else if (M && Q(v) && Array.isArray(u))
      u = u.join(v), u && (u = this.extendTranslation(u, e, i, r));
    else {
      let D = !1, q = !1;
      !this.isValidLookup(u) && L && (D = !0, u = S), this.isValidLookup(u) || (q = !0, u = s);
      const B = (i.missingKeyNoValueFallbackToKey || this.options.missingKeyNoValueFallbackToKey) && q ? void 0 : u, H = L && S !== u && this.options.updateMissing;
      if (q || D || H) {
        if (this.logger.log(H ? "updateKey" : "missingKey", d, c, s, H ? S : u), o) {
          const U = this.resolve(s, {
            ...i,
            keySeparator: !1
          });
          U && U.res && this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.");
        }
        let Y = [];
        const X = this.languageUtils.getFallbackCodes(this.options.fallbackLng, i.lng || this.language);
        if (this.options.saveMissingTo === "fallback" && X && X[0])
          for (let U = 0; U < X.length; U++)
            Y.push(X[U]);
        else this.options.saveMissingTo === "all" ? Y = this.languageUtils.toResolveHierarchy(i.lng || this.language) : Y.push(i.lng || this.language);
        const K = (U, Z, x) => {
          var se;
          const R = L && x !== u ? x : B;
          this.options.missingKeyHandler ? this.options.missingKeyHandler(U, c, Z, R, H, i) : (se = this.backendConnector) != null && se.saveMissing && this.backendConnector.saveMissing(U, c, Z, R, H, i), this.emit("missingKey", U, c, Z, u);
        };
        this.options.saveMissing && (this.options.saveMissingPlurals && k ? Y.forEach((U) => {
          const Z = this.pluralResolver.getSuffixes(U, i);
          _ && i[`defaultValue${this.options.pluralSeparator}zero`] && Z.indexOf(`${this.options.pluralSeparator}zero`) < 0 && Z.push(`${this.options.pluralSeparator}zero`), Z.forEach((x) => {
            K([U], s + x, i[`defaultValue${x}`] || S);
          });
        }) : K(Y, s, S));
      }
      u = this.extendTranslation(u, e, i, p, r), q && u === s && this.options.appendNamespaceToMissingKey && (u = `${c}${g}${s}`), (q || D) && this.options.parseMissingKeyHandler && (u = this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey ? `${c}${g}${s}` : s, D ? u : void 0, i));
    }
    return a ? (p.res = u, p.usedParams = this.getUsedParamsDetails(i), p) : u;
  }
  extendTranslation(e, n, r, i, a) {
    var l, c;
    if ((l = this.i18nFormat) != null && l.parse)
      e = this.i18nFormat.parse(e, {
        ...this.options.interpolation.defaultVariables,
        ...r
      }, r.lng || this.language || i.usedLng, i.usedNS, i.usedKey, {
        resolved: i
      });
    else if (!r.skipInterpolation) {
      r.interpolation && this.interpolator.init({
        ...r,
        interpolation: {
          ...this.options.interpolation,
          ...r.interpolation
        }
      });
      const g = Q(e) && (((c = r == null ? void 0 : r.interpolation) == null ? void 0 : c.skipOnVariables) !== void 0 ? r.interpolation.skipOnVariables : this.options.interpolation.skipOnVariables);
      let d;
      if (g) {
        const p = e.match(this.interpolator.nestingRegexp);
        d = p && p.length;
      }
      let f = r.replace && !Q(r.replace) ? r.replace : r;
      if (this.options.interpolation.defaultVariables && (f = {
        ...this.options.interpolation.defaultVariables,
        ...f
      }), e = this.interpolator.interpolate(e, f, r.lng || this.language || i.usedLng, r), g) {
        const p = e.match(this.interpolator.nestingRegexp), u = p && p.length;
        d < u && (r.nest = !1);
      }
      !r.lng && i && i.res && (r.lng = this.language || i.usedLng), r.nest !== !1 && (e = this.interpolator.nest(e, (...p) => (a == null ? void 0 : a[0]) === p[0] && !r.context ? (this.logger.warn(`It seems you are nesting recursively key: ${p[0]} in key: ${n[0]}`), null) : this.translate(...p, n), r)), r.interpolation && this.interpolator.reset();
    }
    const o = r.postProcess || this.options.postProcess, s = Q(o) ? [o] : o;
    return e != null && (s != null && s.length) && r.applyPostProcessor !== !1 && (e = Ni.handle(s, e, n, this.options && this.options.postProcessPassResolved ? {
      i18nResolved: {
        ...i,
        usedParams: this.getUsedParamsDetails(r)
      },
      ...r
    } : r, this)), e;
  }
  resolve(e, n = {}) {
    let r, i, a, o, s;
    return Q(e) && (e = [e]), e.forEach((l) => {
      if (this.isValidLookup(r)) return;
      const c = this.extractFromKey(l, n), g = c.key;
      i = g;
      let d = c.namespaces;
      this.options.fallbackNS && (d = d.concat(this.options.fallbackNS));
      const f = n.count !== void 0 && !Q(n.count), p = f && !n.ordinal && n.count === 0, u = n.context !== void 0 && (Q(n.context) || typeof n.context == "number") && n.context !== "", m = n.lngs ? n.lngs : this.languageUtils.toResolveHierarchy(n.lng || this.language, n.fallbackLng);
      d.forEach((y) => {
        var C, v;
        this.isValidLookup(r) || (s = y, !Ir[`${m[0]}-${y}`] && ((C = this.utils) != null && C.hasLoadedNamespace) && !((v = this.utils) != null && v.hasLoadedNamespace(s)) && (Ir[`${m[0]}-${y}`] = !0, this.logger.warn(`key "${i}" for languages "${m.join(", ")}" won't get resolved as namespace "${s}" was not yet loaded`, "This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")), m.forEach((M) => {
          var P;
          if (this.isValidLookup(r)) return;
          o = M;
          const k = [g];
          if ((P = this.i18nFormat) != null && P.addLookupKeys)
            this.i18nFormat.addLookupKeys(k, g, M, y, n);
          else {
            let A;
            f && (A = this.pluralResolver.getSuffix(M, n.count, n));
            const _ = `${this.options.pluralSeparator}zero`, S = `${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;
            if (f && (n.ordinal && A.indexOf(S) === 0 && k.push(g + A.replace(S, this.options.pluralSeparator)), k.push(g + A), p && k.push(g + _)), u) {
              const w = `${g}${this.options.contextSeparator || "_"}${n.context}`;
              k.push(w), f && (n.ordinal && A.indexOf(S) === 0 && k.push(w + A.replace(S, this.options.pluralSeparator)), k.push(w + A), p && k.push(w + _));
            }
          }
          let L;
          for (; L = k.pop(); )
            this.isValidLookup(r) || (a = L, r = this.getResource(M, y, L, n));
        }));
      });
    }), {
      res: r,
      usedKey: i,
      exactUsedKey: a,
      usedLng: o,
      usedNS: s
    };
  }
  isValidLookup(e) {
    return e !== void 0 && !(!this.options.returnNull && e === null) && !(!this.options.returnEmptyString && e === "");
  }
  getResource(e, n, r, i = {}) {
    var a;
    return (a = this.i18nFormat) != null && a.getResource ? this.i18nFormat.getResource(e, n, r, i) : this.resourceStore.getResource(e, n, r, i);
  }
  getUsedParamsDetails(e = {}) {
    const n = ["defaultValue", "ordinal", "context", "replace", "lng", "lngs", "fallbackLng", "ns", "keySeparator", "nsSeparator", "returnObjects", "returnDetails", "joinArrays", "postProcess", "interpolation"], r = e.replace && !Q(e.replace);
    let i = r ? e.replace : e;
    if (r && typeof e.count < "u" && (i.count = e.count), this.options.interpolation.defaultVariables && (i = {
      ...this.options.interpolation.defaultVariables,
      ...i
    }), !r) {
      i = {
        ...i
      };
      for (const a of n)
        delete i[a];
    }
    return i;
  }
  static hasDefaultValue(e) {
    const n = "defaultValue";
    for (const r in e)
      if (Object.prototype.hasOwnProperty.call(e, r) && n === r.substring(0, n.length) && e[r] !== void 0)
        return !0;
    return !1;
  }
}
class Tr {
  constructor(e) {
    this.options = e, this.supportedLngs = this.options.supportedLngs || !1, this.logger = ot.create("languageUtils");
  }
  getScriptPartFromCode(e) {
    if (e = Bt(e), !e || e.indexOf("-") < 0) return null;
    const n = e.split("-");
    return n.length === 2 || (n.pop(), n[n.length - 1].toLowerCase() === "x") ? null : this.formatLanguageCode(n.join("-"));
  }
  getLanguagePartFromCode(e) {
    if (e = Bt(e), !e || e.indexOf("-") < 0) return e;
    const n = e.split("-");
    return this.formatLanguageCode(n[0]);
  }
  formatLanguageCode(e) {
    if (Q(e) && e.indexOf("-") > -1) {
      let n;
      try {
        n = Intl.getCanonicalLocales(e)[0];
      } catch {
      }
      return n && this.options.lowerCaseLng && (n = n.toLowerCase()), n || (this.options.lowerCaseLng ? e.toLowerCase() : e);
    }
    return this.options.cleanCode || this.options.lowerCaseLng ? e.toLowerCase() : e;
  }
  isSupportedCode(e) {
    return (this.options.load === "languageOnly" || this.options.nonExplicitSupportedLngs) && (e = this.getLanguagePartFromCode(e)), !this.supportedLngs || !this.supportedLngs.length || this.supportedLngs.indexOf(e) > -1;
  }
  getBestMatchFromCodes(e) {
    if (!e) return null;
    let n;
    return e.forEach((r) => {
      if (n) return;
      const i = this.formatLanguageCode(r);
      (!this.options.supportedLngs || this.isSupportedCode(i)) && (n = i);
    }), !n && this.options.supportedLngs && e.forEach((r) => {
      if (n) return;
      const i = this.getScriptPartFromCode(r);
      if (this.isSupportedCode(i)) return n = i;
      const a = this.getLanguagePartFromCode(r);
      if (this.isSupportedCode(a)) return n = a;
      n = this.options.supportedLngs.find((o) => {
        if (o === a) return o;
        if (!(o.indexOf("-") < 0 && a.indexOf("-") < 0) && (o.indexOf("-") > 0 && a.indexOf("-") < 0 && o.substring(0, o.indexOf("-")) === a || o.indexOf(a) === 0 && a.length > 1))
          return o;
      });
    }), n || (n = this.getFallbackCodes(this.options.fallbackLng)[0]), n;
  }
  getFallbackCodes(e, n) {
    if (!e) return [];
    if (typeof e == "function" && (e = e(n)), Q(e) && (e = [e]), Array.isArray(e)) return e;
    if (!n) return e.default || [];
    let r = e[n];
    return r || (r = e[this.getScriptPartFromCode(n)]), r || (r = e[this.formatLanguageCode(n)]), r || (r = e[this.getLanguagePartFromCode(n)]), r || (r = e.default), r || [];
  }
  toResolveHierarchy(e, n) {
    const r = this.getFallbackCodes((n === !1 ? [] : n) || this.options.fallbackLng || [], e), i = [], a = (o) => {
      o && (this.isSupportedCode(o) ? i.push(o) : this.logger.warn(`rejecting language code not found in supportedLngs: ${o}`));
    };
    return Q(e) && (e.indexOf("-") > -1 || e.indexOf("_") > -1) ? (this.options.load !== "languageOnly" && a(this.formatLanguageCode(e)), this.options.load !== "languageOnly" && this.options.load !== "currentOnly" && a(this.getScriptPartFromCode(e)), this.options.load !== "currentOnly" && a(this.getLanguagePartFromCode(e))) : Q(e) && a(this.formatLanguageCode(e)), r.forEach((o) => {
      i.indexOf(o) < 0 && a(this.formatLanguageCode(o));
    }), i;
  }
}
const Ar = {
  zero: 0,
  one: 1,
  two: 2,
  few: 3,
  many: 4,
  other: 5
}, Er = {
  select: (t) => t === 1 ? "one" : "other",
  resolvedOptions: () => ({
    pluralCategories: ["one", "other"]
  })
};
class rs {
  constructor(e, n = {}) {
    this.languageUtils = e, this.options = n, this.logger = ot.create("pluralResolver"), this.pluralRulesCache = {};
  }
  addRule(e, n) {
    this.rules[e] = n;
  }
  clearCache() {
    this.pluralRulesCache = {};
  }
  getRule(e, n = {}) {
    const r = Bt(e === "dev" ? "en" : e), i = n.ordinal ? "ordinal" : "cardinal", a = JSON.stringify({
      cleanedCode: r,
      type: i
    });
    if (a in this.pluralRulesCache)
      return this.pluralRulesCache[a];
    let o;
    try {
      o = new Intl.PluralRules(r, {
        type: i
      });
    } catch {
      if (!Intl)
        return this.logger.error("No Intl support, please use an Intl polyfill!"), Er;
      if (!e.match(/-|_/)) return Er;
      const l = this.languageUtils.getLanguagePartFromCode(e);
      o = this.getRule(l, n);
    }
    return this.pluralRulesCache[a] = o, o;
  }
  needsPlural(e, n = {}) {
    let r = this.getRule(e, n);
    return r || (r = this.getRule("dev", n)), (r == null ? void 0 : r.resolvedOptions().pluralCategories.length) > 1;
  }
  getPluralFormsOfKey(e, n, r = {}) {
    return this.getSuffixes(e, r).map((i) => `${n}${i}`);
  }
  getSuffixes(e, n = {}) {
    let r = this.getRule(e, n);
    return r || (r = this.getRule("dev", n)), r ? r.resolvedOptions().pluralCategories.sort((i, a) => Ar[i] - Ar[a]).map((i) => `${this.options.prepend}${n.ordinal ? `ordinal${this.options.prepend}` : ""}${i}`) : [];
  }
  getSuffix(e, n, r = {}) {
    const i = this.getRule(e, r);
    return i ? `${this.options.prepend}${r.ordinal ? `ordinal${this.options.prepend}` : ""}${i.select(n)}` : (this.logger.warn(`no plural rule found for: ${e}`), this.getSuffix("dev", n, r));
  }
}
const Dr = (t, e, n, r = ".", i = !0) => {
  let a = Go(t, e, n);
  return !a && i && Q(n) && (a = Bn(t, n, r), a === void 0 && (a = Bn(e, n, r))), a;
}, In = (t) => t.replace(/\$/g, "$$$$");
class is {
  constructor(e = {}) {
    var n;
    this.logger = ot.create("interpolator"), this.options = e, this.format = ((n = e == null ? void 0 : e.interpolation) == null ? void 0 : n.format) || ((r) => r), this.init(e);
  }
  init(e = {}) {
    e.interpolation || (e.interpolation = {
      escapeValue: !0
    });
    const {
      escape: n,
      escapeValue: r,
      useRawValueToEscape: i,
      prefix: a,
      prefixEscaped: o,
      suffix: s,
      suffixEscaped: l,
      formatSeparator: c,
      unescapeSuffix: g,
      unescapePrefix: d,
      nestingPrefix: f,
      nestingPrefixEscaped: p,
      nestingSuffix: u,
      nestingSuffixEscaped: m,
      nestingOptionsSeparator: y,
      maxReplaces: C,
      alwaysFormat: v
    } = e.interpolation;
    this.escape = n !== void 0 ? n : Yo, this.escapeValue = r !== void 0 ? r : !0, this.useRawValueToEscape = i !== void 0 ? i : !1, this.prefix = a ? Mt(a) : o || "{{", this.suffix = s ? Mt(s) : l || "}}", this.formatSeparator = c || ",", this.unescapePrefix = g ? "" : d || "-", this.unescapeSuffix = this.unescapePrefix ? "" : g || "", this.nestingPrefix = f ? Mt(f) : p || Mt("$t("), this.nestingSuffix = u ? Mt(u) : m || Mt(")"), this.nestingOptionsSeparator = y || ",", this.maxReplaces = C || 1e3, this.alwaysFormat = v !== void 0 ? v : !1, this.resetRegExp();
  }
  reset() {
    this.options && this.init(this.options);
  }
  resetRegExp() {
    const e = (n, r) => (n == null ? void 0 : n.source) === r ? (n.lastIndex = 0, n) : new RegExp(r, "g");
    this.regexp = e(this.regexp, `${this.prefix}(.+?)${this.suffix}`), this.regexpUnescape = e(this.regexpUnescape, `${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`), this.nestingRegexp = e(this.nestingRegexp, `${this.nestingPrefix}((?:[^()"']+|"[^"]*"|'[^']*'|\\((?:[^()]|"[^"]*"|'[^']*')*\\))*?)${this.nestingSuffix}`);
  }
  interpolate(e, n, r, i) {
    var p;
    let a, o, s;
    const l = this.options && this.options.interpolation && this.options.interpolation.defaultVariables || {}, c = (u) => {
      if (u.indexOf(this.formatSeparator) < 0) {
        const v = Dr(n, l, u, this.options.keySeparator, this.options.ignoreJSONStructure);
        return this.alwaysFormat ? this.format(v, void 0, r, {
          ...i,
          ...n,
          interpolationkey: u
        }) : v;
      }
      const m = u.split(this.formatSeparator), y = m.shift().trim(), C = m.join(this.formatSeparator).trim();
      return this.format(Dr(n, l, y, this.options.keySeparator, this.options.ignoreJSONStructure), C, r, {
        ...i,
        ...n,
        interpolationkey: y
      });
    };
    this.resetRegExp();
    const g = (i == null ? void 0 : i.missingInterpolationHandler) || this.options.missingInterpolationHandler, d = ((p = i == null ? void 0 : i.interpolation) == null ? void 0 : p.skipOnVariables) !== void 0 ? i.interpolation.skipOnVariables : this.options.interpolation.skipOnVariables;
    return [{
      regex: this.regexpUnescape,
      safeValue: (u) => In(u)
    }, {
      regex: this.regexp,
      safeValue: (u) => this.escapeValue ? In(this.escape(u)) : In(u)
    }].forEach((u) => {
      for (s = 0; a = u.regex.exec(e); ) {
        const m = a[1].trim();
        if (o = c(m), o === void 0)
          if (typeof g == "function") {
            const C = g(e, a, i);
            o = Q(C) ? C : "";
          } else if (i && Object.prototype.hasOwnProperty.call(i, m))
            o = "";
          else if (d) {
            o = a[0];
            continue;
          } else
            this.logger.warn(`missed to pass in variable ${m} for interpolating ${e}`), o = "";
        else !Q(o) && !this.useRawValueToEscape && (o = Sr(o));
        const y = u.safeValue(o);
        if (e = e.replace(a[0], y), d ? (u.regex.lastIndex += o.length, u.regex.lastIndex -= a[0].length) : u.regex.lastIndex = 0, s++, s >= this.maxReplaces)
          break;
      }
    }), e;
  }
  nest(e, n, r = {}) {
    let i, a, o;
    const s = (l, c) => {
      const g = this.nestingOptionsSeparator;
      if (l.indexOf(g) < 0) return l;
      const d = l.split(new RegExp(`${g}[ ]*{`));
      let f = `{${d[1]}`;
      l = d[0], f = this.interpolate(f, o);
      const p = f.match(/'/g), u = f.match(/"/g);
      (((p == null ? void 0 : p.length) ?? 0) % 2 === 0 && !u || u.length % 2 !== 0) && (f = f.replace(/'/g, '"'));
      try {
        o = JSON.parse(f), c && (o = {
          ...c,
          ...o
        });
      } catch (m) {
        return this.logger.warn(`failed parsing options string in nesting for key ${l}`, m), `${l}${g}${f}`;
      }
      return o.defaultValue && o.defaultValue.indexOf(this.prefix) > -1 && delete o.defaultValue, l;
    };
    for (; i = this.nestingRegexp.exec(e); ) {
      let l = [];
      o = {
        ...r
      }, o = o.replace && !Q(o.replace) ? o.replace : o, o.applyPostProcessor = !1, delete o.defaultValue;
      const c = /{.*}/.test(i[1]) ? i[1].lastIndexOf("}") + 1 : i[1].indexOf(this.formatSeparator);
      if (c !== -1 && (l = i[1].slice(c).split(this.formatSeparator).map((g) => g.trim()).filter(Boolean), i[1] = i[1].slice(0, c)), a = n(s.call(this, i[1].trim(), o), o), a && i[0] === e && !Q(a)) return a;
      Q(a) || (a = Sr(a)), a || (this.logger.warn(`missed to resolve ${i[1]} for nesting ${e}`), a = ""), l.length && (a = l.reduce((g, d) => this.format(g, d, r.lng, {
        ...r,
        interpolationkey: i[1].trim()
      }), a.trim())), e = e.replace(i[0], a), this.regexp.lastIndex = 0;
    }
    return e;
  }
}
const as = (t) => {
  let e = t.toLowerCase().trim();
  const n = {};
  if (t.indexOf("(") > -1) {
    const r = t.split("(");
    e = r[0].toLowerCase().trim();
    const i = r[1].substring(0, r[1].length - 1);
    e === "currency" && i.indexOf(":") < 0 ? n.currency || (n.currency = i.trim()) : e === "relativetime" && i.indexOf(":") < 0 ? n.range || (n.range = i.trim()) : i.split(";").forEach((o) => {
      if (o) {
        const [s, ...l] = o.split(":"), c = l.join(":").trim().replace(/^'+|'+$/g, ""), g = s.trim();
        n[g] || (n[g] = c), c === "false" && (n[g] = !1), c === "true" && (n[g] = !0), isNaN(c) || (n[g] = parseInt(c, 10));
      }
    });
  }
  return {
    formatName: e,
    formatOptions: n
  };
}, Or = (t) => {
  const e = {};
  return (n, r, i) => {
    let a = i;
    i && i.interpolationkey && i.formatParams && i.formatParams[i.interpolationkey] && i[i.interpolationkey] && (a = {
      ...a,
      [i.interpolationkey]: void 0
    });
    const o = r + JSON.stringify(a);
    let s = e[o];
    return s || (s = t(Bt(r), i), e[o] = s), s(n);
  };
}, os = (t) => (e, n, r) => t(Bt(n), r)(e);
class ss {
  constructor(e = {}) {
    this.logger = ot.create("formatter"), this.options = e, this.init(e);
  }
  init(e, n = {
    interpolation: {}
  }) {
    this.formatSeparator = n.interpolation.formatSeparator || ",";
    const r = n.cacheInBuiltFormats ? Or : os;
    this.formats = {
      number: r((i, a) => {
        const o = new Intl.NumberFormat(i, {
          ...a
        });
        return (s) => o.format(s);
      }),
      currency: r((i, a) => {
        const o = new Intl.NumberFormat(i, {
          ...a,
          style: "currency"
        });
        return (s) => o.format(s);
      }),
      datetime: r((i, a) => {
        const o = new Intl.DateTimeFormat(i, {
          ...a
        });
        return (s) => o.format(s);
      }),
      relativetime: r((i, a) => {
        const o = new Intl.RelativeTimeFormat(i, {
          ...a
        });
        return (s) => o.format(s, a.range || "day");
      }),
      list: r((i, a) => {
        const o = new Intl.ListFormat(i, {
          ...a
        });
        return (s) => o.format(s);
      })
    };
  }
  add(e, n) {
    this.formats[e.toLowerCase().trim()] = n;
  }
  addCached(e, n) {
    this.formats[e.toLowerCase().trim()] = Or(n);
  }
  format(e, n, r, i = {}) {
    const a = n.split(this.formatSeparator);
    if (a.length > 1 && a[0].indexOf("(") > 1 && a[0].indexOf(")") < 0 && a.find((s) => s.indexOf(")") > -1)) {
      const s = a.findIndex((l) => l.indexOf(")") > -1);
      a[0] = [a[0], ...a.splice(1, s)].join(this.formatSeparator);
    }
    return a.reduce((s, l) => {
      var d;
      const {
        formatName: c,
        formatOptions: g
      } = as(l);
      if (this.formats[c]) {
        let f = s;
        try {
          const p = ((d = i == null ? void 0 : i.formatParams) == null ? void 0 : d[i.interpolationkey]) || {}, u = p.locale || p.lng || i.locale || i.lng || r;
          f = this.formats[c](s, u, {
            ...g,
            ...i,
            ...p
          });
        } catch (p) {
          this.logger.warn(p);
        }
        return f;
      } else
        this.logger.warn(`there was no format function for ${c}`);
      return s;
    }, e);
  }
}
const cs = (t, e) => {
  t.pending[e] !== void 0 && (delete t.pending[e], t.pendingCount--);
};
class ls extends Cn {
  constructor(e, n, r, i = {}) {
    var a, o;
    super(), this.backend = e, this.store = n, this.services = r, this.languageUtils = r.languageUtils, this.options = i, this.logger = ot.create("backendConnector"), this.waitingReads = [], this.maxParallelReads = i.maxParallelReads || 10, this.readingCalls = 0, this.maxRetries = i.maxRetries >= 0 ? i.maxRetries : 5, this.retryTimeout = i.retryTimeout >= 1 ? i.retryTimeout : 350, this.state = {}, this.queue = [], (o = (a = this.backend) == null ? void 0 : a.init) == null || o.call(a, r, i.backend, i);
  }
  queueLoad(e, n, r, i) {
    const a = {}, o = {}, s = {}, l = {};
    return e.forEach((c) => {
      let g = !0;
      n.forEach((d) => {
        const f = `${c}|${d}`;
        !r.reload && this.store.hasResourceBundle(c, d) ? this.state[f] = 2 : this.state[f] < 0 || (this.state[f] === 1 ? o[f] === void 0 && (o[f] = !0) : (this.state[f] = 1, g = !1, o[f] === void 0 && (o[f] = !0), a[f] === void 0 && (a[f] = !0), l[d] === void 0 && (l[d] = !0)));
      }), g || (s[c] = !0);
    }), (Object.keys(a).length || Object.keys(o).length) && this.queue.push({
      pending: o,
      pendingCount: Object.keys(o).length,
      loaded: {},
      errors: [],
      callback: i
    }), {
      toLoad: Object.keys(a),
      pending: Object.keys(o),
      toLoadLanguages: Object.keys(s),
      toLoadNamespaces: Object.keys(l)
    };
  }
  loaded(e, n, r) {
    const i = e.split("|"), a = i[0], o = i[1];
    n && this.emit("failedLoading", a, o, n), !n && r && this.store.addResourceBundle(a, o, r, void 0, void 0, {
      skipCopy: !0
    }), this.state[e] = n ? -1 : 2, n && r && (this.state[e] = 0);
    const s = {};
    this.queue.forEach((l) => {
      Wo(l.loaded, [a], o), cs(l, e), n && l.errors.push(n), l.pendingCount === 0 && !l.done && (Object.keys(l.loaded).forEach((c) => {
        s[c] || (s[c] = {});
        const g = l.loaded[c];
        g.length && g.forEach((d) => {
          s[c][d] === void 0 && (s[c][d] = !0);
        });
      }), l.done = !0, l.errors.length ? l.callback(l.errors) : l.callback());
    }), this.emit("loaded", s), this.queue = this.queue.filter((l) => !l.done);
  }
  read(e, n, r, i = 0, a = this.retryTimeout, o) {
    if (!e.length) return o(null, {});
    if (this.readingCalls >= this.maxParallelReads) {
      this.waitingReads.push({
        lng: e,
        ns: n,
        fcName: r,
        tried: i,
        wait: a,
        callback: o
      });
      return;
    }
    this.readingCalls++;
    const s = (c, g) => {
      if (this.readingCalls--, this.waitingReads.length > 0) {
        const d = this.waitingReads.shift();
        this.read(d.lng, d.ns, d.fcName, d.tried, d.wait, d.callback);
      }
      if (c && g && i < this.maxRetries) {
        setTimeout(() => {
          this.read.call(this, e, n, r, i + 1, a * 2, o);
        }, a);
        return;
      }
      o(c, g);
    }, l = this.backend[r].bind(this.backend);
    if (l.length === 2) {
      try {
        const c = l(e, n);
        c && typeof c.then == "function" ? c.then((g) => s(null, g)).catch(s) : s(null, c);
      } catch (c) {
        s(c);
      }
      return;
    }
    return l(e, n, s);
  }
  prepareLoading(e, n, r = {}, i) {
    if (!this.backend)
      return this.logger.warn("No backend was added via i18next.use. Will not load resources."), i && i();
    Q(e) && (e = this.languageUtils.toResolveHierarchy(e)), Q(n) && (n = [n]);
    const a = this.queueLoad(e, n, r, i);
    if (!a.toLoad.length)
      return a.pending.length || i(), null;
    a.toLoad.forEach((o) => {
      this.loadOne(o);
    });
  }
  load(e, n, r) {
    this.prepareLoading(e, n, {}, r);
  }
  reload(e, n, r) {
    this.prepareLoading(e, n, {
      reload: !0
    }, r);
  }
  loadOne(e, n = "") {
    const r = e.split("|"), i = r[0], a = r[1];
    this.read(i, a, "read", void 0, void 0, (o, s) => {
      o && this.logger.warn(`${n}loading namespace ${a} for language ${i} failed`, o), !o && s && this.logger.log(`${n}loaded namespace ${a} for language ${i}`, s), this.loaded(e, o, s);
    });
  }
  saveMissing(e, n, r, i, a, o = {}, s = () => {
  }) {
    var l, c, g, d, f;
    if ((c = (l = this.services) == null ? void 0 : l.utils) != null && c.hasLoadedNamespace && !((d = (g = this.services) == null ? void 0 : g.utils) != null && d.hasLoadedNamespace(n))) {
      this.logger.warn(`did not save key "${r}" as the namespace "${n}" was not yet loaded`, "This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");
      return;
    }
    if (!(r == null || r === "")) {
      if ((f = this.backend) != null && f.create) {
        const p = {
          ...o,
          isUpdate: a
        }, u = this.backend.create.bind(this.backend);
        if (u.length < 6)
          try {
            let m;
            u.length === 5 ? m = u(e, n, r, i, p) : m = u(e, n, r, i), m && typeof m.then == "function" ? m.then((y) => s(null, y)).catch(s) : s(null, m);
          } catch (m) {
            s(m);
          }
        else
          u(e, n, r, i, s, p);
      }
      !e || !e[0] || this.store.addResource(e[0], n, r, i);
    }
  }
}
const Pr = () => ({
  debug: !1,
  initAsync: !0,
  ns: ["translation"],
  defaultNS: ["translation"],
  fallbackLng: ["dev"],
  fallbackNS: !1,
  supportedLngs: !1,
  nonExplicitSupportedLngs: !1,
  load: "all",
  preload: !1,
  simplifyPluralSuffix: !0,
  keySeparator: ".",
  nsSeparator: ":",
  pluralSeparator: "_",
  contextSeparator: "_",
  partialBundledLanguages: !1,
  saveMissing: !1,
  updateMissing: !1,
  saveMissingTo: "fallback",
  saveMissingPlurals: !0,
  missingKeyHandler: !1,
  missingInterpolationHandler: !1,
  postProcess: !1,
  postProcessPassResolved: !1,
  returnNull: !1,
  returnEmptyString: !0,
  returnObjects: !1,
  joinArrays: !1,
  returnedObjectHandler: !1,
  parseMissingKeyHandler: !1,
  appendNamespaceToMissingKey: !1,
  appendNamespaceToCIMode: !1,
  overloadTranslationOptionHandler: (t) => {
    let e = {};
    if (typeof t[1] == "object" && (e = t[1]), Q(t[1]) && (e.defaultValue = t[1]), Q(t[2]) && (e.tDescription = t[2]), typeof t[2] == "object" || typeof t[3] == "object") {
      const n = t[3] || t[2];
      Object.keys(n).forEach((r) => {
        e[r] = n[r];
      });
    }
    return e;
  },
  interpolation: {
    escapeValue: !0,
    format: (t) => t,
    prefix: "{{",
    suffix: "}}",
    formatSeparator: ",",
    unescapePrefix: "-",
    nestingPrefix: "$t(",
    nestingSuffix: ")",
    nestingOptionsSeparator: ",",
    maxReplaces: 1e3,
    skipOnVariables: !0
  },
  cacheInBuiltFormats: !0
}), Rr = (t) => {
  var e, n;
  return Q(t.ns) && (t.ns = [t.ns]), Q(t.fallbackLng) && (t.fallbackLng = [t.fallbackLng]), Q(t.fallbackNS) && (t.fallbackNS = [t.fallbackNS]), ((n = (e = t.supportedLngs) == null ? void 0 : e.indexOf) == null ? void 0 : n.call(e, "cimode")) < 0 && (t.supportedLngs = t.supportedLngs.concat(["cimode"])), typeof t.initImmediate == "boolean" && (t.initAsync = t.initImmediate), t;
}, tn = () => {
}, ds = (t) => {
  Object.getOwnPropertyNames(Object.getPrototypeOf(t)).forEach((n) => {
    typeof t[n] == "function" && (t[n] = t[n].bind(t));
  });
};
class Ut extends Cn {
  constructor(e = {}, n) {
    if (super(), this.options = Rr(e), this.services = {}, this.logger = ot, this.modules = {
      external: []
    }, ds(this), n && !this.isInitialized && !e.isClone) {
      if (!this.options.initAsync)
        return this.init(e, n), this;
      setTimeout(() => {
        this.init(e, n);
      }, 0);
    }
  }
  init(e = {}, n) {
    this.isInitializing = !0, typeof e == "function" && (n = e, e = {}), e.defaultNS == null && e.ns && (Q(e.ns) ? e.defaultNS = e.ns : e.ns.indexOf("translation") < 0 && (e.defaultNS = e.ns[0]));
    const r = Pr();
    this.options = {
      ...r,
      ...this.options,
      ...Rr(e)
    }, this.options.interpolation = {
      ...r.interpolation,
      ...this.options.interpolation
    }, e.keySeparator !== void 0 && (this.options.userDefinedKeySeparator = e.keySeparator), e.nsSeparator !== void 0 && (this.options.userDefinedNsSeparator = e.nsSeparator);
    const i = (c) => c ? typeof c == "function" ? new c() : c : null;
    if (!this.options.isClone) {
      this.modules.logger ? ot.init(i(this.modules.logger), this.options) : ot.init(null, this.options);
      let c;
      this.modules.formatter ? c = this.modules.formatter : c = ss;
      const g = new Tr(this.options);
      this.store = new Lr(this.options.resources, this.options);
      const d = this.services;
      d.logger = ot, d.resourceStore = this.store, d.languageUtils = g, d.pluralResolver = new rs(g, {
        prepend: this.options.pluralSeparator,
        simplifyPluralSuffix: this.options.simplifyPluralSuffix
      }), this.options.interpolation.format && this.options.interpolation.format !== r.interpolation.format && this.logger.deprecate("init: you are still using the legacy format function, please use the new approach: https://www.i18next.com/translation-function/formatting"), c && (!this.options.interpolation.format || this.options.interpolation.format === r.interpolation.format) && (d.formatter = i(c), d.formatter.init && d.formatter.init(d, this.options), this.options.interpolation.format = d.formatter.format.bind(d.formatter)), d.interpolator = new is(this.options), d.utils = {
        hasLoadedNamespace: this.hasLoadedNamespace.bind(this)
      }, d.backendConnector = new ls(i(this.modules.backend), d.resourceStore, d, this.options), d.backendConnector.on("*", (p, ...u) => {
        this.emit(p, ...u);
      }), this.modules.languageDetector && (d.languageDetector = i(this.modules.languageDetector), d.languageDetector.init && d.languageDetector.init(d, this.options.detection, this.options)), this.modules.i18nFormat && (d.i18nFormat = i(this.modules.i18nFormat), d.i18nFormat.init && d.i18nFormat.init(this)), this.translator = new hn(this.services, this.options), this.translator.on("*", (p, ...u) => {
        this.emit(p, ...u);
      }), this.modules.external.forEach((p) => {
        p.init && p.init(this);
      });
    }
    if (this.format = this.options.interpolation.format, n || (n = tn), this.options.fallbackLng && !this.services.languageDetector && !this.options.lng) {
      const c = this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);
      c.length > 0 && c[0] !== "dev" && (this.options.lng = c[0]);
    }
    !this.services.languageDetector && !this.options.lng && this.logger.warn("init: no languageDetector is used and no lng is defined"), ["getResource", "hasResourceBundle", "getResourceBundle", "getDataByLanguage"].forEach((c) => {
      this[c] = (...g) => this.store[c](...g);
    }), ["addResource", "addResources", "addResourceBundle", "removeResourceBundle"].forEach((c) => {
      this[c] = (...g) => (this.store[c](...g), this);
    });
    const s = Pt(), l = () => {
      const c = (g, d) => {
        this.isInitializing = !1, this.isInitialized && !this.initializedStoreOnce && this.logger.warn("init: i18next is already initialized. You should call init just once!"), this.isInitialized = !0, this.options.isClone || this.logger.log("initialized", this.options), this.emit("initialized", this.options), s.resolve(d), n(g, d);
      };
      if (this.languages && !this.isInitialized) return c(null, this.t.bind(this));
      this.changeLanguage(this.options.lng, c);
    };
    return this.options.resources || !this.options.initAsync ? l() : setTimeout(l, 0), s;
  }
  loadResources(e, n = tn) {
    var a, o;
    let r = n;
    const i = Q(e) ? e : this.language;
    if (typeof e == "function" && (r = e), !this.options.resources || this.options.partialBundledLanguages) {
      if ((i == null ? void 0 : i.toLowerCase()) === "cimode" && (!this.options.preload || this.options.preload.length === 0)) return r();
      const s = [], l = (c) => {
        if (!c || c === "cimode") return;
        this.services.languageUtils.toResolveHierarchy(c).forEach((d) => {
          d !== "cimode" && s.indexOf(d) < 0 && s.push(d);
        });
      };
      i ? l(i) : this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach((g) => l(g)), (o = (a = this.options.preload) == null ? void 0 : a.forEach) == null || o.call(a, (c) => l(c)), this.services.backendConnector.load(s, this.options.ns, (c) => {
        !c && !this.resolvedLanguage && this.language && this.setResolvedLanguage(this.language), r(c);
      });
    } else
      r(null);
  }
  reloadResources(e, n, r) {
    const i = Pt();
    return typeof e == "function" && (r = e, e = void 0), typeof n == "function" && (r = n, n = void 0), e || (e = this.languages), n || (n = this.options.ns), r || (r = tn), this.services.backendConnector.reload(e, n, (a) => {
      i.resolve(), r(a);
    }), i;
  }
  use(e) {
    if (!e) throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");
    if (!e.type) throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");
    return e.type === "backend" && (this.modules.backend = e), (e.type === "logger" || e.log && e.warn && e.error) && (this.modules.logger = e), e.type === "languageDetector" && (this.modules.languageDetector = e), e.type === "i18nFormat" && (this.modules.i18nFormat = e), e.type === "postProcessor" && Ni.addPostProcessor(e), e.type === "formatter" && (this.modules.formatter = e), e.type === "3rdParty" && this.modules.external.push(e), this;
  }
  setResolvedLanguage(e) {
    if (!(!e || !this.languages) && !(["cimode", "dev"].indexOf(e) > -1)) {
      for (let n = 0; n < this.languages.length; n++) {
        const r = this.languages[n];
        if (!(["cimode", "dev"].indexOf(r) > -1) && this.store.hasLanguageSomeTranslations(r)) {
          this.resolvedLanguage = r;
          break;
        }
      }
      !this.resolvedLanguage && this.languages.indexOf(e) < 0 && this.store.hasLanguageSomeTranslations(e) && (this.resolvedLanguage = e, this.languages.unshift(e));
    }
  }
  changeLanguage(e, n) {
    this.isLanguageChangingTo = e;
    const r = Pt();
    this.emit("languageChanging", e);
    const i = (s) => {
      this.language = s, this.languages = this.services.languageUtils.toResolveHierarchy(s), this.resolvedLanguage = void 0, this.setResolvedLanguage(s);
    }, a = (s, l) => {
      l ? this.isLanguageChangingTo === e && (i(l), this.translator.changeLanguage(l), this.isLanguageChangingTo = void 0, this.emit("languageChanged", l), this.logger.log("languageChanged", l)) : this.isLanguageChangingTo = void 0, r.resolve((...c) => this.t(...c)), n && n(s, (...c) => this.t(...c));
    }, o = (s) => {
      var g, d;
      !e && !s && this.services.languageDetector && (s = []);
      const l = Q(s) ? s : s && s[0], c = this.store.hasLanguageSomeTranslations(l) ? l : this.services.languageUtils.getBestMatchFromCodes(Q(s) ? [s] : s);
      c && (this.language || i(c), this.translator.language || this.translator.changeLanguage(c), (d = (g = this.services.languageDetector) == null ? void 0 : g.cacheUserLanguage) == null || d.call(g, c)), this.loadResources(c, (f) => {
        a(f, c);
      });
    };
    return !e && this.services.languageDetector && !this.services.languageDetector.async ? o(this.services.languageDetector.detect()) : !e && this.services.languageDetector && this.services.languageDetector.async ? this.services.languageDetector.detect.length === 0 ? this.services.languageDetector.detect().then(o) : this.services.languageDetector.detect(o) : o(e), r;
  }
  getFixedT(e, n, r) {
    const i = (a, o, ...s) => {
      let l;
      typeof o != "object" ? l = this.options.overloadTranslationOptionHandler([a, o].concat(s)) : l = {
        ...o
      }, l.lng = l.lng || i.lng, l.lngs = l.lngs || i.lngs, l.ns = l.ns || i.ns, l.keyPrefix !== "" && (l.keyPrefix = l.keyPrefix || r || i.keyPrefix);
      const c = this.options.keySeparator || ".";
      let g;
      return l.keyPrefix && Array.isArray(a) ? g = a.map((d) => (typeof d == "function" && (d = Un(d, {
        ...this.options,
        ...o
      })), `${l.keyPrefix}${c}${d}`)) : (typeof a == "function" && (a = Un(a, {
        ...this.options,
        ...o
      })), g = l.keyPrefix ? `${l.keyPrefix}${c}${a}` : a), this.t(g, l);
    };
    return Q(e) ? i.lng = e : i.lngs = e, i.ns = n, i.keyPrefix = r, i;
  }
  t(...e) {
    var n;
    return (n = this.translator) == null ? void 0 : n.translate(...e);
  }
  exists(...e) {
    var n;
    return (n = this.translator) == null ? void 0 : n.exists(...e);
  }
  setDefaultNamespace(e) {
    this.options.defaultNS = e;
  }
  hasLoadedNamespace(e, n = {}) {
    if (!this.isInitialized)
      return this.logger.warn("hasLoadedNamespace: i18next was not initialized", this.languages), !1;
    if (!this.languages || !this.languages.length)
      return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty", this.languages), !1;
    const r = n.lng || this.resolvedLanguage || this.languages[0], i = this.options ? this.options.fallbackLng : !1, a = this.languages[this.languages.length - 1];
    if (r.toLowerCase() === "cimode") return !0;
    const o = (s, l) => {
      const c = this.services.backendConnector.state[`${s}|${l}`];
      return c === -1 || c === 0 || c === 2;
    };
    if (n.precheck) {
      const s = n.precheck(this, o);
      if (s !== void 0) return s;
    }
    return !!(this.hasResourceBundle(r, e) || !this.services.backendConnector.backend || this.options.resources && !this.options.partialBundledLanguages || o(r, e) && (!i || o(a, e)));
  }
  loadNamespaces(e, n) {
    const r = Pt();
    return this.options.ns ? (Q(e) && (e = [e]), e.forEach((i) => {
      this.options.ns.indexOf(i) < 0 && this.options.ns.push(i);
    }), this.loadResources((i) => {
      r.resolve(), n && n(i);
    }), r) : (n && n(), Promise.resolve());
  }
  loadLanguages(e, n) {
    const r = Pt();
    Q(e) && (e = [e]);
    const i = this.options.preload || [], a = e.filter((o) => i.indexOf(o) < 0 && this.services.languageUtils.isSupportedCode(o));
    return a.length ? (this.options.preload = i.concat(a), this.loadResources((o) => {
      r.resolve(), n && n(o);
    }), r) : (n && n(), Promise.resolve());
  }
  dir(e) {
    var i, a;
    if (e || (e = this.resolvedLanguage || (((i = this.languages) == null ? void 0 : i.length) > 0 ? this.languages[0] : this.language)), !e) return "rtl";
    try {
      const o = new Intl.Locale(e);
      if (o && o.getTextInfo) {
        const s = o.getTextInfo();
        if (s && s.direction) return s.direction;
      }
    } catch {
    }
    const n = ["ar", "shu", "sqr", "ssh", "xaa", "yhd", "yud", "aao", "abh", "abv", "acm", "acq", "acw", "acx", "acy", "adf", "ads", "aeb", "aec", "afb", "ajp", "apc", "apd", "arb", "arq", "ars", "ary", "arz", "auz", "avl", "ayh", "ayl", "ayn", "ayp", "bbz", "pga", "he", "iw", "ps", "pbt", "pbu", "pst", "prp", "prd", "ug", "ur", "ydd", "yds", "yih", "ji", "yi", "hbo", "men", "xmn", "fa", "jpr", "peo", "pes", "prs", "dv", "sam", "ckb"], r = ((a = this.services) == null ? void 0 : a.languageUtils) || new Tr(Pr());
    return e.toLowerCase().indexOf("-latn") > 1 ? "ltr" : n.indexOf(r.getLanguagePartFromCode(e)) > -1 || e.toLowerCase().indexOf("-arab") > 1 ? "rtl" : "ltr";
  }
  static createInstance(e = {}, n) {
    return new Ut(e, n);
  }
  cloneInstance(e = {}, n = tn) {
    const r = e.forkResourceStore;
    r && delete e.forkResourceStore;
    const i = {
      ...this.options,
      ...e,
      isClone: !0
    }, a = new Ut(i);
    if ((e.debug !== void 0 || e.prefix !== void 0) && (a.logger = a.logger.clone(e)), ["store", "services", "language"].forEach((s) => {
      a[s] = this[s];
    }), a.services = {
      ...this.services
    }, a.services.utils = {
      hasLoadedNamespace: a.hasLoadedNamespace.bind(a)
    }, r) {
      const s = Object.keys(this.store.data).reduce((l, c) => (l[c] = {
        ...this.store.data[c]
      }, l[c] = Object.keys(l[c]).reduce((g, d) => (g[d] = {
        ...l[c][d]
      }, g), l[c]), l), {});
      a.store = new Lr(s, i), a.services.resourceStore = a.store;
    }
    return a.translator = new hn(a.services, i), a.translator.on("*", (s, ...l) => {
      a.emit(s, ...l);
    }), a.init(i, n), a.translator.options = i, a.translator.backendConnector.services.utils = {
      hasLoadedNamespace: a.hasLoadedNamespace.bind(a)
    }, a;
  }
  toJSON() {
    return {
      options: this.options,
      store: this.store,
      language: this.language,
      languages: this.languages,
      resolvedLanguage: this.resolvedLanguage
    };
  }
}
const Be = Ut.createInstance();
Be.createInstance = Ut.createInstance;
Be.createInstance;
Be.dir;
Be.init;
Be.loadResources;
Be.reloadResources;
Be.use;
Be.changeLanguage;
Be.getFixedT;
Be.t;
Be.exists;
Be.setDefaultNamespace;
Be.hasLoadedNamespace;
Be.loadNamespaces;
Be.loadLanguages;
var bn, ne, Ai, wt, zr, Ei, Di, Oi, ir, Vn, Hn, Pi, Vt = {}, Ri = [], us = /acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i, Gt = Array.isArray;
function lt(t, e) {
  for (var n in e) t[n] = e[n];
  return t;
}
function ar(t) {
  t && t.parentNode && t.parentNode.removeChild(t);
}
function Ht(t, e, n) {
  var r, i, a, o = {};
  for (a in e) a == "key" ? r = e[a] : a == "ref" ? i = e[a] : o[a] = e[a];
  if (arguments.length > 2 && (o.children = arguments.length > 3 ? bn.call(arguments, 2) : n), typeof t == "function" && t.defaultProps != null) for (a in t.defaultProps) o[a] === void 0 && (o[a] = t.defaultProps[a]);
  return sn(t, o, r, i, null);
}
function sn(t, e, n, r, i) {
  var a = { type: t, props: e, key: n, ref: r, __k: null, __: null, __b: 0, __e: null, __c: null, constructor: void 0, __v: i ?? ++Ai, __i: -1, __u: 0 };
  return i == null && ne.vnode != null && ne.vnode(a), a;
}
function We(t) {
  return t.children;
}
function st(t, e) {
  this.props = t, this.context = e;
}
function It(t, e) {
  if (e == null) return t.__ ? It(t.__, t.__i + 1) : null;
  for (var n; e < t.__k.length; e++) if ((n = t.__k[e]) != null && n.__e != null) return n.__e;
  return typeof t.type == "function" ? It(t) : null;
}
function zi(t) {
  var e, n;
  if ((t = t.__) != null && t.__c != null) {
    for (t.__e = t.__c.base = null, e = 0; e < t.__k.length; e++) if ((n = t.__k[e]) != null && n.__e != null) {
      t.__e = t.__c.base = n.__e;
      break;
    }
    return zi(t);
  }
}
function Zn(t) {
  (!t.__d && (t.__d = !0) && wt.push(t) && !gn.__r++ || zr != ne.debounceRendering) && ((zr = ne.debounceRendering) || Ei)(gn);
}
function gn() {
  for (var t, e, n, r, i, a, o, s = 1; wt.length; ) wt.length > s && wt.sort(Di), t = wt.shift(), s = wt.length, t.__d && (n = void 0, i = (r = (e = t).__v).__e, a = [], o = [], e.__P && ((n = lt({}, r)).__v = r.__v + 1, ne.vnode && ne.vnode(n), or(e.__P, n, r, e.__n, e.__P.namespaceURI, 32 & r.__u ? [i] : null, a, i ?? It(r), !!(32 & r.__u), o), n.__v = r.__v, n.__.__k[n.__i] = n, $i(a, n, o), n.__e != i && zi(n)));
  gn.__r = 0;
}
function ji(t, e, n, r, i, a, o, s, l, c, g) {
  var d, f, p, u, m, y, C = r && r.__k || Ri, v = e.length;
  for (l = hs(n, e, C, l, v), d = 0; d < v; d++) (p = n.__k[d]) != null && (f = p.__i == -1 ? Vt : C[p.__i] || Vt, p.__i = d, y = or(t, p, f, i, a, o, s, l, c, g), u = p.__e, p.ref && f.ref != p.ref && (f.ref && sr(f.ref, null, p), g.push(p.ref, p.__c || u, p)), m == null && u != null && (m = u), 4 & p.__u || f.__k === p.__k ? l = Fi(p, l, t) : typeof p.type == "function" && y !== void 0 ? l = y : u && (l = u.nextSibling), p.__u &= -7);
  return n.__e = m, l;
}
function hs(t, e, n, r, i) {
  var a, o, s, l, c, g = n.length, d = g, f = 0;
  for (t.__k = new Array(i), a = 0; a < i; a++) (o = e[a]) != null && typeof o != "boolean" && typeof o != "function" ? (l = a + f, (o = t.__k[a] = typeof o == "string" || typeof o == "number" || typeof o == "bigint" || o.constructor == String ? sn(null, o, null, null, null) : Gt(o) ? sn(We, { children: o }, null, null, null) : o.constructor == null && o.__b > 0 ? sn(o.type, o.props, o.key, o.ref ? o.ref : null, o.__v) : o).__ = t, o.__b = t.__b + 1, s = null, (c = o.__i = gs(o, n, l, d)) != -1 && (d--, (s = n[c]) && (s.__u |= 2)), s == null || s.__v == null ? (c == -1 && (i > g ? f-- : i < g && f++), typeof o.type != "function" && (o.__u |= 4)) : c != l && (c == l - 1 ? f-- : c == l + 1 ? f++ : (c > l ? f-- : f++, o.__u |= 4))) : t.__k[a] = null;
  if (d) for (a = 0; a < g; a++) (s = n[a]) != null && !(2 & s.__u) && (s.__e == r && (r = It(s)), Ui(s, s));
  return r;
}
function Fi(t, e, n) {
  var r, i;
  if (typeof t.type == "function") {
    for (r = t.__k, i = 0; r && i < r.length; i++) r[i] && (r[i].__ = t, e = Fi(r[i], e, n));
    return e;
  }
  t.__e != e && (e && t.type && !n.contains(e) && (e = It(t)), n.insertBefore(t.__e, e || null), e = t.__e);
  do
    e = e && e.nextSibling;
  while (e != null && e.nodeType == 8);
  return e;
}
function fn(t, e) {
  return e = e || [], t == null || typeof t == "boolean" || (Gt(t) ? t.some(function(n) {
    fn(n, e);
  }) : e.push(t)), e;
}
function gs(t, e, n, r) {
  var i, a, o = t.key, s = t.type, l = e[n];
  if (l === null && t.key == null || l && o == l.key && s == l.type && !(2 & l.__u)) return n;
  if (r > (l != null && !(2 & l.__u) ? 1 : 0)) for (i = n - 1, a = n + 1; i >= 0 || a < e.length; ) {
    if (i >= 0) {
      if ((l = e[i]) && !(2 & l.__u) && o == l.key && s == l.type) return i;
      i--;
    }
    if (a < e.length) {
      if ((l = e[a]) && !(2 & l.__u) && o == l.key && s == l.type) return a;
      a++;
    }
  }
  return -1;
}
function jr(t, e, n) {
  e[0] == "-" ? t.setProperty(e, n ?? "") : t[e] = n == null ? "" : typeof n != "number" || us.test(e) ? n : n + "px";
}
function nn(t, e, n, r, i) {
  var a, o;
  e: if (e == "style") if (typeof n == "string") t.style.cssText = n;
  else {
    if (typeof r == "string" && (t.style.cssText = r = ""), r) for (e in r) n && e in n || jr(t.style, e, "");
    if (n) for (e in n) r && n[e] == r[e] || jr(t.style, e, n[e]);
  }
  else if (e[0] == "o" && e[1] == "n") a = e != (e = e.replace(Oi, "$1")), o = e.toLowerCase(), e = o in t || e == "onFocusOut" || e == "onFocusIn" ? o.slice(2) : e.slice(2), t.l || (t.l = {}), t.l[e + a] = n, n ? r ? n.u = r.u : (n.u = ir, t.addEventListener(e, a ? Hn : Vn, a)) : t.removeEventListener(e, a ? Hn : Vn, a);
  else {
    if (i == "http://www.w3.org/2000/svg") e = e.replace(/xlink(H|:h)/, "h").replace(/sName$/, "s");
    else if (e != "width" && e != "height" && e != "href" && e != "list" && e != "form" && e != "tabIndex" && e != "download" && e != "rowSpan" && e != "colSpan" && e != "role" && e != "popover" && e in t) try {
      t[e] = n ?? "";
      break e;
    } catch {
    }
    typeof n == "function" || (n == null || n === !1 && e[4] != "-" ? t.removeAttribute(e) : t.setAttribute(e, e == "popover" && n == 1 ? "" : n));
  }
}
function Fr(t) {
  return function(e) {
    if (this.l) {
      var n = this.l[e.type + t];
      if (e.t == null) e.t = ir++;
      else if (e.t < n.u) return;
      return n(ne.event ? ne.event(e) : e);
    }
  };
}
function or(t, e, n, r, i, a, o, s, l, c) {
  var g, d, f, p, u, m, y, C, v, M, k, L, P, A, _, S, w, b = e.type;
  if (e.constructor != null) return null;
  128 & n.__u && (l = !!(32 & n.__u), a = [s = e.__e = n.__e]), (g = ne.__b) && g(e);
  e: if (typeof b == "function") try {
    if (C = e.props, v = "prototype" in b && b.prototype.render, M = (g = b.contextType) && r[g.__c], k = g ? M ? M.props.value : g.__ : r, n.__c ? y = (d = e.__c = n.__c).__ = d.__E : (v ? e.__c = d = new b(C, k) : (e.__c = d = new st(C, k), d.constructor = b, d.render = ps), M && M.sub(d), d.props = C, d.state || (d.state = {}), d.context = k, d.__n = r, f = d.__d = !0, d.__h = [], d._sb = []), v && d.__s == null && (d.__s = d.state), v && b.getDerivedStateFromProps != null && (d.__s == d.state && (d.__s = lt({}, d.__s)), lt(d.__s, b.getDerivedStateFromProps(C, d.__s))), p = d.props, u = d.state, d.__v = e, f) v && b.getDerivedStateFromProps == null && d.componentWillMount != null && d.componentWillMount(), v && d.componentDidMount != null && d.__h.push(d.componentDidMount);
    else {
      if (v && b.getDerivedStateFromProps == null && C !== p && d.componentWillReceiveProps != null && d.componentWillReceiveProps(C, k), !d.__e && d.shouldComponentUpdate != null && d.shouldComponentUpdate(C, d.__s, k) === !1 || e.__v == n.__v) {
        for (e.__v != n.__v && (d.props = C, d.state = d.__s, d.__d = !1), e.__e = n.__e, e.__k = n.__k, e.__k.some(function(z) {
          z && (z.__ = e);
        }), L = 0; L < d._sb.length; L++) d.__h.push(d._sb[L]);
        d._sb = [], d.__h.length && o.push(d);
        break e;
      }
      d.componentWillUpdate != null && d.componentWillUpdate(C, d.__s, k), v && d.componentDidUpdate != null && d.__h.push(function() {
        d.componentDidUpdate(p, u, m);
      });
    }
    if (d.context = k, d.props = C, d.__P = t, d.__e = !1, P = ne.__r, A = 0, v) {
      for (d.state = d.__s, d.__d = !1, P && P(e), g = d.render(d.props, d.state, d.context), _ = 0; _ < d._sb.length; _++) d.__h.push(d._sb[_]);
      d._sb = [];
    } else do
      d.__d = !1, P && P(e), g = d.render(d.props, d.state, d.context), d.state = d.__s;
    while (d.__d && ++A < 25);
    d.state = d.__s, d.getChildContext != null && (r = lt(lt({}, r), d.getChildContext())), v && !f && d.getSnapshotBeforeUpdate != null && (m = d.getSnapshotBeforeUpdate(p, u)), S = g, g != null && g.type === We && g.key == null && (S = Bi(g.props.children)), s = ji(t, Gt(S) ? S : [S], e, n, r, i, a, o, s, l, c), d.base = e.__e, e.__u &= -161, d.__h.length && o.push(d), y && (d.__E = d.__ = null);
  } catch (z) {
    if (e.__v = null, l || a != null) if (z.then) {
      for (e.__u |= l ? 160 : 128; s && s.nodeType == 8 && s.nextSibling; ) s = s.nextSibling;
      a[a.indexOf(s)] = null, e.__e = s;
    } else for (w = a.length; w--; ) ar(a[w]);
    else e.__e = n.__e, e.__k = n.__k;
    ne.__e(z, e, n);
  }
  else a == null && e.__v == n.__v ? (e.__k = n.__k, e.__e = n.__e) : s = e.__e = fs(n.__e, e, n, r, i, a, o, l, c);
  return (g = ne.diffed) && g(e), 128 & e.__u ? void 0 : s;
}
function $i(t, e, n) {
  for (var r = 0; r < n.length; r++) sr(n[r], n[++r], n[++r]);
  ne.__c && ne.__c(e, t), t.some(function(i) {
    try {
      t = i.__h, i.__h = [], t.some(function(a) {
        a.call(i);
      });
    } catch (a) {
      ne.__e(a, i.__v);
    }
  });
}
function Bi(t) {
  return typeof t != "object" || t == null || t.__b && t.__b > 0 ? t : Gt(t) ? t.map(Bi) : lt({}, t);
}
function fs(t, e, n, r, i, a, o, s, l) {
  var c, g, d, f, p, u, m, y = n.props, C = e.props, v = e.type;
  if (v == "svg" ? i = "http://www.w3.org/2000/svg" : v == "math" ? i = "http://www.w3.org/1998/Math/MathML" : i || (i = "http://www.w3.org/1999/xhtml"), a != null) {
    for (c = 0; c < a.length; c++) if ((p = a[c]) && "setAttribute" in p == !!v && (v ? p.localName == v : p.nodeType == 3)) {
      t = p, a[c] = null;
      break;
    }
  }
  if (t == null) {
    if (v == null) return document.createTextNode(C);
    t = document.createElementNS(i, v, C.is && C), s && (ne.__m && ne.__m(e, a), s = !1), a = null;
  }
  if (v == null) y === C || s && t.data == C || (t.data = C);
  else {
    if (a = a && bn.call(t.childNodes), y = n.props || Vt, !s && a != null) for (y = {}, c = 0; c < t.attributes.length; c++) y[(p = t.attributes[c]).name] = p.value;
    for (c in y) if (p = y[c], c != "children") {
      if (c == "dangerouslySetInnerHTML") d = p;
      else if (!(c in C)) {
        if (c == "value" && "defaultValue" in C || c == "checked" && "defaultChecked" in C) continue;
        nn(t, c, null, p, i);
      }
    }
    for (c in C) p = C[c], c == "children" ? f = p : c == "dangerouslySetInnerHTML" ? g = p : c == "value" ? u = p : c == "checked" ? m = p : s && typeof p != "function" || y[c] === p || nn(t, c, p, y[c], i);
    if (g) s || d && (g.__html == d.__html || g.__html == t.innerHTML) || (t.innerHTML = g.__html), e.__k = [];
    else if (d && (t.innerHTML = ""), ji(e.type == "template" ? t.content : t, Gt(f) ? f : [f], e, n, r, v == "foreignObject" ? "http://www.w3.org/1999/xhtml" : i, a, o, a ? a[0] : n.__k && It(n, 0), s, l), a != null) for (c = a.length; c--; ) ar(a[c]);
    s || (c = "value", v == "progress" && u == null ? t.removeAttribute("value") : u != null && (u !== t[c] || v == "progress" && !u || v == "option" && u != y[c]) && nn(t, c, u, y[c], i), c = "checked", m != null && m != t[c] && nn(t, c, m, y[c], i));
  }
  return t;
}
function sr(t, e, n) {
  try {
    if (typeof t == "function") {
      var r = typeof t.__u == "function";
      r && t.__u(), r && e == null || (t.__u = t(e));
    } else t.current = e;
  } catch (i) {
    ne.__e(i, n);
  }
}
function Ui(t, e, n) {
  var r, i;
  if (ne.unmount && ne.unmount(t), (r = t.ref) && (r.current && r.current != t.__e || sr(r, null, e)), (r = t.__c) != null) {
    if (r.componentWillUnmount) try {
      r.componentWillUnmount();
    } catch (a) {
      ne.__e(a, e);
    }
    r.base = r.__P = null;
  }
  if (r = t.__k) for (i = 0; i < r.length; i++) r[i] && Ui(r[i], e, n || typeof t.type != "function");
  n || ar(t.__e), t.__c = t.__ = t.__e = void 0;
}
function ps(t, e, n) {
  return this.constructor(t, n);
}
function Ft(t, e, n) {
  var r, i, a, o;
  e == document && (e = document.documentElement), ne.__ && ne.__(t, e), i = (r = !1) ? null : e.__k, a = [], o = [], or(e, t = e.__k = Ht(We, null, [t]), i || Vt, Vt, e.namespaceURI, i ? null : e.firstChild ? bn.call(e.childNodes) : null, a, i ? i.__e : e.firstChild, r, o), $i(a, t, o);
}
function dt(t) {
  function e(n) {
    var r, i;
    return this.getChildContext || (r = /* @__PURE__ */ new Set(), (i = {})[e.__c] = this, this.getChildContext = function() {
      return i;
    }, this.componentWillUnmount = function() {
      r = null;
    }, this.shouldComponentUpdate = function(a) {
      this.props.value != a.value && r.forEach(function(o) {
        o.__e = !0, Zn(o);
      });
    }, this.sub = function(a) {
      r.add(a);
      var o = a.componentWillUnmount;
      a.componentWillUnmount = function() {
        r && r.delete(a), o && o.call(a);
      };
    }), n.children;
  }
  return e.__c = "__cC" + Pi++, e.__ = t, e.Provider = e.__l = (e.Consumer = function(n, r) {
    return n.children(r);
  }).contextType = e, e;
}
bn = Ri.slice, ne = { __e: function(t, e, n, r) {
  for (var i, a, o; e = e.__; ) if ((i = e.__c) && !i.__) try {
    if ((a = i.constructor) && a.getDerivedStateFromError != null && (i.setState(a.getDerivedStateFromError(t)), o = i.__d), i.componentDidCatch != null && (i.componentDidCatch(t, r || {}), o = i.__d), o) return i.__E = i;
  } catch (s) {
    t = s;
  }
  throw t;
} }, Ai = 0, st.prototype.setState = function(t, e) {
  var n;
  n = this.__s != null && this.__s != this.state ? this.__s : this.__s = lt({}, this.state), typeof t == "function" && (t = t(lt({}, n), this.props)), t && lt(n, t), t != null && this.__v && (e && this._sb.push(e), Zn(this));
}, st.prototype.forceUpdate = function(t) {
  this.__v && (this.__e = !0, t && this.__h.push(t), Zn(this));
}, st.prototype.render = We, wt = [], Ei = typeof Promise == "function" ? Promise.prototype.then.bind(Promise.resolve()) : setTimeout, Di = function(t, e) {
  return t.__v.__b - e.__v.__b;
}, gn.__r = 0, Oi = /(PointerCapture)$|Capture$/i, ir = 0, Vn = Fr(!1), Hn = Fr(!0), Pi = 0;
var ft, ve, Nn, $r, Zt = 0, Vi = [], Me = ne, Br = Me.__b, Ur = Me.__r, Vr = Me.diffed, Hr = Me.__c, Zr = Me.unmount, Kr = Me.__;
function Nt(t, e) {
  Me.__h && Me.__h(ve, t, Zt || e), Zt = 0;
  var n = ve.__H || (ve.__H = { __: [], __h: [] });
  return t >= n.__.length && n.__.push({}), n.__[t];
}
function E(t) {
  return Zt = 1, ms(Zi, t);
}
function ms(t, e, n) {
  var r = Nt(ft++, 2);
  if (r.t = t, !r.__c && (r.__ = [n ? n(e) : Zi(void 0, e), function(s) {
    var l = r.__N ? r.__N[0] : r.__[0], c = r.t(l, s);
    l !== c && (r.__N = [c, r.__[1]], r.__c.setState({}));
  }], r.__c = ve, !ve.__f)) {
    var i = function(s, l, c) {
      if (!r.__c.__H) return !0;
      var g = r.__c.__H.__.filter(function(f) {
        return !!f.__c;
      });
      if (g.every(function(f) {
        return !f.__N;
      })) return !a || a.call(this, s, l, c);
      var d = r.__c.props !== s;
      return g.forEach(function(f) {
        if (f.__N) {
          var p = f.__[0];
          f.__ = f.__N, f.__N = void 0, p !== f.__[0] && (d = !0);
        }
      }), a && a.call(this, s, l, c) || d;
    };
    ve.__f = !0;
    var a = ve.shouldComponentUpdate, o = ve.componentWillUpdate;
    ve.componentWillUpdate = function(s, l, c) {
      if (this.__e) {
        var g = a;
        a = void 0, i(s, l, c), a = g;
      }
      o && o.call(this, s, l, c);
    }, ve.shouldComponentUpdate = i;
  }
  return r.__N || r.__;
}
function I(t, e) {
  var n = Nt(ft++, 3);
  !Me.__s && cr(n.__H, e) && (n.__ = t, n.u = e, ve.__H.__h.push(n));
}
function Hi(t, e) {
  var n = Nt(ft++, 4);
  !Me.__s && cr(n.__H, e) && (n.__ = t, n.u = e, ve.__h.push(n));
}
function te(t) {
  return Zt = 5, Ve(function() {
    return { current: t };
  }, []);
}
function Ve(t, e) {
  var n = Nt(ft++, 7);
  return cr(n.__H, e) && (n.__ = t(), n.__H = e, n.__h = t), n.__;
}
function W(t, e) {
  return Zt = 8, Ve(function() {
    return t;
  }, e);
}
function _e(t) {
  var e = ve.context[t.__c], n = Nt(ft++, 9);
  return n.c = t, e ? (n.__ == null && (n.__ = !0, e.sub(ve)), e.props.value) : t.__;
}
function _s(t) {
  var e = Nt(ft++, 10), n = E();
  return e.__ = t, ve.componentDidCatch || (ve.componentDidCatch = function(r, i) {
    e.__ && e.__(r, i), n[1](r);
  }), [n[0], function() {
    n[1](void 0);
  }];
}
function vs() {
  for (var t; t = Vi.shift(); ) if (t.__P && t.__H) try {
    t.__H.__h.forEach(cn), t.__H.__h.forEach(Kn), t.__H.__h = [];
  } catch (e) {
    t.__H.__h = [], Me.__e(e, t.__v);
  }
}
Me.__b = function(t) {
  ve = null, Br && Br(t);
}, Me.__ = function(t, e) {
  t && e.__k && e.__k.__m && (t.__m = e.__k.__m), Kr && Kr(t, e);
}, Me.__r = function(t) {
  Ur && Ur(t), ft = 0;
  var e = (ve = t.__c).__H;
  e && (Nn === ve ? (e.__h = [], ve.__h = [], e.__.forEach(function(n) {
    n.__N && (n.__ = n.__N), n.u = n.__N = void 0;
  })) : (e.__h.forEach(cn), e.__h.forEach(Kn), e.__h = [], ft = 0)), Nn = ve;
}, Me.diffed = function(t) {
  Vr && Vr(t);
  var e = t.__c;
  e && e.__H && (e.__H.__h.length && (Vi.push(e) !== 1 && $r === Me.requestAnimationFrame || (($r = Me.requestAnimationFrame) || ws)(vs)), e.__H.__.forEach(function(n) {
    n.u && (n.__H = n.u), n.u = void 0;
  })), Nn = ve = null;
}, Me.__c = function(t, e) {
  e.some(function(n) {
    try {
      n.__h.forEach(cn), n.__h = n.__h.filter(function(r) {
        return !r.__ || Kn(r);
      });
    } catch (r) {
      e.some(function(i) {
        i.__h && (i.__h = []);
      }), e = [], Me.__e(r, n.__v);
    }
  }), Hr && Hr(t, e);
}, Me.unmount = function(t) {
  Zr && Zr(t);
  var e, n = t.__c;
  n && n.__H && (n.__H.__.forEach(function(r) {
    try {
      cn(r);
    } catch (i) {
      e = i;
    }
  }), n.__H = void 0, e && Me.__e(e, n.__v));
};
var Wr = typeof requestAnimationFrame == "function";
function ws(t) {
  var e, n = function() {
    clearTimeout(r), Wr && cancelAnimationFrame(e), setTimeout(t);
  }, r = setTimeout(n, 35);
  Wr && (e = requestAnimationFrame(n));
}
function cn(t) {
  var e = ve, n = t.__c;
  typeof n == "function" && (t.__c = void 0, n()), ve = e;
}
function Kn(t) {
  var e = ve;
  t.__c = t.__(), ve = e;
}
function cr(t, e) {
  return !t || t.length !== e.length || e.some(function(n, r) {
    return n !== t[r];
  });
}
function Zi(t, e) {
  return typeof e == "function" ? e(t) : e;
}
function Ki(t, e) {
  for (var n in e) t[n] = e[n];
  return t;
}
function Gr(t, e) {
  for (var n in t) if (n !== "__source" && !(n in e)) return !0;
  for (var r in e) if (r !== "__source" && t[r] !== e[r]) return !0;
  return !1;
}
function qr(t, e) {
  this.props = t, this.context = e;
}
(qr.prototype = new st()).isPureReactComponent = !0, qr.prototype.shouldComponentUpdate = function(t, e) {
  return Gr(this.props, t) || Gr(this.state, e);
};
var Yr = ne.__b;
ne.__b = function(t) {
  t.type && t.type.__f && t.ref && (t.props.ref = t.ref, t.ref = null), Yr && Yr(t);
};
var ys = typeof Symbol < "u" && Symbol.for && Symbol.for("react.forward_ref") || 3911;
function Cs(t) {
  function e(n) {
    var r = Ki({}, n);
    return delete r.ref, t(r, n.ref || null);
  }
  return e.$$typeof = ys, e.render = e, e.prototype.isReactComponent = e.__f = !0, e.displayName = "ForwardRef(" + (t.displayName || t.name) + ")", e;
}
var bs = ne.__e;
ne.__e = function(t, e, n, r) {
  if (t.then) {
    for (var i, a = e; a = a.__; ) if ((i = a.__c) && i.__c) return e.__e == null && (e.__e = n.__e, e.__k = n.__k), i.__c(t, e);
  }
  bs(t, e, n, r);
};
var Jr = ne.unmount;
function Wi(t, e, n) {
  return t && (t.__c && t.__c.__H && (t.__c.__H.__.forEach(function(r) {
    typeof r.__c == "function" && r.__c();
  }), t.__c.__H = null), (t = Ki({}, t)).__c != null && (t.__c.__P === n && (t.__c.__P = e), t.__c.__e = !0, t.__c = null), t.__k = t.__k && t.__k.map(function(r) {
    return Wi(r, e, n);
  })), t;
}
function Gi(t, e, n) {
  return t && n && (t.__v = null, t.__k = t.__k && t.__k.map(function(r) {
    return Gi(r, e, n);
  }), t.__c && t.__c.__P === e && (t.__e && n.appendChild(t.__e), t.__c.__e = !0, t.__c.__P = n)), t;
}
function ln() {
  this.__u = 0, this.o = null, this.__b = null;
}
function qi(t) {
  var e = t.__.__c;
  return e && e.__a && e.__a(t);
}
function rn() {
  this.i = null, this.l = null;
}
ne.unmount = function(t) {
  var e = t.__c;
  e && e.__R && e.__R(), e && 32 & t.__u && (t.type = null), Jr && Jr(t);
}, (ln.prototype = new st()).__c = function(t, e) {
  var n = e.__c, r = this;
  r.o == null && (r.o = []), r.o.push(n);
  var i = qi(r.__v), a = !1, o = function() {
    a || (a = !0, n.__R = null, i ? i(s) : s());
  };
  n.__R = o;
  var s = function() {
    if (!--r.__u) {
      if (r.state.__a) {
        var l = r.state.__a;
        r.__v.__k[0] = Gi(l, l.__c.__P, l.__c.__O);
      }
      var c;
      for (r.setState({ __a: r.__b = null }); c = r.o.pop(); ) c.forceUpdate();
    }
  };
  r.__u++ || 32 & e.__u || r.setState({ __a: r.__b = r.__v.__k[0] }), t.then(o, o);
}, ln.prototype.componentWillUnmount = function() {
  this.o = [];
}, ln.prototype.render = function(t, e) {
  if (this.__b) {
    if (this.__v.__k) {
      var n = document.createElement("div"), r = this.__v.__k[0].__c;
      this.__v.__k[0] = Wi(this.__b, n, r.__O = r.__P);
    }
    this.__b = null;
  }
  var i = e.__a && Ht(We, null, t.fallback);
  return i && (i.__u &= -33), [Ht(We, null, e.__a ? null : t.children), i];
};
var Qr = function(t, e, n) {
  if (++n[1] === n[0] && t.l.delete(e), t.props.revealOrder && (t.props.revealOrder[0] !== "t" || !t.l.size)) for (n = t.i; n; ) {
    for (; n.length > 3; ) n.pop()();
    if (n[1] < n[0]) break;
    t.i = n = n[2];
  }
};
function Ss(t) {
  return this.getChildContext = function() {
    return t.context;
  }, t.children;
}
function Ms(t) {
  var e = this, n = t.h;
  if (e.componentWillUnmount = function() {
    Ft(null, e.v), e.v = null, e.h = null;
  }, e.h && e.h !== n && e.componentWillUnmount(), !e.v) {
    for (var r = e.__v; r !== null && !r.__m && r.__ !== null; ) r = r.__;
    e.h = n, e.v = { nodeType: 1, parentNode: n, childNodes: [], __k: { __m: r.__m }, contains: function() {
      return !0;
    }, insertBefore: function(i, a) {
      this.childNodes.push(i), e.h.insertBefore(i, a);
    }, removeChild: function(i) {
      this.childNodes.splice(this.childNodes.indexOf(i) >>> 1, 1), e.h.removeChild(i);
    } };
  }
  Ft(Ht(Ss, { context: e.context }, t.__v), e.v);
}
function Xr(t, e) {
  var n = Ht(Ms, { __v: t, h: e });
  return n.containerInfo = e, n;
}
(rn.prototype = new st()).__a = function(t) {
  var e = this, n = qi(e.__v), r = e.l.get(t);
  return r[0]++, function(i) {
    var a = function() {
      e.props.revealOrder ? (r.push(i), Qr(e, t, r)) : i();
    };
    n ? n(a) : a();
  };
}, rn.prototype.render = function(t) {
  this.i = null, this.l = /* @__PURE__ */ new Map();
  var e = fn(t.children);
  t.revealOrder && t.revealOrder[0] === "b" && e.reverse();
  for (var n = e.length; n--; ) this.l.set(e[n], this.i = [1, 0, this.i]);
  return t.children;
}, rn.prototype.componentDidUpdate = rn.prototype.componentDidMount = function() {
  var t = this;
  this.l.forEach(function(e, n) {
    Qr(t, n, e);
  });
};
var ks = typeof Symbol < "u" && Symbol.for && Symbol.for("react.element") || 60103, xs = /^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/, Ls = /^on(Ani|Tra|Tou|BeforeInp|Compo)/, Is = /[A-Z0-9]/g, Ns = typeof document < "u", Ts = function(t) {
  return (typeof Symbol < "u" && typeof Symbol() == "symbol" ? /fil|che|rad/ : /fil|che|ra/).test(t);
};
st.prototype.isReactComponent = {}, ["componentWillMount", "componentWillReceiveProps", "componentWillUpdate"].forEach(function(t) {
  Object.defineProperty(st.prototype, t, { configurable: !0, get: function() {
    return this["UNSAFE_" + t];
  }, set: function(e) {
    Object.defineProperty(this, t, { configurable: !0, writable: !0, value: e });
  } });
});
var ei = ne.event;
function As() {
}
function Es() {
  return this.cancelBubble;
}
function Ds() {
  return this.defaultPrevented;
}
ne.event = function(t) {
  return ei && (t = ei(t)), t.persist = As, t.isPropagationStopped = Es, t.isDefaultPrevented = Ds, t.nativeEvent = t;
};
var Os = { enumerable: !1, configurable: !0, get: function() {
  return this.class;
} }, ti = ne.vnode;
ne.vnode = function(t) {
  typeof t.type == "string" && function(e) {
    var n = e.props, r = e.type, i = {}, a = r.indexOf("-") === -1;
    for (var o in n) {
      var s = n[o];
      if (!(o === "value" && "defaultValue" in n && s == null || Ns && o === "children" && r === "noscript" || o === "class" || o === "className")) {
        var l = o.toLowerCase();
        o === "defaultValue" && "value" in n && n.value == null ? o = "value" : o === "download" && s === !0 ? s = "" : l === "translate" && s === "no" ? s = !1 : l[0] === "o" && l[1] === "n" ? l === "ondoubleclick" ? o = "ondblclick" : l !== "onchange" || r !== "input" && r !== "textarea" || Ts(n.type) ? l === "onfocus" ? o = "onfocusin" : l === "onblur" ? o = "onfocusout" : Ls.test(o) && (o = l) : l = o = "oninput" : a && xs.test(o) ? o = o.replace(Is, "-$&").toLowerCase() : s === null && (s = void 0), l === "oninput" && i[o = l] && (o = "oninputCapture"), i[o] = s;
      }
    }
    r == "select" && i.multiple && Array.isArray(i.value) && (i.value = fn(n.children).forEach(function(c) {
      c.props.selected = i.value.indexOf(c.props.value) != -1;
    })), r == "select" && i.defaultValue != null && (i.value = fn(n.children).forEach(function(c) {
      c.props.selected = i.multiple ? i.defaultValue.indexOf(c.props.value) != -1 : i.defaultValue == c.props.value;
    })), n.class && !n.className ? (i.class = n.class, Object.defineProperty(i, "className", Os)) : (n.className && !n.class || n.class && n.className) && (i.class = i.className = n.className), e.props = i;
  }(t), t.$$typeof = ks, ti && ti(t);
};
var ni = ne.__r;
ne.__r = function(t) {
  ni && ni(t), t.__c;
};
var ri = ne.diffed;
ne.diffed = function(t) {
  ri && ri(t);
  var e = t.props, n = t.__e;
  n != null && t.type === "textarea" && "value" in e && e.value !== n.value && (n.value = e.value == null ? "" : e.value);
};
var Tn = function(t, e) {
  return t(e);
};
const Ps = (t, e, n, r) => {
  var a, o, s, l;
  const i = [n, {
    code: e,
    ...r || {}
  }];
  if ((o = (a = t == null ? void 0 : t.services) == null ? void 0 : a.logger) != null && o.forward)
    return t.services.logger.forward(i, "warn", "react-i18next::", !0);
  yt(i[0]) && (i[0] = `react-i18next:: ${i[0]}`), (l = (s = t == null ? void 0 : t.services) == null ? void 0 : s.logger) != null && l.warn ? t.services.logger.warn(...i) : console != null && console.warn && console.warn(...i);
}, ii = {}, Wn = (t, e, n, r) => {
  yt(n) && ii[n] || (yt(n) && (ii[n] = /* @__PURE__ */ new Date()), Ps(t, e, n, r));
}, Yi = (t, e) => () => {
  if (t.isInitialized)
    e();
  else {
    const n = () => {
      setTimeout(() => {
        t.off("initialized", n);
      }, 0), e();
    };
    t.on("initialized", n);
  }
}, Gn = (t, e, n) => {
  t.loadNamespaces(e, Yi(t, n));
}, ai = (t, e, n, r) => {
  if (yt(n) && (n = [n]), t.options.preload && t.options.preload.indexOf(e) > -1) return Gn(t, n, r);
  n.forEach((i) => {
    t.options.ns.indexOf(i) < 0 && t.options.ns.push(i);
  }), t.loadLanguages(e, Yi(t, r));
}, Rs = (t, e, n = {}) => !e.languages || !e.languages.length ? (Wn(e, "NO_LANGUAGES", "i18n.languages were undefined or empty", {
  languages: e.languages
}), !0) : e.hasLoadedNamespace(t, {
  lng: n.lng,
  precheck: (r, i) => {
    if (n.bindI18n && n.bindI18n.indexOf("languageChanging") > -1 && r.services.backendConnector.backend && r.isLanguageChangingTo && !i(r.isLanguageChangingTo, t)) return !1;
  }
}), yt = (t) => typeof t == "string", zs = (t) => typeof t == "object" && t !== null, js = /&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g, Fs = {
  "&amp;": "&",
  "&#38;": "&",
  "&lt;": "<",
  "&#60;": "<",
  "&gt;": ">",
  "&#62;": ">",
  "&apos;": "'",
  "&#39;": "'",
  "&quot;": '"',
  "&#34;": '"',
  "&nbsp;": " ",
  "&#160;": " ",
  "&copy;": "",
  "&#169;": "",
  "&reg;": "",
  "&#174;": "",
  "&hellip;": "",
  "&#8230;": "",
  "&#x2F;": "/",
  "&#47;": "/"
}, $s = (t) => Fs[t], Bs = (t) => t.replace(js, $s);
let qn = {
  bindI18n: "languageChanged",
  bindI18nStore: "",
  transEmptyNodeValue: "",
  transSupportBasicHtmlNodes: !0,
  transWrapTextNodes: "",
  transKeepBasicHtmlNodesFor: ["br", "strong", "i", "p"],
  useSuspense: !0,
  unescape: Bs
};
const Us = (t = {}) => {
  qn = {
    ...qn,
    ...t
  };
}, Vs = () => qn;
let Ji;
const Hs = (t) => {
  Ji = t;
}, Zs = () => Ji, Ks = {
  type: "3rdParty",
  init(t) {
    Us(t.options.react), Hs(t);
  }
}, Ws = dt();
class Gs {
  constructor() {
    this.usedNamespaces = {};
  }
  addUsedNamespaces(e) {
    e.forEach((n) => {
      this.usedNamespaces[n] || (this.usedNamespaces[n] = !0);
    });
  }
  getUsedNamespaces() {
    return Object.keys(this.usedNamespaces);
  }
}
const qs = (t, e) => {
  const n = te();
  return I(() => {
    n.current = t;
  }, [t, e]), n.current;
}, Qi = (t, e, n, r) => t.getFixedT(e, n, r), Ys = (t, e, n, r) => W(Qi(t, e, n, r), [t, e, n, r]), ut = (t, e = {}) => {
  var k, L, P, A;
  const {
    i18n: n
  } = e, {
    i18n: r,
    defaultNS: i
  } = _e(Ws) || {}, a = n || r || Zs();
  if (a && !a.reportNamespaces && (a.reportNamespaces = new Gs()), !a) {
    Wn(a, "NO_I18NEXT_INSTANCE", "useTranslation: You will need to pass in an i18next instance by using initReactI18next");
    const _ = (w, b) => yt(b) ? b : zs(b) && yt(b.defaultValue) ? b.defaultValue : Array.isArray(w) ? w[w.length - 1] : w, S = [_, {}, !1];
    return S.t = _, S.i18n = {}, S.ready = !1, S;
  }
  (k = a.options.react) != null && k.wait && Wn(a, "DEPRECATED_OPTION", "useTranslation: It seems you are still using the old wait option, you may migrate to the new useSuspense behaviour.");
  const o = {
    ...Vs(),
    ...a.options.react,
    ...e
  }, {
    useSuspense: s,
    keyPrefix: l
  } = o;
  let c = i || ((L = a.options) == null ? void 0 : L.defaultNS);
  c = yt(c) ? [c] : c || ["translation"], (A = (P = a.reportNamespaces).addUsedNamespaces) == null || A.call(P, c);
  const g = (a.isInitialized || a.initializedStoreOnce) && c.every((_) => Rs(_, a, o)), d = Ys(a, e.lng || null, o.nsMode === "fallback" ? c : c[0], l), f = () => d, p = () => Qi(a, e.lng || null, o.nsMode === "fallback" ? c : c[0], l), [u, m] = E(f);
  let y = c.join();
  e.lng && (y = `${e.lng}${y}`);
  const C = qs(y), v = te(!0);
  I(() => {
    const {
      bindI18n: _,
      bindI18nStore: S
    } = o;
    v.current = !0, !g && !s && (e.lng ? ai(a, e.lng, c, () => {
      v.current && m(p);
    }) : Gn(a, c, () => {
      v.current && m(p);
    })), g && C && C !== y && v.current && m(p);
    const w = () => {
      v.current && m(p);
    };
    return _ && (a == null || a.on(_, w)), S && (a == null || a.store.on(S, w)), () => {
      v.current = !1, a && _ && (_ == null || _.split(" ").forEach((b) => a.off(b, w))), S && a && S.split(" ").forEach((b) => a.store.off(b, w));
    };
  }, [a, y]), I(() => {
    v.current && g && m(f);
  }, [a, l, g]);
  const M = [u, a, g];
  if (M.t = u, M.i18n = a, M.ready = g, g || !g && !s) return M;
  throw new Promise((_) => {
    e.lng ? ai(a, e.lng, c, () => _()) : Gn(a, c, () => _());
  });
}, Xi = {
  "en-US": [
    "en",
    "en-AU",
    "en-CA",
    "en-GB",
    "en-GH",
    "en-HK",
    "en-IE",
    "en-IN",
    "en-KE",
    "en-NG",
    "en-NZ",
    "en-PH",
    "en-SG",
    "en-TZ",
    "en-US",
    "en-ZA",
    "English",
    "English (AU)",
    "English (Australia)",
    "English (Canada)",
    "English (FI)",
    "English (FR)",
    "English (GB)",
    "English (Hong Kong SAR)",
    "English (IE)",
    "English (IN)",
    "English (IT)",
    "English (India)",
    "English (Ireland)",
    "English (Kenya)",
    "English (MX)",
    "English (NZ)",
    "English (New Zealand)",
    "English (Nigeria)",
    "English (Philippines)",
    "English (Singapore)",
    "English (South Africa)",
    "English (Tanzania)",
    "English (US)",
    "English (United Kingdom)",
    "English (United States)",
    "English (ZA)"
  ],
  "de-DE": [
    "de",
    "de-AT",
    "de-CH",
    "de-DE",
    "de-LI",
    "de-LU",
    "German",
    "German (Austria)",
    "German (Germany)",
    "German (Switzerland)"
  ]
}, An = (t) => {
  var n;
  return (n = Object.entries(Xi).find(
    ([r, i]) => i.includes(t ?? "")
  )) == null ? void 0 : n[0];
}, Js = {
  wait: "Gleich gehts weiter",
  starting: "Starten...",
  connecting: "Verbinden..."
}, Qs = {
  start: "Gesprch starten",
  continue: "Weiter gehts",
  resume: "Gesprch fortsetzen...",
  newConversation: "Beginne ein neues Gesprch",
  reconnect: "Erneut verbinden"
}, Xs = {
  resumeQ: "Mchtest du dort weitermachen, wo wir aufgehrt haben?",
  stillHere: "Noch da?"
}, ec = {
  msgPh: "Gib hier deine Nachricht ein..."
}, tc = {
  interrupt: "Sag etwas, um zu unterbrechen"
}, nc = {
  mic: "Mikrofon",
  spk: "Lautsprecher"
}, rc = {
  chat: "Chat",
  chatHistory: "Chat-Verlauf"
}, ic = {
  lowConnectivity: {
    endUser: "Ihre Netzwerkverbindung ist schwach. Dies kann Ihr Erlebnis beeintrchtigen.",
    ownerChat: "Ihre Netzwerkverbindung ist schwach. Dies kann Ihr Erlebnis beeintrchtigen."
  },
  noError: {
    endUser: "",
    ownerChat: ""
  },
  insufficientCredits: {
    endUser: "Sprach- und Gesichtsanimationen sind vorbergehend nicht verfgbar. Sie knnen den Chat weiterhin nutzen.",
    ownerChat: "Ihr Guthaben ist aufgebraucht. Sprach- und Gesichtsanimationen sind vorbergehend nicht verfgbar. Bitte kaufen Sie zustzliches Guthaben."
  },
  trialInsufficientCredits: {
    endUser: "Der Agent ist vorbergehend nicht verfgbar. Bitte versuchen Sie es spter erneut.",
    ownerChat: "Ihr Guthaben ist aufgebraucht. Sprach- und Gesichtsanimationen sind vorbergehend nicht verfgbar. Bitte kaufen Sie zustzliches Guthaben."
  },
  deletedVoice: {
    endUser: "Sprach- und Gesichtsanimationen sind vorbergehend nicht verfgbar. Sie knnen den Chat weiterhin nutzen.",
    ownerChat: "Die zuvor fr Ihren Agenten verwendete Sprachdatei wurde gelscht und ist nicht mehr verfgbar. Sprach- und Gesichtsanimationen sind vorbergehend nicht verfgbar. Bitte whlen Sie eine neue Stimme fr Ihren Agenten."
  },
  deletedAvatar: {
    endUser: "Sprach- und Gesichtsanimationen sind vorbergehend nicht verfgbar. Sie knnen den Chat weiterhin nutzen.",
    ownerChat: "Die zuvor verwendete Avatar-Datei wurde gelscht und ist nicht mehr verfgbar. Sprach- und Gesichtsanimationen sind vorbergehend nicht verfgbar. Bitte whlen Sie einen neuen Avatar fr diesen Agenten."
  },
  systemOverload: {
    endUser: "Dieser Agent hat die maximale Anzahl aktiver Sitzungen erreicht. Bitte versuchen Sie es in Krze erneut.",
    ownerChat: "Ihr Agent hat das Limit fr parallele Sitzungen erreicht. Bitte upgraden Sie Ihren Tarif oder reduzieren Sie die Nutzung, um zustzliche Sitzungen zu ermglichen."
  },
  fallbackError: {
    endUser: "Der Agent ist vorbergehend nicht verfgbar. Bitte versuchen Sie es spter erneut.",
    ownerChat: "Der Agent ist vorbergehend nicht verfgbar. Bitte versuchen Sie es spter erneut."
  },
  templateLimitReached: {
    endUser: "Chat-Limit erreicht. Bitte erstellen Sie einen Agenten, um das Gesprch fortzusetzen.",
    ownerChat: "Chat-Limit erreicht. Bitte erstellen Sie einen Agenten, um das Gesprch fortzusetzen."
  }
}, ac = {
  connectionStatus: Js,
  actions: Qs,
  prompts: Xs,
  inputs: ec,
  hints: tc,
  devices: nc,
  navigation: rc,
  errors: ic
}, oc = {
  wait: "Hang tight",
  starting: "Starting...",
  connecting: "Connecting..."
}, sc = {
  start: "Start conversation",
  continue: "Let's continue",
  resume: "Continue conversation...",
  newConversation: "Create new conversation",
  reconnect: "Reconnect"
}, cc = {
  resumeQ: "Want to continue where we left off?",
  stillHere: "Are you still here?"
}, lc = {
  msgPh: "Type your message here..."
}, dc = {
  interrupt: "Talk to interrupt"
}, uc = {
  mic: "Microphone",
  spk: "Speakers"
}, hc = {
  chat: "Chat",
  chatHistory: "Chat history"
}, gc = {
  lowConnectivity: {
    endUser: "Your network quality is low. This may affect your experience.",
    ownerChat: "Your network quality is low. This may affect your experience."
  },
  noError: {
    endUser: "",
    ownerChat: ""
  },
  insufficientCredits: {
    endUser: "Voice and face animations are temporarily unavailable. You can still use the chat.",
    ownerChat: "Your account has run out of credits. Voice and face animations are temporarily unavailable. Please purchase additional credits."
  },
  trialInsufficientCredits: {
    endUser: "The agent is temporarily unavailable. Please try again later.",
    ownerChat: "Your account has run out of credits. Voice and face animations are temporarily unavailable. Please purchase additional credits."
  },
  deletedVoice: {
    endUser: "Voice and face animations are temporarily unavailable. You can still use the chat.",
    ownerChat: "The voice file previously used for your agent has been deleted and is no longer available. Voice and face animations are temporarily unavailable. Please select a new voice for your agent."
  },
  deletedAvatar: {
    endUser: "Voice and face animations are temporarily unavailable. You can still use the chat.",
    ownerChat: "The avatar file previously used for your agent has been deleted and is no longer available. Voice and face animations are temporarily unavailable. Please select a new Avatar for this agent."
  },
  systemOverload: {
    endUser: "This agent has reached its maximum number of active sessions. Please try again shortly.",
    ownerChat: "Your agent has reached its concurrent session limit. Upgrade your plan or adjust usage to allow more sessions."
  },
  fallbackError: {
    endUser: "The agent is temporarily unavailable. Please try again later.",
    ownerChat: "The agent is temporarily unavailable. Please try again later."
  },
  templateLimitReached: {
    endUser: "Chat limit reached. Please create an Agent to continue the conversation.",
    ownerChat: "Chat limit reached. Please create an Agent to continue the conversation."
  }
}, fc = {
  connectionStatus: oc,
  actions: sc,
  prompts: cc,
  inputs: lc,
  hints: dc,
  devices: uc,
  navigation: hc,
  errors: gc
}, pc = xi === "local";
Be.use(Ks).init({
  lng: "en-US",
  fallbackLng: "en-US",
  supportedLngs: Object.keys(Xi),
  load: "currentOnly",
  resources: {
    "en-US": {
      translation: fc
    },
    "de-DE": {
      translation: ac
    }
  },
  debug: pc,
  interpolation: {
    escapeValue: !1
  }
});
var mc = 0;
function h(t, e, n, r, i, a) {
  e || (e = {});
  var o, s, l = e;
  if ("ref" in l) for (s in l = {}, e) s == "ref" ? o = e[s] : l[s] = e[s];
  var c = { type: t, props: l, key: n, ref: o, __k: null, __: null, __b: 0, __e: null, __c: null, constructor: void 0, __v: --mc, __i: -1, __u: 0, __source: i, __self: a };
  if (typeof t == "function" && (o = t.defaultProps)) for (s in o) l[s] === void 0 && (l[s] = o[s]);
  return ne.vnode && ne.vnode(c), c;
}
class _c extends st {
  componentDidCatch(e, n) {
    var r;
    (r = window.DD_RUM) == null || r.addError(e, n);
  }
  render() {
    return this.props.children;
  }
}
var Ct = /* @__PURE__ */ ((t) => (t.Audio = "audio", t.Text = "text", t.Click = "click", t))(Ct || {}), Pe = /* @__PURE__ */ ((t) => (t[t.New = 0] = "New", t[t.Streaming = 1] = "Streaming", t[t.Fail = 2] = "Fail", t))(Pe || {}), de = /* @__PURE__ */ ((t) => (t.Idle = "IDLE", t.Talking = "TALKING", t.Loading = "LOADING", t.Buffering = "BUFFERING", t))(de || {});
const ea = {
  mode: "fabio",
  visible: !0,
  agentId: "",
  track: !0,
  chatMode: T.Functional,
  loaderConfig: { show: !0, style: "opaque", text: "Loading..." },
  orientation: "vertical",
  position: "right",
  posterSrc: void 0,
  auth: null,
  showChatToggle: !0,
  showMicToggle: !0,
  enableInterruptOption: [Ct.Audio, Ct.Text, Ct.Click]
}, Re = dt({
  configure: () => {
  },
  configurations: ea
}), vc = ({ children: t, initialConfigurations: e }) => {
  const [n, r] = E({
    ...ea,
    ...e
  }), i = W(
    (a) => r((o) => ({ ...o, ...a })),
    [r]
  );
  return I(() => {
    window.DID_AGENTS_API.configure = i;
  }, [i]), I(() => {
    window.DID_AGENTS_API.showLoader = (a, o) => {
      const s = { ...n.loaderConfig, show: !0 };
      o && (s.style = o), a !== void 0 && (s.text = a), i({ loaderConfig: s });
    }, window.DID_AGENTS_API.hideLoader = () => {
      i({ loaderConfig: { ...n.loaderConfig, show: !1 } });
    };
  }, [i, n.loaderConfig]), /* @__PURE__ */ h(Re.Provider, { value: { configurations: n, configure: i }, children: t });
};
function ta() {
  return Math.random().toString(16).slice(2);
}
function wc() {
  const t = localStorage.getItem("tracking_id") ?? ta();
  return localStorage.setItem("tracking_id", t), t;
}
const na = {
  token: $n.mixpanelKey,
  $insert_id: ta(),
  origin: window.location.href,
  "Screen Height": window.screen.height || window.innerWidth,
  "Screen Width": window.screen.width || window.innerHeight,
  "User Agent": navigator.userAgent
};
function oi(t) {
  Object.assign(na, t);
}
const bt = () => {
  const { configurations: t } = _e(Re);
  return {
    trackUi: (n, r) => {
      if (window.localStorage.getItem("track_enabled") === "false")
        return;
      const i = {
        method: "POST",
        headers: {
          "Content-Type": "application/x-www-form-urlencoded"
        },
        keepalive: !0,
        body: new URLSearchParams({
          data: JSON.stringify([
            {
              event: n,
              properties: {
                ...r,
                time: Date.now(),
                distinct_id: t.externalId || wc(),
                id: t.externalId,
                ...t.mixpanelAdditionalProperties,
                ...na,
                agent_ui_version: Li
              }
            }
          ])
        })
      };
      fetch("https://api-js.mixpanel.com/track/?verbose=1&ip=1", i).catch(
        (a) => console.error("Analytics tracking error:", a)
      );
    }
  };
};
function si(t, e) {
  let n;
  return function(...r) {
    n && clearTimeout(n), n = setTimeout(() => t(...r), e);
  };
}
const Kt = (t, e) => {
  var n, r;
  (r = (n = window.DID_AGENTS_API ?? (window.DID_AGENTS_API = {})).functions ?? (n.functions = {}))[t] ?? (r[t] = e);
};
function yc() {
  if (typeof window > "u" || typeof navigator > "u")
    return !1;
  const t = navigator.userAgent || navigator.vendor || window.opera;
  return /android|avantgo|blackberry|bada\/|bb10|blazer|compal|elaine|fennec|hiptop|iemobile|iphone|ipod|ipad|iris|kindle|lge |maemo|meego.+mobile|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm(os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series40|series60|symbian|treo|up\.browser|up\.link|vodafone|wap|windows ce|windows phone|xda|xiino/i.test(
    t
  );
}
var ue = /* @__PURE__ */ ((t) => (t[t.NoError = 0] = "NoError", t[t.InsufficientCredits = 1] = "InsufficientCredits", t[t.TrialInsufficientCredits = 2] = "TrialInsufficientCredits", t[t.DeletedVoice = 3] = "DeletedVoice", t[t.DeletedAvatar = 4] = "DeletedAvatar", t[t.SystemOverload = 5] = "SystemOverload", t[t.FallbackError = 6] = "FallbackError", t[t.LowConnectivity = 7] = "LowConnectivity", t[t.TemplateLimitReached = 8] = "TemplateLimitReached", t))(ue || {}), Yn = /* @__PURE__ */ ((t) => (t[t.EndUser = 0] = "EndUser", t[t.OwnerChat = 1] = "OwnerChat", t))(Yn || {});
const Cc = {
  7: {
    0: "errors.lowConnectivity.endUser",
    1: "errors.lowConnectivity.ownerChat"
  },
  0: {
    0: "errors.noError.endUser",
    1: "errors.noError.ownerChat"
  },
  1: {
    0: "errors.insufficientCredits.endUser",
    1: "errors.insufficientCredits.ownerChat"
  },
  2: {
    0: "errors.trialInsufficientCredits.endUser",
    1: "errors.trialInsufficientCredits.ownerChat"
  },
  3: {
    0: "errors.deletedVoice.endUser",
    1: "errors.deletedVoice.ownerChat"
  },
  4: {
    0: "errors.deletedAvatar.endUser",
    1: "errors.deletedAvatar.ownerChat"
  },
  5: {
    0: "errors.systemOverload.endUser",
    1: "errors.systemOverload.ownerChat"
  },
  6: {
    0: "errors.fallbackError.endUser",
    1: "errors.fallbackError.ownerChat"
  },
  8: {
    0: "errors.templateLimitReached.endUser",
    1: "errors.templateLimitReached.ownerChat"
  }
};
function bc() {
  const t = /* @__PURE__ */ new Map(), e = (i, a) => {
    const o = t.get(i);
    o && o.splice(o.indexOf(a) >>> 0, 1);
  };
  return { on: (i, a) => {
    const o = t.get(i);
    return o ? o.push(a) : t.set(i, [a]), () => e(i, a);
  }, off: e, emit: (i, a) => {
    var o;
    (o = t.get(i)) == null || o.slice().forEach((s) => {
      try {
        s(a);
      } catch (l) {
        console.error(`[DID Agent] Error in "${String(i)}" handler:`, l);
      }
    });
  } };
}
const xt = bc(), pn = (t) => (t == null ? void 0 : t.toLowerCase()) === "multilingual", mn = [
  {
    label: "Arabic",
    value: "ar-SA",
    equivalentValues: [
      "ar-AE",
      "ar-BH",
      "ar-DZ",
      "ar-EG",
      "ar-IL",
      "ar-IQ",
      "ar-JO",
      "ar-KW",
      "ar-LB",
      "ar-LY",
      "ar-MA",
      "ar-OM",
      "ar-PS",
      "ar-QA",
      "ar-SA",
      "ar-SY",
      "ar-TN",
      "ar-YE"
    ]
  },
  { label: "Bulgarian", value: "bg-BG", equivalentValues: ["bg-BG"] },
  {
    label: "Chinese",
    value: "zh-CN",
    equivalentValues: ["wuu-CN", "yue-CN", "zh-CN", "zh-CN-shandong", "zh-CN-sichuan", "zh-HK", "zh-TW"]
  },
  { label: "Croatian", value: "hr-HR", equivalentValues: ["hr-HR"] },
  { label: "Czech", value: "cs-CZ", equivalentValues: ["cs-CZ"] },
  { label: "Danish", value: "da-DK", equivalentValues: ["da-DK"] },
  { label: "Dutch", value: "nl-NL", equivalentValues: ["nl-NL", "nl-BE"] },
  {
    label: "English",
    value: "en-US",
    equivalentValues: [
      "en-AU",
      "en-CA",
      "en-GB",
      "en-GH",
      "en-HK",
      "en-IE",
      "en-IN",
      "en-KE",
      "en-NG",
      "en-NZ",
      "en-PH",
      "en-SG",
      "en-TZ",
      "en-US",
      "en-ZA"
    ]
  },
  { label: "Filipino", value: "fil-PH", equivalentValues: ["fil-PH"] },
  { label: "Finnish", value: "fi-FI", equivalentValues: ["fi-FI"] },
  {
    label: "French",
    value: "fr-FR",
    equivalentValues: ["fr-BE", "fr-CA", "fr-CH", "fr-FR"]
  },
  {
    label: "German",
    value: "de-DE",
    equivalentValues: ["de-AT", "de-CH", "de-DE"]
  },
  { label: "Greek", value: "el-GR", equivalentValues: ["el-GR"] },
  { label: "Hebrew", value: "he-IL", equivalentValues: ["he-IL"] },
  { label: "Hindi", value: "hi-IN", equivalentValues: ["hi-IN"] },
  { label: "Hungarian", value: "hu-HU", equivalentValues: ["hu-HU"] },
  { label: "Indonesian", value: "id-ID", equivalentValues: ["id-ID"] },
  { label: "Italian", value: "it-IT", equivalentValues: ["it-IT", "it-CH"] },
  { label: "Japanese", value: "ja-JP", equivalentValues: ["ja-JP"] },
  { label: "Korean", value: "ko-KR", equivalentValues: ["ko-KR"] },
  { label: "Malay", value: "ms-MY", equivalentValues: ["ms-MY"] },
  { label: "Malayalam", value: "ml-IN", equivalentValues: ["ml-IN"] },
  { label: "Norwegian", value: "no-NO", equivalentValues: ["no-NO"] },
  { label: "Polish", value: "pl-PL", equivalentValues: ["pl-PL"] },
  { label: "Portuguese", value: "pt-PT", equivalentValues: ["pt-PT", "pt-BR"] },
  { label: "Romanian", value: "ro-RO", equivalentValues: ["ro-RO"] },
  { label: "Russian", value: "ru-RU", equivalentValues: ["ru-RU"] },
  { label: "Slovak", value: "sk-SK", equivalentValues: ["sk-SK"] },
  {
    label: "Spanish",
    value: "es-ES",
    equivalentValues: [
      "es-AR",
      "es-BO",
      "es-CL",
      "es-CO",
      "es-CR",
      "es-CU",
      "es-DO",
      "es-EC",
      "es-ES",
      "es-GQ",
      "es-GT",
      "es-HN",
      "es-MX",
      "es-NI",
      "es-PA",
      "es-PE",
      "es-PR",
      "es-PY",
      "es-SV",
      "es-US",
      "es-UY",
      "es-VE"
    ]
  },
  { label: "Swedish", value: "sv-SE", equivalentValues: ["sv-SE"] },
  { label: "Tamil", value: "ta-IN", equivalentValues: ["ta-IN"] },
  { label: "Turkish", value: "tr-TR", equivalentValues: ["tr-TR"] },
  { label: "Ukrainian", value: "uk-UA", equivalentValues: ["uk-UA"] },
  { label: "Vietnamese", value: "vi-VN", equivalentValues: ["vi-VN"] },
  { label: "Catalan", value: "ca-ES", equivalentValues: ["ca-ES"] },
  { label: "Estonian", value: "et-EE", equivalentValues: ["et-EE"] },
  { label: "Amharic", value: "am-ET", equivalentValues: ["am-ET"] },
  { label: "Basque", value: "eu-ES", equivalentValues: ["eu-ES"] },
  { label: "Irish", value: "ga-IE", equivalentValues: ["ga-IE"] },
  { label: "Armenian", value: "hy-AM", equivalentValues: ["hy-AM"] },
  { label: "Icelandic", value: "is-IS", equivalentValues: ["is-IS"] },
  { label: "Georgian", value: "ka-GE", equivalentValues: ["ka-GE"] },
  { label: "Slovenian", value: "sl-SI", equivalentValues: ["sl-SI"] },
  { label: "Thai", value: "th-TH", equivalentValues: ["th-TH"] }
], Sc = ({
  connectionState: t,
  streamIsConnected: e,
  agentActivityState: n,
  setGreeted: r,
  greeted: i,
  greet: a,
  chatMode: o,
  agent: s
}) => {
  const l = te(!1);
  I(() => {
    t === F.Disconnected && o === T.Playground && !i && !l.current && s && (l.current = !0, a().catch(() => {
      r(!0), l.current = !1;
    }));
  }, [t, i, o, s]), I(() => {
    e && !i && !l.current && (l.current = !0, a().catch(() => {
      r(!0), l.current = !1;
    }));
  }, [e, i]), I(() => {
    !i && t === F.Connected && n === de.Talking && (r(!0), l.current = !1);
  }, [t, n, i]);
};
function Mc(t) {
  return {
    kind: "user",
    key: t.owner_id,
    anonymous: !1
  };
}
const Sn = dt({
  client: null,
  initializeWithContext: () => {
  }
});
Sn.displayName = "feature flags store";
const kc = ({ children: t, enableFeatureFlags: e = !0 }) => {
  const [n, r] = E(null), i = te(null), a = W(
    async (o) => {
      if (!(!e || n || i.current))
        try {
          const { initialize: s } = await import("./ldclient.es-DWuXufEz.js"), l = s(Ho, o, {
            bootstrap: "localStorage",
            evaluationReasons: !0,
            sendEvents: !1
          });
          i.current = l;
          try {
            await l.waitUntilReady();
          } catch (c) {
            console.warn("failed to wait for launch darkly ready:", c);
          }
          r(l);
        } catch (s) {
          console.warn("failed to initialize launch darkly:", s), i.current = null, r(null);
        }
    },
    [e, n]
  );
  return I(() => () => {
    i.current && (i.current.close(), i.current = null);
  }, []), /* @__PURE__ */ h(Sn.Provider, { value: { client: n, initializeWithContext: a }, children: t });
};
function xc() {
  return _e(Sn).client;
}
function Lc(t, e) {
  var n, r;
  return ((r = (n = xc()) == null ? void 0 : n.variation) == null ? void 0 : r.call(n, t, e)) ?? e;
}
function Ic() {
  return _e(Sn);
}
const Nc = (t) => {
  const e = "presenter_id" in t ? t.presenter_id : void 0;
  return t.type === "clip" && (e != null && e.startsWith("v2_")) ? "clip_v2" : t.type;
}, qt = dt({
  authenticate: () => {
  },
  auth: {},
  host: "",
  wsHost: "",
  isAuthenticated: !1
});
qt.displayName = "DidFetch";
function Tc({ children: t, auth: e, didApiUrl: n, didSocketApiUrl: r }) {
  const [i, a] = E(e), o = async (s) => {
    a((l) => JSON.stringify(s) === JSON.stringify(l) ? l : s);
  };
  return /* @__PURE__ */ h(
    qt.Provider,
    {
      value: { auth: i, host: n, wsHost: r, authenticate: o, isAuthenticated: !!i },
      children: t
    }
  );
}
function Ac(t, e) {
  var n;
  return t === "SessionError" && typeof (e == null ? void 0 : e.url) == "string" && e.url.includes("/streams") && ((n = e.options) == null ? void 0 : n.method) === "DELETE";
}
function Ec(t, e, n, r) {
  const { onError: i, updateErrorState: a, changeMode: o } = n;
  if (i == null || i(t, e), r !== T.Maintenance)
    try {
      const { kind: s, description: l } = JSON.parse(t.message);
      if (Ac(s, e))
        return;
      switch (s) {
        case "PermissionError": {
          a(ue.FallbackError), o(T.Maintenance);
          break;
        }
        case "ChatModeDowngraded": {
          a(ue.InsufficientCredits);
          break;
        }
        case "InsufficientCreditsError": {
          a(ue.TrialInsufficientCredits);
          break;
        }
        case "Forbidden": {
          a(ue.SystemOverload), o(T.Maintenance);
          break;
        }
        case "TooManyRequestsError": {
          a(ue.SystemOverload), o(T.Maintenance);
          break;
        }
        case "DriverNotValidError": {
          a(ue.DeletedAvatar), o(T.TextOnly);
          break;
        }
        default:
          s === "InternalServerError" && l === "Stream Error" ? a(ue.FallbackError) : l === "Agent presenter voice not found" ? a(ue.DeletedVoice) : l === "Agent presenter not found" || l.includes("may be corrupted or does not exist") ? a(ue.DeletedAvatar) : a(ue.FallbackError), o(T.TextOnly);
      }
    } catch {
      a(ue.FallbackError), o(T.Maintenance);
    }
}
const lr = dt({
  connectionState: F.New,
  streamState: Pe.New,
  connect: async () => {
  },
  reconnect: async () => {
  },
  disconnect: async () => {
  },
  restart: async () => {
  },
  setStreamState: () => {
  },
  streamedMessage: "",
  messages: [],
  error: "",
  setError: () => {
  },
  terminating: !1,
  language: "en",
  starterMessages: [],
  chatId: void 0,
  setLanguage: () => {
  },
  setTranslationLanguage: () => {
  },
  enabled: !1,
  errorState: ue.NoError,
  setErrorState: () => {
  },
  changeMode: () => {
  },
  getSTTToken: async () => {
  },
  sendChatMessage: async () => ({}),
  rate: async () => ({}),
  enrichSdkAnalytics: () => {
  },
  greeted: !1,
  agentActivityState: de.Idle,
  setAgentActivityState: () => {
  },
  streamType: void 0,
  interruptAvailable: !1,
  interrupt: () => {
  },
  interruptLoading: !1,
  triggersAvailable: !1,
  fluentStarted: !1,
  legacyStarted: !1,
  isRestarting: !1,
  supportsMicrophoneStream: !1
});
lr.displayName = "Streaming Manager";
const ze = () => _e(lr), an = "en-US";
function Dc(t, e) {
  return t !== T.TextOnly && e === T.TextOnly;
}
function Oc(t) {
  var n;
  const e = ((n = t.greetings) == null ? void 0 : n.filter((r) => r.length > 0)) ?? [];
  if (e.length)
    return e[Math.floor(Math.random() * e.length)];
}
function Pc({ agentId: t, children: e, enabled: n, onAgentReady: r, onError: i }) {
  var _t, en;
  const [a, o] = E(), { configurations: s, configure: l } = _e(Re), { trackUi: c } = bt(), { initializeWithContext: g } = Ic(), d = Ve(() => s.chatMode, []), f = te(), p = te({}), u = te(), [m, y] = E([]), [C, v] = E(F.New), [M, k] = E(Pe.New), [L, P] = E(de.Idle), [A, _] = E(void 0), [S, w] = E(!1), [b, z] = E(!1), [D, q] = E(), [V, B] = E(""), [H, Y] = E(""), [X, K] = E(void 0), [U, Z] = E(!1), [x, R] = E([]), [se, ge] = E(ue.NoError), { auth: ee, host: N, wsHost: $ } = _e(qt), J = te("idle"), [ae, oe] = E(!1), [ce, ye] = E(!1), [ke, Ne] = E(!1), [Ze, je] = E(() => {
    const O = navigator == null ? void 0 : navigator.language;
    if (!O) return an;
    if (!!mn.find(
      ({ equivalentValues: Ue }) => Ue.includes(O)
    )) return O;
    const re = An(O);
    return !!re && !!mn.find(({ equivalentValues: Ue }) => Ue.includes(re)) ? re : an;
  }), { i18n: qe } = ut(), gt = async () => {
    var O, j, re;
    if ((O = u.current) != null && O.greeting)
      await ((re = u.current) == null ? void 0 : re.speak((j = u.current) == null ? void 0 : j.greeting));
    else
      throw new Error("Greeting is not found");
  }, xe = W(
    (O) => {
      P(O), u.current && (u.current.agentActivityState = O), xt.emit("agentActivity", { state: O });
    },
    [P]
  ), pt = W(
    async (O) => {
      if (!u.current)
        throw new Error("Agent is not initialized");
      let j = O;
      if (typeof O == "string") {
        const re = O.trim();
        if (!re)
          throw new Error("Can't speak empty text");
        j = re;
      }
      xe(de.Loading);
      try {
        const re = await u.current.speak(j), we = [T.TextOnly, T.Playground].includes(u.current.chatMode);
        return xe(we ? de.Idle : de.Buffering), re;
      } catch (re) {
        throw xe(de.Idle), re;
      }
    },
    [xe]
  ), Xe = Ve(
    () => A === $e.Fluent && M === Pe.Streaming,
    [A, M]
  ), et = Ve(
    () => A === $e.Legacy && C === F.Connected,
    [A, C]
  ), At = Ve(() => Xe || et, [Xe, et]);
  Sc({
    connectionState: C,
    streamIsConnected: At,
    agentActivityState: L,
    setGreeted: ye,
    greeted: ce,
    greet: gt,
    chatMode: s.chatMode,
    agent: a
  });
  const G = s.chatMode === T.Playground, le = s.chatMode === T.TextOnly, me = G || le, fe = W(
    (O) => {
      var j;
      ((j = u.current) == null ? void 0 : j.errorState) !== ue.TemplateLimitReached && (u.current && (u.current.errorState = O), ge(O));
    },
    [ge]
  ), Ce = W(() => {
    Y(""), fe(ue.NoError), u.current && (u.current.errorState = ue.NoError);
  }, [Y, fe]), Se = W(async () => {
    u.current && (Z(!0), await u.current.disconnect().catch(), Z(!1));
  }, [u]), De = W(
    (O, j) => {
      if (xt.emit("error", { error: O }), !u.current) {
        i == null || i(O, j);
        return;
      }
      Ec(
        O,
        j,
        {
          onError: i,
          updateErrorState: (re) => {
            fe(re), u.current && (u.current.errorState = re);
          },
          changeMode: (re) => {
            var we;
            (we = u.current) != null && we.changeMode && u.current.changeMode(re);
          }
        },
        u.current.chatMode
      );
    },
    [i, fe, l]
  );
  I(() => {
    if (C === F.Connected && u.current) {
      const O = u.current.getStreamType(), j = u.current.getIsInterruptAvailable(), re = u.current.getIsTriggersAvailable();
      Tn(() => {
        _(O), w(j), z(re);
      });
    }
  }, [C, u.current]);
  function Le() {
    u.current && (u.current.disconnect().catch((O) => console.error(O)), Tn(() => {
      o(void 0), y([]), v(F.New), k(Pe.New), _(void 0), w(!1), z(!1), q(void 0), B(""), R([]), Y(""), fe(ue.NoError), Z(!1), xe(de.Idle), je(an), ye(!1);
    }));
  }
  function Ye() {
    return new Promise((O, j) => {
      var we, Ue;
      if (f.current && !me)
        return f.current;
      const re = d;
      Ce(), Le(), l({ chatMode: re }), Fo(t, {
        mode: re,
        auth: ee,
        baseURL: N,
        wsURL: $,
        streamOptions: { streamWarmup: !0, compatibilityMode: "on", fluent: !0 },
        callbacks: {
          onVideoStateChange(ie) {
            var vt;
            const be = ie === he.Start ? Pe.Streaming : Pe.New, Oe = ((vt = u.current) == null ? void 0 : vt.getStreamType()) === $e.Legacy;
            u.current && be !== u.current.streamState && (u.current.streamState = be, k(be), Oe && (be === Pe.New ? xe(de.Idle) : be === Pe.Streaming && xe(de.Talking)));
          },
          onAgentActivityStateChange: (ie) => {
            var be;
            ie === de.Idle && [
              de.Loading,
              de.Buffering
            ].includes(((be = u.current) == null ? void 0 : be.agentActivityState) ?? de.Idle) || xe(ie);
          },
          onConnectionStateChange: (ie) => {
            var Oe, vt;
            const be = (Oe = u.current) == null ? void 0 : Oe.connectionState;
            J.current === "disconnecting" && ie === F.Disconnected || !u.current || be === ie || (ie === F.Connected && ((vt = u == null ? void 0 : u.current) == null ? void 0 : vt.errorState) === ue.SystemOverload && Ce(), ie === F.Disconnected && xe(de.Idle), u.current.connectionState = ie, v(ie), xt.emit("connection", { state: ie }));
          },
          onNewMessage: R,
          onSrcObjectReady: q,
          onModeChange: (ie) => {
            u.current && (u.current.chatMode = ie), l({ chatMode: ie }), xt.emit("chatMode", { state: ie });
          },
          onNewChat: (ie) => {
            K(ie), oi({ chat_id: ie });
          },
          onConnectivityStateChange: (ie) => {
            var be, Oe;
            c("agent-connectivity", { event: "view", agentId: (Oe = (be = u.current) == null ? void 0 : be.agent) == null ? void 0 : Oe.id, state: ie }), ie === it.Weak ? fe(ue.LowConnectivity) : Ce();
          },
          onError: De,
          onStreamCreated: (Ue = (we = window == null ? void 0 : window.DID_AGENTS_API) == null ? void 0 : we.callbacks) == null ? void 0 : Ue.onStreamCreated
        },
        initialMessages: s.chatMode === T.Playground ? [] : x,
        persistentChat: !0,
        enableAnalitics: s.track,
        externalId: s.externalId,
        mixpanelKey: s.customMixpanelKey,
        mixpanelAdditionalProperties: {
          owner_id: a == null ? void 0 : a.owner_id,
          ...s == null ? void 0 : s.mixpanelAdditionalProperties
        }
      }).then((ie) => {
        var ur, hr, gr, fr, pr, mr;
        const be = ie == null ? void 0 : ie.agent, Oe = be == null ? void 0 : be.presenter, vt = Oc(be);
        oi({ agentId: be.id, agentType: Nc(Oe) });
        const Et = {
          ...ie,
          chatMode: re,
          errorState: ue.NoError,
          streamState: Pe.New,
          connectionState: F.New,
          agentActivityState: de.Idle,
          greeting: vt,
          chat: async function(Dt) {
            if (window.dataLayer.push({
              event: "agent_interaction",
              message: Dt
            }), !ie)
              throw new Error("Manager is not initialized");
            if (!me && !(Oe != null && Oe.voice))
              throw new Error(JSON.stringify({ description: "Agent presenter voice not found" }));
            return B(""), await ie.chat(Dt);
          }
        };
        Et.enrichAnalytics({
          ...p.current,
          version: Li,
          presenterId: Oe == null ? void 0 : Oe.id,
          presenterType: Oe.type
        }), p.current = {}, u.current = Et, u.current && !((hr = (ur = Et == null ? void 0 : Et.agent) == null ? void 0 : ur.presenter) != null && hr.idle_video) && re !== T.Playground && (u.current.chatMode = T.TextOnly, u.current.changeMode(T.TextOnly)), Kt("speak", pt), Kt("interrupt", () => {
          var Dt;
          (Dt = u.current) == null || Dt.interrupt({ type: "manual" });
        }), Tn(() => {
          u.current && (o(u.current.agent), y(u.current.starterMessages || []), r == null || r(u.current.agent));
        }), tt((mr = (pr = (fr = (gr = u.current) == null ? void 0 : gr.agent) == null ? void 0 : fr.presenter) == null ? void 0 : pr.voice) == null ? void 0 : mr.language), O();
      }).catch((ie) => {
        var be;
        console.error(ie), ie instanceof TypeError && k(Pe.Fail), (be = u.current) == null || be.changeMode(T.Maintenance), Y("Agent is unavailable at the moment"), j(ie);
      });
    });
  }
  const tt = W(
    (O) => {
      const j = pn(O) ? Ze : O, we = An(j) || an;
      we !== qe.language && qe.changeLanguage(we);
    },
    [qe, pn, Ze, An]
  );
  async function ct(O = !1, j = !1) {
    var re, we;
    if (!(!ee || !N || !$) && (f.current && (await f.current, f.current = void 0), u.current || (f.current = Ye(), await f.current, f.current = void 0), u.current)) {
      if (u.current.chatMode !== d && (O || j) && (u.current.chatMode = d, u.current.changeMode(d)), [T.Playground, T.TextOnly, T.Maintenance].includes(u.current.chatMode))
        return;
      if (O)
        return u.current.reconnect();
      if ([F.Connecting, F.Connected].includes(C)) {
        if (!j)
          return;
        Z(!0), await u.current.disconnect(), Z(!1), c("agent-new-chat", { event: "click", agentId: (we = (re = u.current) == null ? void 0 : re.agent) == null ? void 0 : we.id });
      }
      return u.current.connect();
    }
  }
  const mt = W(async () => {
    f.current && (await f.current, f.current = void 0), f.current = Ye(), await f.current, f.current = void 0, window.DID_AGENTS_API.updateAgent = () => {
      [T.TextOnly, T.Playground].includes(s.chatMode) && (f.current = Ye().then(() => {
        f.current = void 0;
      }).catch((O) => {
        console.error(O), f.current = void 0;
      }));
    };
  }, [ee, N, $]), Te = W(async () => {
    var O;
    if (!((O = u.current) != null && O.disconnect))
      throw new Error("Agent is not initialized");
    try {
      oe(!0), J.current = "disconnecting", await (u == null ? void 0 : u.current.disconnect()), u.current = void 0, J.current = "connecting", await ct(!1, !0), ye(!1), J.current = "idle", oe(!1);
    } catch (j) {
      throw J.current = "idle", oe(!1), j;
    }
  }, [u, Ze]);
  I(() => {
    n && [T.Functional, T.Maintenance].includes(s.chatMode) && u.current && u.current.connectionState === F.Fail && (Ce(), ct(!0));
  }, [n]), I(() => {
    !ee || !N || !$ || mt().catch((O) => console.error(O));
  }, [mt]), I(() => {
    function O() {
      Se();
    }
    return window.addEventListener("beforeunload", O), () => {
      Se(), window.removeEventListener("beforeunload", O);
    };
  }, []), I(() => {
    var O;
    (O = u.current) != null && O.chatMode && [T.TextOnly, T.Maintenance].includes(u.current.chatMode) && (a == null ? void 0 : a.access) === "public" && (fe(ue.TemplateLimitReached), u.current.errorState = ue.TemplateLimitReached);
  }, [(_t = u.current) == null ? void 0 : _t.chatMode, a]), I(() => {
    if (!(a != null && a.owner_id))
      return;
    const O = Mc(a);
    g(O);
  }, [a == null ? void 0 : a.owner_id, g]);
  const Ge = W(
    async (O) => {
      var j;
      if ((j = u.current) != null && j.chat) {
        const re = await u.current.chat(O);
        return Dc(u.current.chatMode, re.chatMode) && fe(ue.InsufficientCredits), re;
      } else
        throw new Error("Agent is not initialized");
    },
    [u]
  ), Fe = W(
    (O) => {
      var j;
      if ((j = u.current) != null && j.changeMode)
        u.current.changeMode(O);
      else
        throw new Error("Agent is not initialized");
    },
    [u]
  ), Ae = W(
    (...O) => {
      var j;
      if ((j = u.current) != null && j.rate)
        return u.current.rate(...O);
      throw new Error("Agent is not initialized");
    },
    [u]
  ), nt = W(
    (...O) => {
      var j;
      if ((j = u.current) != null && j.getSTTToken)
        return u.current.getSTTToken(...O);
      throw new Error("Agent is not initialized");
    },
    [u]
  ), Ke = W(
    (...O) => {
      var j;
      if ((j = u.current) != null && j.enrichAnalytics)
        return u.current.enrichAnalytics(...O);
      p.current = { ...p.current, ...O };
    },
    [u]
  ), Jt = W(({ type: O }) => {
    var j;
    if ((j = u.current) != null && j.interrupt)
      Ne(!0), u.current.interrupt({ type: O }), setTimeout(() => {
        Ne(!1);
      }, 500);
    else
      throw new Error("Agent is not initialized");
  }, []), Qt = W(
    async (O) => {
      var j;
      if ((j = u.current) != null && j.publishMicrophoneStream)
        return u.current.publishMicrophoneStream(O);
      throw new Error("Agent manager is not initialized");
    },
    [u]
  ), Xt = W(
    async () => {
      var O;
      if ((O = u.current) != null && O.unpublishMicrophoneStream)
        return u.current.unpublishMicrophoneStream();
      throw new Error("Agent manager is not initialized");
    },
    [u]
  ), kn = Ve(() => {
    var j;
    const O = u.current;
    return ((j = a == null ? void 0 : a.presenter) == null ? void 0 : j.type) === "expressive" && O !== null && O !== void 0 && typeof O.publishMicrophoneStream == "function";
  }, [(en = a == null ? void 0 : a.presenter) == null ? void 0 : en.type]);
  return /* @__PURE__ */ h(
    lr.Provider,
    {
      value: {
        agent: a,
        changeMode: Fe,
        connect: () => ct(!1),
        connectionState: C,
        chatId: X,
        disconnect: Se,
        enabled: n,
        error: H,
        errorState: se,
        getSTTToken: nt,
        language: Ze,
        messages: x,
        rate: Ae,
        reconnect: () => ct(!0),
        restart: Te,
        sendChatMessage: Ge,
        setError: Y,
        setErrorState: fe,
        setLanguage: je,
        setTranslationLanguage: tt,
        setStreamState: k,
        srcObject: D,
        starterMessages: m,
        streamedMessage: V,
        streamState: M,
        terminating: U,
        enrichSdkAnalytics: Ke,
        greeted: ce,
        agentActivityState: L,
        setAgentActivityState: xe,
        streamType: A,
        interruptAvailable: S,
        interrupt: Jt,
        interruptLoading: ke,
        triggersAvailable: b,
        fluentStarted: Xe,
        legacyStarted: et,
        isRestarting: ae,
        publishMicrophoneStream: Qt,
        unpublishMicrophoneStream: Xt,
        supportsMicrophoneStream: kn
      },
      children: e
    }
  );
}
const kt = 768, ra = dt({
  opened: !1,
  setOpened: () => {
  },
  isChatOpen: !1,
  setIsChatOpen: () => {
  },
  expanded: !1,
  setExpanded: () => {
  },
  isBrowserFullscreen: !1,
  handleBrowserFullscreen: () => {
  },
  updateLayout: () => {
  },
  chatPosition: window.screen.width < kt ? "closed-bottom" : "closed-side",
  wrapperRef: null,
  isSmallScreen: !1,
  isHorizontal: !1,
  isMobileOrientationBlocked: !1
}), ci = () => {
  var e, n;
  return (n = (e = window.screen) == null ? void 0 : e.orientation) != null && n.type ? window.screen.orientation.type.startsWith("landscape") : !1;
}, Rc = ({ children: t }) => {
  const { configurations: e } = _e(Re), [n, r] = E(!!e.open), { enrichSdkAnalytics: i } = ze(), [a, o] = E(e.chatMode === T.Playground), [s, l] = E(!1), [c, g] = E(!1), d = te(null);
  I(() => {
    const _ = () => {
      const S = !!document.fullscreenElement;
      g(S), !S && c && l(!1);
    };
    return document.addEventListener("fullscreenchange", _), g(!!document.fullscreenElement), () => {
      document.removeEventListener("fullscreenchange", _);
    };
  }, [c]), I(() => {
    Kt("requestFullscreen", async (S) => {
      if (!d.current) {
        console.warn("Cannot toggle fullscreen: wrapper element not found");
        return;
      }
      const w = !!document.fullscreenElement;
      S === !1 ? w && await document.exitFullscreen() : S === !0 ? w || (l(!1), await d.current.requestFullscreen().catch((b) => {
        console.warn("Failed to enter fullscreen:", b);
      })) : w ? await document.exitFullscreen() : (l(!1), await d.current.requestFullscreen().catch((b) => {
        console.warn("Failed to enter fullscreen:", b);
      }));
    });
  }, []);
  const f = Ve(() => yc(), []), [p, u] = E(() => f ? ci() && (e.mode === "fabio" && n || s) : !1), [m, y] = E({
    chatBottom: window.screen.width < kt,
    isSmallScreen: f || window.innerWidth < kt,
    isHorizontal: !f && e.orientation === "horizontal"
  }), C = e.chatMode === T.Playground, v = e.mode === "fabio", M = W(() => {
    const _ = f || window.innerWidth <= kt;
    if (_)
      return y(() => ({
        chatBottom: !0,
        isHorizontal: !1,
        isSmallScreen: !0
      }));
    if (s)
      return y(() => ({
        chatBottom: _,
        isHorizontal: !_,
        isSmallScreen: _
      }));
    if (v) {
      const S = e.orientation === "vertical" || _, w = e.orientation === "horizontal" && !_;
      return y(() => ({
        isSmallScreen: _,
        isHorizontal: w,
        chatBottom: S
      }));
    }
    if (!v && e.targetElement) {
      let S = null;
      if (typeof e.targetElement == "string" ? S = document.getElementById(e.targetElement) : S = e.targetElement, S) {
        const w = S.getBoundingClientRect(), b = w.width, z = w.height, D = b >= 656;
        return i({
          agents_component_size: `${b}x${z}`,
          window_size: `${window.innerWidth}x${window.innerHeight}`
        }), C && document.documentElement.style.setProperty("--didWidth", `${b}px`), y(() => ({
          chatBottom: C ? !0 : !D,
          isSmallScreen: f || b < kt,
          isHorizontal: C ? !1 : b > z
        }));
      }
    }
    return y(() => ({
      chatBottom: window.innerWidth < kt,
      isSmallScreen: _,
      isHorizontal: e.orientation === "horizontal"
    }));
  }, [e, s, a]), k = te(null);
  I(() => {
    if (M(), e.mode === "fabio" || !e.targetElement || !ResizeObserver)
      return k.current = si(M, 100), window.addEventListener("resize", k.current), () => {
        window.removeEventListener("resize", k.current ?? (() => {
        })), k.current = null;
      };
    {
      const _ = e.targetElement, S = si(() => {
        requestAnimationFrame(() => {
          M();
        });
      }, 100), w = new ResizeObserver(S);
      return w.observe(_), () => {
        w.disconnect();
      };
    }
  }, [M, s, e.mode, m.isHorizontal]), I(() => {
    const _ = new CustomEvent("didagent_chat_toggled", {
      detail: a
    });
    window.dispatchEvent(_), i({
      is_chat_open: a
    }), M();
  }, [a]), I(() => {
    if (!f) return;
    const _ = () => {
      const w = ci() && (v && n || s);
      u(w);
    };
    return window.addEventListener("orientationchange", _), _(), () => {
      window.removeEventListener("orientationchange", _);
    };
  }, [f, v, n, s]);
  const L = W(() => {
    c ? (document.exitFullscreen().catch((_) => {
      console.warn("Failed to exit fullscreen:", _);
    }), l(!1)) : l((_) => !_);
  }, [c, l]), P = () => window.DID_AGENTS_API.functions.requestFullscreen(), A = a ? m.chatBottom ? "bottom" : "side" : m.chatBottom ? "closed-bottom" : "closed-side";
  return /* @__PURE__ */ h(
    ra.Provider,
    {
      value: {
        opened: n,
        isChatOpen: a,
        expanded: s,
        isBrowserFullscreen: c,
        handleBrowserFullscreen: P,
        isSmallScreen: m.isSmallScreen,
        isHorizontal: m.isHorizontal,
        isMobileOrientationBlocked: p,
        chatPosition: A,
        wrapperRef: d,
        setOpened: r,
        setIsChatOpen: o,
        setExpanded: L,
        updateLayout: M
      },
      children: t
    }
  );
}, He = () => _e(ra), ia = dt([]), aa = dt(() => {
});
function zc({ children: t }) {
  const [e, n] = E(Array(12).fill(2));
  return /* @__PURE__ */ h(ia.Provider, { value: e, children: /* @__PURE__ */ h(aa.Provider, { value: n, children: t }) });
}
const jc = () => _e(aa), Fc = () => _e(ia), $c = (t, e) => Array.from({ length: 12 }, (n, r) => {
  const i = r < 6 ? 11 - r : r, a = i % 3, o = Math.floor(i / 3) * 3 + a;
  let c = t[o * Math.floor(e / 12)] / 256 * 100;
  return a === 0 ? c *= 0.5 : a === 1 ? c *= 0.8 : c *= 1.2, Math.max(2, Math.min(23, c));
});
function Bc({
  publishMicrophoneStream: t,
  unpublishMicrophoneStream: e,
  supportsMicrophoneStream: n,
  connectionState: r,
  micStream: i,
  enforcedMicMuted: a
}) {
  const [o, s] = E(!1), l = te(!1), c = te(null), g = W(
    async (f) => {
      var u;
      if (!n || !t)
        return;
      const p = (u = f.getAudioTracks()[0]) == null ? void 0 : u.id;
      if (!(l.current || c.current === p))
        try {
          l.current = !0, await t(f), s(!0), c.current = p;
        } catch (m) {
          console.error("Failed to publish microphone stream:", m);
        } finally {
          l.current = !1;
        }
    },
    [n, t]
  ), d = W(async () => {
    if (!(!n || !e || !o))
      try {
        await e(), s(!1), c.current = null;
      } catch (f) {
        console.error("Failed to unpublish microphone stream:", f);
      }
  }, [n, e, o]);
  return I(() => {
    n && r === F.Connected && !a && i && !o && !l.current && g(i);
  }, [
    n,
    r,
    a,
    i,
    o,
    g
  ]), {
    publishMicrophoneStreamToSDK: g,
    unpublishMicrophoneStreamFromSDK: d,
    isMicrophonePublished: o
  };
}
const li = "DID_AGENT_STT_TOKEN", oa = 1e3 * 60 * 9, Uc = () => {
  const { getSTTToken: t } = ze();
  return W(async () => {
    const e = JSON.parse(
      localStorage.getItem(li) ?? "null"
    ), n = (/* @__PURE__ */ new Date()).getTime();
    if (e && n < e.expiry) return e;
    const r = await t(), i = { token: r, expiry: n + oa };
    return r && localStorage.setItem(li, JSON.stringify(i)), i;
  }, [t]);
}, Vc = "en-US";
class Hc {
  constructor({ events: e, getSTTToken: n, trackUi: r }) {
    Ee(this, "events");
    Ee(this, "getSTTToken");
    Ee(this, "recognizer");
    Ee(this, "speechSDK");
    Ee(this, "intervalId");
    Ee(this, "status", "ready");
    Ee(this, "trackUi");
    Ee(this, "abortPromise", null);
    Ee(this, "initEvents", () => {
      if (!this.recognizer || !this.speechSDK) return;
      const e = this.speechSDK;
      this.recognizer.recognized = (n, r) => {
        this.events.onresult(r);
      }, this.recognizer.canceled = (n, r) => {
        var i, a;
        (a = (i = this.events).onerror) == null || a.call(i, r);
      }, this.recognizer.recognizing = (n, r) => {
        var i, a;
        r.result.reason === e.ResultReason.RecognizingSpeech && ((a = (i = this.events).onrecognizing) == null || a.call(i, r));
      }, this.recognizer.sessionStopped = () => {
        var n, r;
        (r = (n = this.events).onend) == null || r.call(n);
      };
    });
    Ee(this, "refreshToken", async () => {
      var n, r;
      if (this.status === "destroyed" || !this.speechSDK) return;
      const e = await this.getSTTToken();
      if (!e.token)
        throw new Error("No STT token found in refreshToken");
      (n = this.recognizer) == null || n.properties.setProperty(
        this.speechSDK.PropertyId.SpeechServiceConnection_Region,
        e.token.region
      ), (r = this.recognizer) == null || r.properties.setProperty(
        this.speechSDK.PropertyId.SpeechServiceAuthorization_Token,
        e.token.token
      );
    });
    Ee(this, "initTokenRefreshInterval", (e) => {
      const n = (/* @__PURE__ */ new Date()).getTime();
      window.setTimeout(
        () => {
          this.status !== "destroyed" && (this.refreshToken(), this.intervalId = window.setInterval(this.refreshToken, oa));
        },
        e - n + 1
      );
    });
    Ee(this, "init", async (e, n, r) => {
      if (this.status === "destroying" || this.status === "destroyed")
        return;
      this.speechSDK || (this.speechSDK = await import("./microsoft.cognitiveservices.speech.sdk-BoVOS4Wx.js").then((d) => d.m));
      const { AudioConfig: i, SpeechRecognizer: a, PropertyId: o, SpeechConfig: s } = this.speechSDK, l = await this.getSTTToken();
      if (!l.token)
        throw new Error("No STT token found");
      const c = i.fromStreamInput(n), g = s.fromAuthorizationToken(
        l.token.token,
        l.token.region
      );
      r && g.setProperty(o.Speech_SegmentationSilenceTimeoutMs, r), g.speechRecognitionLanguage = e, this.recognizer = new a(g, c), this.initEvents(), this.initTokenRefreshInterval(l.expiry), this.status = "ready";
    });
    /**
     * Update event handlers after initialization.
     */
    Ee(this, "updateEvents", (e) => {
      this.events = e;
    });
    Ee(this, "start", () => this.status !== "ready" && this.status !== "muted" ? Promise.resolve() : this.recognizer ? (this.status = "starting", new Promise((e, n) => {
      this.recognizer.startContinuousRecognitionAsync(
        () => {
          var r, i;
          this.status = "listening", (i = (r = this.events).onstart) == null || i.call(r), e();
        },
        (r) => {
          this.status = "ready", this.trackUi("stt-error", {
            operation: "start",
            error: r
          }), n(new Error(r));
        }
      );
    })) : Promise.reject(new Error("Recognizer not initialized")));
    Ee(this, "stopRecognition", (e) => this.recognizer ? new Promise((n, r) => {
      this.recognizer.stopContinuousRecognitionAsync(
        () => {
          n();
        },
        (i) => {
          this.trackUi("stt-error", {
            operation: e,
            error: i
          }), r(new Error(i));
        }
      );
    }) : Promise.resolve());
    Ee(this, "abort", async () => {
      if (this.status === "listening")
        return this.abortPromise ? this.abortPromise : (this.abortPromise = (async () => {
          this.status = "muting";
          try {
            await this.stopRecognition("abort"), this.status = "muted";
          } catch (e) {
            throw this.status = "listening", e;
          } finally {
            this.abortPromise = null;
          }
        })(), this.abortPromise);
    });
    /**
     * Destroy the recognizer. This is needed to avoid memory leaks.
     * If you need to use the recognizer again, you need to create a new instance.
     */
    Ee(this, "destroy", async () => {
      if (!(this.status === "destroying" || this.status === "destroyed")) {
        this.abortPromise && await this.abortPromise, this.status === "listening" && await this.abort(), this.status = "destroying";
        try {
          await this.closeRecognizer();
        } catch (e) {
          throw this.status = "listening", e;
        } finally {
          this.recognizer = void 0, window.clearInterval(this.intervalId), this.status = "destroyed";
        }
      }
    });
    this.events = e, this.getSTTToken = n, this.status = "ready", this.trackUi = r;
  }
  /**
   * Private method to wrap the recognizer.close() in a Promise
   */
  closeRecognizer() {
    return new Promise((e, n) => {
      if (!this.recognizer) {
        e();
        return;
      }
      this.recognizer.close(
        () => {
          e();
        },
        (r) => {
          n(new Error(`Failed to close recognizer: ${r}`));
        }
      );
    });
  }
}
const Zc = ({
  enabled: t,
  selectedInputDevice: e,
  permissionGranted: n,
  language: r,
  speechSilenceTimeoutMs: i,
  micStream: a
}) => {
  const o = Uc(), { trackUi: s } = bt(), { agent: l } = ze(), [c, g] = E(null), d = te(null), f = te(o), p = te(s);
  return I(() => {
    f.current = o, p.current = s;
  }, [o, s]), I(() => {
    var L, P;
    const u = a, m = !!u, y = (P = (L = u == null ? void 0 : u.getAudioTracks()[0]) == null ? void 0 : L.getSettings()) == null ? void 0 : P.deviceId;
    if (!(t && n && m && !!r && (!!!e || y === e) && !!l)) {
      d.current && (d.current.destroy().catch((A) => {
        console.error("Failed to destroy recognizer:", A);
      }), d.current = null, g(null));
      return;
    }
    const k = new Hc({
      getSTTToken: f.current,
      events: {
        onresult: () => {
        },
        onstart: () => {
        },
        onend: () => {
        },
        onerror: () => {
        },
        onrecognizing: () => {
        }
      },
      trackUi: p.current
    });
    return d.current = k, k.init(r, u, i).then(() => {
      g(k);
    }).catch((A) => {
      console.error("Failed to initialize STT recognizer:", A), d.current = null, g(null);
    }), () => {
      d.current = null, k.destroy().catch((A) => {
        console.error("Failed to destroy recognizer:", A);
      }), g(null);
    };
  }, [t, e, n, r, i, a, l]), c;
}, sa = dt({
  permissionAsked: !1,
  permissionGranted: !1,
  conversationStarted: !1,
  micMuted: !1,
  inputDevices: [],
  outputDevices: [],
  selectedInputDevice: "",
  selectedOutputDevice: "",
  micStreamRef: { current: null },
  speakerMuted: !1,
  handleMicMute: () => {
  },
  handleSpeakerMute: () => {
  },
  setSpeakerMuted: () => {
  },
  startConversation: () => {
  },
  setSelectedInputDevice: () => {
  },
  requestMicrophoneAccess: () => {
  },
  setSelectedOutputDevice: () => {
  },
  sttRecognizer: null
}), Rt = (t) => t.replace(/^Default - /, "");
function Kc({ children: t }) {
  var et, At;
  const {
    connect: e,
    enrichSdkAnalytics: n,
    agent: r,
    enabled: i,
    language: a,
    connectionState: o,
    publishMicrophoneStream: s,
    unpublishMicrophoneStream: l,
    supportsMicrophoneStream: c
  } = ze(), { configurations: g } = _e(Re), [d, f] = E(!1), [p, u] = E(!1), [m, y] = E(null), [C, v] = E(g.chatMode === T.Playground), [M, k] = E(!1), [L, P] = E([]), [A, _] = E([]), [S, w] = E(""), [b, z] = E(""), D = te(null), [q, V] = E(null), B = jc(), H = te(null), { opened: Y } = He(), X = o === F.Disconnected, K = g.mode === "fabio", U = g.chatMode === T.Playground, Z = g.chatMode === T.TextOnly, x = U || Z, R = !Y && K || X && !x, se = R ? !0 : C, ge = R ? !0 : M, ee = te(null), N = te(null), $ = te(null), {
    publishMicrophoneStreamToSDK: J,
    unpublishMicrophoneStreamFromSDK: ae
  } = Bc({
    publishMicrophoneStream: s,
    unpublishMicrophoneStream: l,
    supportsMicrophoneStream: c,
    connectionState: o,
    micStream: q,
    enforcedMicMuted: se
  }), oe = Ve(() => {
    var me, fe, Ce;
    const G = ((fe = (me = r == null ? void 0 : r.presenter) == null ? void 0 : me.voice) == null ? void 0 : fe.language) || "English";
    return pn(G) ? a : ((Ce = mn.find(({ label: Se }) => G.includes(Se))) == null ? void 0 : Ce.value) || Vc;
  }, [(At = (et = r == null ? void 0 : r.presenter) == null ? void 0 : et.voice) == null ? void 0 : At.language, a]), ce = Zc({
    enabled: i && !c,
    selectedInputDevice: S,
    permissionGranted: m,
    language: oe,
    speechSilenceTimeoutMs: g.speechSilenceTimeoutMs,
    micStream: c ? null : q
  }), ye = W(() => {
    H.current !== null && (cancelAnimationFrame(H.current), H.current = null);
  }, []), ke = W(
    (G = !1) => {
      ye(), G || ae(), D.current && (D.current.getTracks().forEach((le) => {
        le.stop(), le.enabled = !1;
      }), D.current = null, V(null)), N.current && (N.current.disconnect(), N.current = null), $.current && ($.current.disconnect(), $.current = null), ee.current && (ee.current.close(), ee.current = null);
    },
    [ye, ae]
  ), Ne = W(
    async (G = !1) => {
      var Ye, tt, ct, mt;
      const le = await navigator.mediaDevices.enumerateDevices(), me = /* @__PURE__ */ new Map(), fe = /* @__PURE__ */ new Map();
      le.forEach((Te) => {
        const Ge = Rt(Te.label);
        Te.kind === "audioinput" ? (!me.has(Ge) || Te.deviceId !== "default") && me.set(Ge, Te) : Te.kind === "audiooutput" && (!fe.has(Ge) || Te.deviceId !== "default") && fe.set(Ge, Te);
      });
      const Ce = Array.from(me.values()), Se = Array.from(fe.values());
      P(Ce), _(Se);
      const De = localStorage.getItem("didagent__selected_input_device"), Le = localStorage.getItem("didagent__selected_output_device");
      if (G) {
        const Te = Ce.find((Fe) => Fe.deviceId === De);
        if (De && Te)
          w(De);
        else {
          const Fe = le.filter((Ae) => Ae.kind === "audioinput").find((Ae) => Ae.deviceId === "default");
          if (Fe) {
            const Ae = Rt(Fe.label), nt = Ce.find((Ke) => Rt(Ke.label) === Ae);
            w((nt == null ? void 0 : nt.deviceId) || ((Ye = Ce[0]) == null ? void 0 : Ye.deviceId) || "");
          } else
            w(((tt = Ce[0]) == null ? void 0 : tt.deviceId) || "");
        }
        const Ge = Se.find((Fe) => Fe.deviceId === Le);
        if (Le && Ge)
          z(Le);
        else {
          const Fe = le.filter((Ae) => Ae.kind === "audiooutput").find((Ae) => Ae.deviceId === "default");
          if (Fe) {
            const Ae = Rt(Fe.label), nt = Se.find(
              (Ke) => Rt(Ke.label) === Ae
            );
            z((nt == null ? void 0 : nt.deviceId) || ((ct = Se[0]) == null ? void 0 : ct.deviceId) || "");
          } else
            z(((mt = Se[0]) == null ? void 0 : mt.deviceId) || "");
        }
      }
    },
    [w, z, P, _]
  ), Ze = W(() => {
    if (!$.current) return;
    const G = $.current, le = G.frequencyBinCount, me = new Uint8Array(le), fe = () => {
      if (!$.current) return;
      G.getByteFrequencyData(me);
      const Ce = $c(me, le);
      B(Ce), H.current = requestAnimationFrame(fe);
    };
    H.current = requestAnimationFrame(fe);
  }, [B]);
  I(() => {
    var G;
    S && !L.find((le) => le.deviceId === S) && w(((G = L[0]) == null ? void 0 : G.deviceId) || "");
  }, [S, L]), I(() => {
    var G;
    b && !A.find((le) => le.deviceId === b) && z(((G = A[0]) == null ? void 0 : G.deviceId) || "");
  }, [b, A]), I(() => {
    S ? localStorage.setItem("didagent__selected_input_device", S) : localStorage.removeItem("didagent__selected_input_device");
  }, [S]), I(() => {
    b ? localStorage.setItem("didagent__selected_output_device", b) : localStorage.removeItem("didagent__selected_output_device");
  }, [b]);
  const je = W(
    async (G) => {
      var Ce, Se;
      const le = (Ce = G.getAudioTracks()[0]) == null ? void 0 : Ce.id, me = D.current, fe = (Se = me == null ? void 0 : me.getAudioTracks()[0]) == null ? void 0 : Se.id;
      me && fe !== le && await ae(), ke(!0);
      try {
        D.current = G, V(G);
        const De = window.AudioContext || (window == null ? void 0 : window.webkitAudioContext), Le = new De();
        ee.current = Le, Le.state === "suspended" && await Le.resume();
        const Ye = Le.createMediaStreamSource(G);
        N.current = Ye;
        const tt = Le.createAnalyser();
        $.current = tt, tt.fftSize = 64, Ye.connect(tt), y(!0), Ze(), o === F.Connected && await J(G);
      } catch (De) {
        console.error("Error in handleMicStream:", De), ke();
      }
    },
    [
      ke,
      Ze,
      o,
      ae,
      J
    ]
  ), qe = W(() => {
    var Se, De;
    const G = D.current, me = ((De = (Se = G == null ? void 0 : G.getAudioTracks()[0]) == null ? void 0 : Se.getSettings()) == null ? void 0 : De.deviceId) === S;
    if ((() => {
      if (!G || !me)
        return !1;
      const Le = G.getAudioTracks()[0];
      return (Le == null ? void 0 : Le.readyState) === "live";
    })())
      return;
    p || u(!0);
    const Ce = (S == null ? void 0 : S.length) > 0 ? { deviceId: { exact: S } } : !0;
    navigator.mediaDevices.getUserMedia({
      audio: Ce
    }).then(je).catch((Le) => {
      console.error("Error accessing microphone: ", Le), y(!1);
    });
  }, [je, S, p]), gt = W(() => {
    d || (f(!0), x || e(), qe());
  }, [d, qe, e]);
  I(() => {
    d || (K && Y || !K && U) && gt();
  }, [Y, d, K]), I(() => {
    !r || d || g.autoConnect && g.mode === "full" && g.targetElement && gt();
  }, [g.autoConnect, g.mode, g.targetElement, d, gt, r]);
  const xe = W(
    async (G) => {
      let le;
      G !== void 0 ? (le = G, v(G)) : v((me) => (le = !me, le)), c && o === F.Connected && (le ? await ae() : D.current && await J(D.current));
    },
    [
      c,
      o,
      ae,
      J
    ]
  );
  Kt("toggleMicState", xe);
  const pt = W(
    (G) => {
      k(G !== void 0 ? G : (le) => !le);
    },
    [k]
  );
  Kt("toggleSpeakerState", pt);
  const Xe = d && (K ? Y : !0) && !se;
  return I(() => {
    var le, me;
    const G = D.current;
    if (!Xe)
      ke(), B(Array(12).fill(2));
    else if (!G)
      qe();
    else {
      const fe = (me = (le = G.getAudioTracks()[0]) == null ? void 0 : le.getSettings()) == null ? void 0 : me.deviceId;
      S && fe && fe !== S && qe();
    }
  }, [Xe, ke, qe, B, S]), I(() => () => {
    ke();
  }, [ke]), I(() => {
    if (!m) return;
    const G = () => {
      Ne(!1);
    };
    return navigator.mediaDevices.addEventListener("devicechange", G), Ne(!0), () => {
      navigator.mediaDevices.removeEventListener("devicechange", G);
    };
  }, [Ne, m]), I(() => {
    n({
      microphone_status: se ? "muted" : "unmuted",
      speaker_status: ge ? "muted" : "unmuted"
    });
  }, [se, ge]), /* @__PURE__ */ h(
    sa.Provider,
    {
      value: {
        conversationStarted: d,
        permissionAsked: p,
        permissionGranted: m,
        inputDevices: L,
        outputDevices: A,
        selectedInputDevice: S,
        selectedOutputDevice: b,
        micStreamRef: D,
        micMuted: se,
        speakerMuted: ge,
        handleMicMute: xe,
        handleSpeakerMute: pt,
        setSpeakerMuted: k,
        startConversation: gt,
        setSelectedInputDevice: w,
        requestMicrophoneAccess: qe,
        setSelectedOutputDevice: z,
        sttRecognizer: ce
      },
      children: t
    }
  );
}
const ht = () => _e(sa), ca = "data:image/svg+xml,%3csvg%20version='1.1'%20id='L9'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20x='0px'%20y='0px'%20viewBox='0%200%20100%20100'%20enable-background='new%200%200%200%200'%20xml:space='preserve'%3e%3cpath%20fill='%23fff'%20d='M73,50c0-12.7-10.3-23-23-23S27,37.3,27,50%20M30.9,50c0-10.5,8.5-19.1,19.1-19.1S69.1,39.5,69.1,50'%3e%3c/path%3e%3c/svg%3e", dr = [F.Fail, F.Disconnected, F.Completed], Wc = (t) => {
  const [e, n] = E(
    0
    /* Idle */
  ), r = [de.Buffering, de.Loading].includes(
    t
  );
  return I(() => {
    r ? (n(
      1
      /* Delayed */
    ), setTimeout(() => {
      n((s) => s === 1 ? 2 : s);
    }, 1200)) : n(
      0
      /* Idle */
    );
  }, [r]), {
    isResponseLoading: e === 2,
    isResponseDelayed: e === 1,
    isResponseIdle: e === 0
  };
}, Gc = "#e6e6e6";
function qc(t) {
  const e = t.style.height;
  t.style.height = "0";
  const n = t.scrollHeight / parseInt(getComputedStyle(t).lineHeight);
  return t.style.height = e, parseInt(n + "");
}
const Yc = ["studio-dev.d-id.com", "studio-staging.d-id.com", "studio.d-id.com"], la = Yc.some((t) => window.location.hostname === t), di = la && window.location.pathname === "/agents/share";
function Jc() {
  try {
    return /iPhone|iPad|iPod/i.test(navigator.userAgent);
  } catch (t) {
    console.error("Error occurred while detecting iOS:", t);
  }
  return !1;
}
function Qc() {
  const t = navigator.userAgent.match(/OS (\d+)_\d+(_\d+)? like Mac OS X/i);
  return t ? parseInt(t[1], 10) === 17 : !1;
}
const Xc = (t, e) => new Promise((n) => {
  const r = document.createElement("canvas"), i = r.getContext("2d");
  if (!r || !i) {
    console.error("Failed adding background to presenter poster - could not create canvas or context"), n(t);
    return;
  }
  const a = new Image();
  a.crossOrigin = "anonymous", a.src = t, a.onload = () => {
    r.width = a.width, r.height = a.height, r.style.width = a.width + "px", r.style.height = a.height + "px", i.fillStyle = e, i.fillRect(0, 0, r.width, r.height), i.imageSmoothingEnabled = !0, i.imageSmoothingQuality = "high", i.drawImage(a, 0, 0), n(r.toDataURL("image/jpeg", 0.95));
  }, a.onerror = () => {
    console.error("Failed adding background to presenter poster - could not load image"), n(t);
  };
});
function el() {
  const { configurations: t, configure: e } = _e(Re), { agent: n, changeMode: r } = ze();
  I(() => {
    if (t.posterSrc || la && t.chatMode === T.Playground)
      return;
    (async () => {
      const a = n == null ? void 0 : n.presenter;
      if (!a) return;
      const { type: o, poster: s, source_url: l, thumbnail: c } = a;
      let g;
      if (o === "clip" || o === "expressive")
        g = s || c;
      else if (o === "talk")
        g = l || s || c;
      else {
        r(T.Maintenance);
        return;
      }
      const d = await Xc(g, Gc);
      e({ posterSrc: d });
    })();
  }, [n == null ? void 0 : n.id]);
}
function pe({
  src: t,
  size: e,
  color: n = "currentcolor",
  padding: r = "0",
  rotated: i,
  margin: a = "0",
  width: o,
  className: s = ""
}) {
  return /* @__PURE__ */ h(
    "svg",
    {
      className: "didagent__maskedicon " + s,
      style: {
        "--mask-url": `url("${t}")`,
        "--color": n,
        "--width": o,
        "--size": e,
        "--padding": r,
        "--margin": a,
        "--rotation": i ? "180deg" : "0deg"
      },
      "aria-hidden": "true",
      focusable: "false"
    }
  );
}
const da = "data:image/svg+xml,%3csvg%20version='1.1'%20id='L5'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20x='0px'%20y='0px'%20viewBox='0%200%2052%2042'%20enable-background='new%200%200%200%200'%20xml:space='preserve'%3e%3ccircle%20fill='%23fff'%20stroke='none'%20cx='6'%20cy='21'%20r='6'%3e%3canimateTransform%20attributeName='transform'%20dur='1s'%20type='translate'%20values='0%2015%20;%200%20-15;%200%2015'%20repeatCount='indefinite'%20begin='0.1'/%3e%3c/circle%3e%3ccircle%20fill='%23fff'%20stroke='none'%20cx='25'%20cy='21'%20r='6'%3e%3canimateTransform%20attributeName='transform'%20dur='1s'%20type='translate'%20values='0%2010%20;%200%20-10;%200%2010'%20repeatCount='indefinite'%20begin='0.2'/%3e%3c/circle%3e%3ccircle%20fill='%23fff'%20stroke='none'%20cx='44'%20cy='21'%20r='6'%3e%3canimateTransform%20attributeName='transform'%20dur='1s'%20type='translate'%20values='0%205%20;%200%20-5;%200%205'%20repeatCount='indefinite'%20begin='0.3'/%3e%3c/circle%3e%3c/svg%3e", tl = typeof window < "u" && typeof window.document < "u" && typeof window.document.createElement < "u", nl = tl ? Hi : I;
function rl(t, e) {
  const n = te(t);
  nl(() => {
    n.current = t;
  }, [t]), I(() => {
    function r() {
      n.current();
    }
    if (e !== null) {
      const i = setInterval(r, e);
      return () => clearInterval(i);
    }
  }, [e]);
}
const il = (t) => {
  const r = t % 2e3 / 2e3;
  return Array(12).fill(2).map((a, o) => {
    const s = o > 6 ? o : 11 - o, l = (r + s / 12) * Math.PI * 2;
    let g = (Math.sin(l) + 1) / 2 * 12;
    return g = Math.max(2, Math.min(g, 23)), g;
  });
}, al = 36, ol = 500, sl = ({ isPlaying: t, isDelayed: e, canInterrupt: n }) => {
  const r = Fc(), i = te(null), [a, o] = E(!1), [s, l] = E([]), { interruptAvailable: c, greeted: g } = ze(), { micMuted: d } = ht(), { t: f } = ut(), p = te(0), u = Ve(() => {
    const C = r.reduce((M, k) => M + k, 0), v = Date.now();
    return C > al ? (p.current = v, !0) : v - p.current < ol;
  }, [r]);
  return I(() => {
    c || (t && u && (i.current = Date.now(), o(!0)), t && !u && i.current && Date.now() - i.current > 2e3 && (i.current = null, o(!1)));
  }, [c, u]), rl(
    () => {
      const C = Date.now(), v = il(C);
      l(v);
    },
    e ? 73 : null
  ), t && (a || !g && n) ? /* @__PURE__ */ h("div", { className: "didagent__button didagaent__wave__container", children: /* @__PURE__ */ h("span", { className: "didagent__button__response__active", children: "Please wait until the response is complete" }) }) : n && !d && g && !u ? /* @__PURE__ */ h("div", { className: "didagent__button didagaent__wave__container", children: /* @__PURE__ */ h("span", { className: "didagent__button__response__active", children: f("hints.interrupt") }) }) : /* @__PURE__ */ h("div", { className: "didagent__button didagaent__wave__container", children: /* @__PURE__ */ h("div", { className: "didagent__wave__container", children: /* @__PURE__ */ h("div", { className: "wave", children: (e ? s : r).map((C, v) => /* @__PURE__ */ h(
    "div",
    {
      className: "bar",
      style: { height: `${Math.round(Math.max(C / 23 * 100, 10))}%` }
    },
    v
  )) }) }) });
}, cl = 1e3, ll = 2;
function dl({
  isPlaying: t,
  isLoading: e,
  isDelayed: n,
  isTextual: r,
  onSend: i,
  disableSend: a,
  isIdle: o
}) {
  const { connectionState: s, reconnect: l, language: c, interruptAvailable: g, interrupt: d } = ze(), { micMuted: f, sttRecognizer: p } = ht(), { trackUi: u } = bt(), { configurations: m } = _e(Re), y = te(!1), C = te(!1), v = te(!1);
  C.current = t && g && m.enableInterruptOption.includes(Ct.Audio), y.current = !a && (o || C.current);
  const M = W(
    async (L) => {
      if (!p) return;
      !r && dr.includes(s) && await l();
      const P = L ? "start" : "abort";
      await (p == null ? void 0 : p[P]());
    },
    [p, s, l, r]
  );
  I(() => {
    g || M(!t && !f && !e && !a);
  }, [M, t, f, e, g, a]), I(() => {
    g && M(!f && !a);
  }, [M, g, f, a]);
  const k = Ve(() => ({
    onresult(L) {
      var P, A, _;
      y.current && (C.current && !v.current && ((P = L.result.text) == null ? void 0 : P.trim()) !== "" && (v.current = !0, d({ type: "audio" })), i(L.result.text), (_ = (A = window.DID_AGENTS_API.callbacks) == null ? void 0 : A.onSttEnd) == null || _.call(A, L));
    },
    onstart: () => {
      v.current = !1, u("agent-stt", { event: "start", engine: "azure" });
    },
    onend: () => {
      u("agent-stt", { event: "end", engine: "azure" });
    },
    onerror: async (L) => {
      const { CancellationReason: P } = await import("./microsoft.cognitiveservices.speech.sdk-BoVOS4Wx.js").then((A) => A.m);
      L.reason === P.Error && (y.current && M(!0), u("agent-stt", {
        event: "error",
        error: L.errorDetails,
        errorCode: L.errorCode,
        engine: "azure",
        language: c
      }));
    },
    onrecognizing: (L) => {
      if (!C.current || !y.current || v.current)
        return;
      (L.result.duration > cl || L.result.text.split(" ").length > ll) && (v.current = !0, d({ type: "audio" }));
    }
  }), [d, i, c, M]);
  return I(() => {
    p && p.updateEvents(k);
  }, [p, k]), e ? /* @__PURE__ */ h("div", { className: "didagent__button didagaent__wave__container", children: /* @__PURE__ */ h(pe, { src: da, color: "orange", size: "22px" }) }) : /* @__PURE__ */ h(sl, { isPlaying: t, isDelayed: n, canInterrupt: C.current });
}
const ua = "data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='iso-8859-1'?%3e%3c!--%20Uploaded%20to:%20SVG%20Repo,%20www.svgrepo.com,%20Generator:%20SVG%20Repo%20Mixer%20Tools%20--%3e%3csvg%20height='800px'%20width='800px'%20version='1.1'%20id='Capa_1'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20viewBox='0%200%20199.943%20199.943'%20xml:space='preserve'%3e%3cg%3e%3cg%3e%3cpath%20style='fill:%23010002;'%20d='M99.972,0.004C44.85,0.004,0,44.847,0,99.968c0,55.125,44.847,99.972,99.972,99.972%20s99.972-44.847,99.972-99.972C199.943,44.847,155.093,0.004,99.972,0.004z%20M99.972,190.957c-50.168,0-90.996-40.813-90.996-90.989%20c0-50.172,40.828-90.992,90.996-90.992c50.175,0,91.003,40.817,91.003,90.992S150.147,190.957,99.972,190.957z'/%3e%3cpath%20style='fill:%23010002;'%20d='M99.324,67.354c-3.708,0-6.725,3.01-6.725,6.728v75.979c0,3.722,3.017,6.739,6.725,6.739%20c3.722,0,6.739-3.017,6.739-6.739V74.082C106.063,70.364,103.042,67.354,99.324,67.354z'/%3e%3ccircle%20style='fill:%23010002;'%20cx='99.746'%20cy='48.697'%20r='8.178'/%3e%3c/g%3e%3c/g%3e%3c/svg%3e";
function ul({ content: t, hide: e }) {
  return e || !t ? null : /* @__PURE__ */ h("div", { className: "didagent__banner", role: "banner", children: [
    /* @__PURE__ */ h("div", { className: "didagent__banner__icon__container", children: /* @__PURE__ */ h(pe, { size: "16px", src: ua }) }),
    /* @__PURE__ */ h("div", { className: "didagent__banner__text__container", children: t })
  ] });
}
const hl = "data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='24'%20height='24'%20fill='none'%3e%3cpath%20fill='currentcolor'%20d='m13.087%2021.388.645.382-.645-.382Zm.542-.916-.646-.382.646.382Zm-3.258%200-.645.382.645-.382Zm.542.916.646-.382-.646.382Zm-8.532-5.475.693-.287-.693.287Zm5.409%203.078-.013.75.013-.75Zm-2.703-.372-.287.693.287-.693Zm16.532-2.706.693.287-.693-.287Zm-5.409%203.078-.012-.75.012.75Zm2.703-.372.287.693-.287-.693Zm.7-15.882-.392.64.392-.64Zm1.65%201.65.64-.391-.64.392ZM4.388%202.738l-.392-.64.392.64Zm-1.651%201.65-.64-.391.64.392ZM9.403%2019.21l.377-.649-.377.649Zm4.33%202.56.541-.916-1.29-.764-.543.916%201.291.764Zm-4.007-.916.542.916%201.29-.764-.541-.916-1.291.764Zm2.715.152a.52.52%200%200%201-.882%200l-1.291.764c.773%201.307%202.69%201.307%203.464%200l-1.29-.764ZM10.5%202.75h3v-1.5h-3v1.5Zm10.75%207.75v1h1.5v-1h-1.5Zm-18.5%201v-1h-1.5v1h1.5Zm-1.5%200c0%201.155%200%202.058.05%202.787.05.735.153%201.347.388%201.913l1.386-.574c-.147-.352-.233-.782-.278-1.441-.046-.666-.046-1.51-.046-2.685h-1.5Zm6.553%206.742c-1.256-.022-1.914-.102-2.43-.316L4.8%2019.313c.805.334%201.721.408%202.977.43l.026-1.5ZM1.688%2016.2A5.75%205.75%200%200%200%204.8%2019.312l.574-1.386a4.25%204.25%200%200%201-2.3-2.3l-1.386.574Zm19.562-4.7c0%201.175%200%202.019-.046%202.685-.045.659-.131%201.089-.277%201.441l1.385.574c.235-.566.338-1.178.389-1.913.05-.729.049-1.632.049-2.787h-1.5Zm-5.027%208.241c1.256-.021%202.172-.095%202.977-.429l-.574-1.386c-.515.214-1.173.294-2.428.316l.025%201.5Zm4.704-4.115a4.25%204.25%200%200%201-2.3%202.3l.573%201.386a5.75%205.75%200%200%200%203.112-3.112l-1.386-.574ZM13.5%202.75c1.651%200%202.837%200%203.762.089.914.087%201.495.253%201.959.537l.783-1.279c-.739-.452-1.577-.654-2.6-.752-1.012-.096-2.282-.095-3.904-.095v1.5Zm9.25%207.75c0-1.622%200-2.891-.096-3.904-.097-1.023-.299-1.862-.751-2.6l-1.28.783c.285.464.451%201.045.538%201.96.088.924.089%202.11.089%203.761h1.5Zm-3.53-7.124a4.25%204.25%200%200%201%201.404%201.403l1.279-.783a5.75%205.75%200%200%200-1.899-1.899l-.783%201.28ZM10.5%201.25c-1.622%200-2.891%200-3.904.095-1.023.098-1.862.3-2.6.752l.783%201.28c.464-.285%201.045-.451%201.96-.538.924-.088%202.11-.089%203.761-.089v-1.5ZM2.75%2010.5c0-1.651%200-2.837.089-3.762.087-.914.253-1.495.537-1.959l-1.279-.783c-.452.738-.654%201.577-.752%202.6C1.25%207.61%201.25%208.878%201.25%2010.5h1.5Zm1.246-8.403a5.75%205.75%200%200%200-1.899%201.899l1.28.783a4.25%204.25%200%200%201%201.402-1.403l-.783-1.279Zm7.02%2017.993c-.202-.343-.38-.646-.554-.884a2.229%202.229%200%200%200-.682-.645l-.754%201.297c.047.028.112.078.224.232.121.166.258.396.476.764l1.29-.764Zm-3.24-.349c.44.008.718.014.93.037.198.022.275.054.32.08l.754-1.297c-.293-.17-.598-.24-.909-.274-.298-.033-.657-.038-1.069-.045l-.025%201.5Zm6.498%201.113c.218-.367.355-.598.476-.764.112-.154.177-.204.224-.232l-.754-1.297c-.29.17-.5.395-.682.645-.173.238-.352.54-.555.884l1.291.764Zm1.924-2.612c-.412.007-.771.012-1.069.045-.311.035-.616.104-.909.274l.754%201.297c.045-.026.122-.058.32-.08.212-.023.49-.03.93-.037l-.026-1.5Z'%20/%3e%3cpath%20stroke='currentcolor'%20stroke-linecap='round'%20stroke-width='1.5'%20d='M8%209h8M8%2012.5h5.5'%20/%3e%3c/svg%3e", $t = /<a\s+href="([^"]*)"[^>]*>([^<]*)<\/a>/g, ha = /^(https?:\/\/|www\.)[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_+.~#?&//=]*)$/, En = {
  "#general#": 280,
  ".": 620,
  ",": 500,
  "?": 500,
  "!": 500
};
function ga(t) {
  const e = t.replace(/["'<>]+/g, "").replace(/[.,!?]+$/, "").replace(/\.$/, "");
  return /^www\./i.test(e) ? "https://" + e : /^https?:\/\//i.test(e) ? e : "https://" + e;
}
function gl(t) {
  return typeof t == "string" ? ha.test(t) ? /* @__PURE__ */ h("a", { href: ga(t), target: "_blank", rel: "noreferrer", className: "didagent__message__url", children: t }) : /* @__PURE__ */ h("span", { children: t }) : /* @__PURE__ */ h("a", { href: t.href, target: "_blank", rel: "noreferrer", className: "didagent__message__url", children: t.label });
}
function fl(t) {
  return typeof t == "string" && En[t.split("").pop() ?? ""] || En["#general#"];
}
function pl(t) {
  $t.lastIndex = 0;
  const e = $t.exec(t);
  if (e)
    return e[1];
  const n = t.split(/\s+/);
  for (const r of n)
    if (ha.test(r))
      return ga(r);
  return null;
}
function ml(t) {
  const e = [];
  let n = 0;
  $t.lastIndex = 0;
  let r;
  for (; (r = $t.exec(t)) !== null; ) {
    if (r.index > n) {
      const i = t.slice(n, r.index);
      e.push(...i.split(" ").filter((a) => a.length > 0));
    }
    e.push({
      type: "link",
      href: r[1],
      label: r[2]
    }), n = $t.lastIndex;
  }
  if (n < t.length) {
    const i = t.slice(n);
    e.push(...i.split(" ").filter((a) => a.length > 0));
  }
  return e;
}
function _l() {
  const { messages: t } = ze(), { isChatOpen: e } = He(), [n, r] = E(null), i = te(0);
  I(() => {
    if (e) {
      r(null), i.current = t.length;
      return;
    }
    const o = i.current > 0 ? t.slice(i.current) : t;
    for (let s = o.length - 1; s >= 0; s--) {
      const l = o[s];
      if (l.role === "assistant") {
        const c = pl(l.content);
        if (c) {
          r(c), i.current = t.length;
          return;
        }
      }
    }
  }, [t, e]);
  const a = W(() => {
    r(null), i.current = t.length;
  }, [t.length]);
  return {
    url: n,
    clear: a
  };
}
const vl = "data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='7'%20height='6'%20viewBox='0%200%207%206'%20fill='none'%3e%3ccircle%20cx='3.19211'%20cy='2.99997'%20r='2.88889'%20fill='%23497CFF'/%3e%3c/svg%3e";
function wl({ className: t = "" }) {
  return /* @__PURE__ */ h("div", { className: `didagent__link__notification__badge ${t}`, children: /* @__PURE__ */ h(pe, { src: vl, size: "7px", color: "#497CFF" }) });
}
const yl = "data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='12'%20height='12'%20viewBox='0%200%2012%2012'%20fill='none'%3e%3cg%20clip-path='url(%23clip0_63315_41)'%3e%3cpath%20d='M5.0232%207C4.27022%206.24409%204.33804%204.95044%205.17469%204.11054L7.59852%201.67731C8.43517%200.837414%209.72382%200.769326%2010.4768%201.52523C11.2298%202.28114%2011.162%203.57478%2010.3253%204.41468L9.11339%205.6313'%20stroke='%23090604'%20stroke-linecap='round'/%3e%3cpath%20d='M6.9768%205C7.72978%205.75591%207.66196%207.04954%206.82531%207.88944L5.6134%209.10606L4.4015%2010.3227C3.56484%2011.1626%202.27619%2011.2307%201.5232%2010.4748C0.770217%209.71886%200.838043%208.4252%201.67469%207.5853L2.88662%206.36867'%20stroke='%23090604'%20stroke-linecap='round'/%3e%3c/g%3e%3cdefs%3e%3cclipPath%20id='clip0_63315_41'%3e%3crect%20width='12'%20height='12'%20fill='white'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e";
function fa({ children: t, enabled: e, content: n, persist: r = !1, className: i = "" }) {
  if (!e)
    return t;
  const a = `didagent__tooltip ${r ? "didagent__tooltip__persistent" : "didagent__tooltip__hover"} ${i}`;
  return /* @__PURE__ */ h("div", { className: a, children: [
    t,
    /* @__PURE__ */ h("span", { className: "didagent__tooltip__content", children: n })
  ] });
}
const Cl = 5e3;
function bl({ children: t, url: e, onLinkClick: n }) {
  const [r, i] = E(!1), a = te(null);
  return I(() => (e ? (i(!0), a.current && clearTimeout(a.current), a.current = setTimeout(() => {
    i(!1);
  }, Cl)) : i(!1), () => {
    a.current && clearTimeout(a.current);
  }), [e]), /* @__PURE__ */ h(fa, { enabled: r, content: e ? /* @__PURE__ */ h("div", { onClick: (l) => {
    l.preventDefault(), l.stopPropagation(), e && (window.open(e, "_blank", "noopener,noreferrer"), i(!1), n == null || n());
  }, children: [
    /* @__PURE__ */ h(pe, { src: yl, size: "12px", color: "#090604", className: "didagent__tooltip__link__icon" }),
    /* @__PURE__ */ h("span", { children: e })
  ] }) : "", persist: !0, className: "didagent__tooltip__link", children: t });
}
function Sl({ withLabel: t }) {
  const { isChatOpen: e, setIsChatOpen: n } = He(), { url: r, clear: i } = _l(), a = e ? "Close chat" : "Open chat", o = !!r;
  return /* @__PURE__ */ h(bl, { url: r, onLinkClick: i, children: /* @__PURE__ */ h(
    "button",
    {
      className: "didagent__chat__toggle didagent__button " + (t ? "didagent__button__controller__with__label" : "didagent__button__controller") + (e ? "" : " didagent__button__dark"),
      role: "button",
      "data-active": e,
      onClick: () => {
        n((s) => !s);
      },
      "data-testid": "chat_toggle",
      "aria-label": a,
      "aria-pressed": e,
      children: [
        /* @__PURE__ */ h(pe, { src: hl, size: "24px" }),
        t && /* @__PURE__ */ h("span", { children: "History" }),
        o && /* @__PURE__ */ h(wl, {})
      ]
    }
  ) });
}
const Ml = "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPScyNCcgaGVpZ2h0PScyNCcgZmlsbD0ibm9uZSIgdmlldy1ib3g9IjAgMCAyNCAyNCI+CiAgICA8cGF0aCBzdHJva2U9J2N1cnJlbnRjb2xvcicgc3Ryb2tlLXdpZHRoPScxLjUnIGQ9Ik03IDhhNSA1IDAgMCAxIDEwIDB2M2E1IDUgMCAwIDEtMTAgMFY4WiIgLz4KICAgIDxwYXRoCiAgICAgICAgc3Ryb2tlPSdjdXJyZW50Y29sb3InCiAgICAgICAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogICAgICAgIHN0cm9rZS13aWR0aD0nMS41JwogICAgICAgIGQ9Ik0xMSA4aDJNMTAgMTFoNE0yMCAxMHYxYTggOCAwIDEgMS0xNiAwdi0xTTEyIDE5djMiCiAgICAvPgogICAgPHBhdGggc3Ryb2tlPSdjdXJyZW50Y29sb3InIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPScxLjUnIGQ9Ik0yMiAyIDIgMjIiIC8+Cjwvc3ZnPg==", kl = "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlldy1ib3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSI+CiAgICA8cGF0aCBzdHJva2U9ImN1cnJlbnRjb2xvciIgc3Ryb2tlLXdpZHRoPScxLjUnIGQ9Ik03IDhhNSA1IDAgMCAxIDEwIDB2M2E1IDUgMCAwIDEtMTAgMFY4WiIgLz4KICAgIDxwYXRoCiAgICAgICAgc3Ryb2tlPSJjdXJyZW50Y29sb3IiCiAgICAgICAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogICAgICAgIHN0cm9rZS13aWR0aD0nMS41JwogICAgICAgIGQ9Ik0xMSA4aDJNMTAgMTFoNE0yMCAxMHYxYTggOCAwIDEgMS0xNiAwdi0xTTEyIDE5djMiCiAgICAvPgo8L3N2Zz4=", Mn = (t, e) => {
  const n = te(null), r = W(
    (i) => {
      if (!n.current) return;
      i.composedPath().includes(n.current) || (t(i), i.stopPropagation());
    },
    [t]
  );
  return I(() => (e ? window.addEventListener("click", r, { capture: !0 }) : window.removeEventListener("click", r, { capture: !0 }), () => {
    window.removeEventListener("click", r, { capture: !0 });
  }), [e, r]), n;
}, xl = "data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M7%2012.9L10.1429%2016.5L18%207.5'%20stroke='white'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'%20/%3e%3c/svg%3e", Ll = () => /* @__PURE__ */ h(pe, { size: "24px", src: xl }), Il = () => /* @__PURE__ */ h("span", { style: "width:24px;height:24px;" }), Nl = ({ label: t, value: e, selected: n, onClick: r }) => {
  const i = W(() => {
    r(e);
  }, [r, e]);
  return /* @__PURE__ */ h(
    "li",
    {
      className: "didagent__audio__dropdown__item",
      role: "option",
      "aria-selected": n,
      tabIndex: 0,
      onClick: i,
      onKeyDown: (a) => {
        (a.key === "Enter" || a.key === " ") && (a.preventDefault(), i());
      },
      title: t,
      children: [
        n ? /* @__PURE__ */ h(Ll, {}) : /* @__PURE__ */ h(Il, {}),
        /* @__PURE__ */ h("span", { children: t })
      ]
    }
  );
};
function pa({ devices: t, selectedDevice: e, setSelectedDevice: n, header: r }) {
  const i = `${r.toLowerCase()}-list`;
  return /* @__PURE__ */ h("div", { className: "didagent__dropdown__list", role: "group", "aria-labelledby": i, children: [
    /* @__PURE__ */ h("div", { id: i, className: "didagent__audio__dropdown__header", children: r }),
    /* @__PURE__ */ h("ul", { role: "listbox", "aria-labelledby": i, children: t.map(({ label: a, deviceId: o }) => /* @__PURE__ */ h(
      Nl,
      {
        label: a,
        value: o,
        selected: e === o,
        onClick: () => n(o)
      },
      o
    )) })
  ] });
}
function ma() {
  const { inputDevices: t, selectedInputDevice: e, setSelectedInputDevice: n } = ht(), { t: r } = ut();
  return /* @__PURE__ */ h(
    pa,
    {
      devices: t,
      selectedDevice: e,
      setSelectedDevice: n,
      header: r("devices.mic")
    }
  );
}
const Tl = "data:image/svg+xml,%3csvg%20width='16'%20height='16'%20viewBox='0%200%2016%2016'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%20%3e%3cpath%20d='M3.33335%206L8.00002%2010L12.6667%206'%20stroke='white'%20stroke-linecap='round'%20stroke-linejoin='round'%20/%3e%3c/svg%3e", Al = ({ down: t = !1, onClick: e }) => /* @__PURE__ */ h(
  "button",
  {
    className: "didagent__chevron__button",
    onClick: e,
    role: "button",
    "aria-label": t ? "Collapse menu" : "Expand menu",
    "aria-expanded": t,
    children: /* @__PURE__ */ h(
      pe,
      {
        size: "24px",
        className: "didagent__light__opacity__hover " + (t ? "didagent__transform__180 " : ""),
        src: Tl
      }
    )
  }
), _a = ({
  down: t = !1,
  open: e = !1,
  onChevronClick: n,
  controller: r,
  children: i,
  className: a = ""
}) => /* @__PURE__ */ h(
  "div",
  {
    className: "didagent__button didagent__button__dark didagent__audio__selector__container didagent__audio__controller__wrapper " + a,
    children: [
      r,
      /* @__PURE__ */ h("div", { className: "didagent__buttton__vertical__divider" }),
      /* @__PURE__ */ h(Al, { down: t, onClick: n }),
      e && i
    ]
  }
), El = ({ children: t }) => {
  const [e, n] = E(!1), r = Mn(() => n(!1), e), i = W(() => n(!e), [e]);
  return /* @__PURE__ */ h(
    _a,
    {
      className: "didagent__button__extended__controller didagent__mic__selector__container didagent__button__dark",
      controller: t,
      down: e,
      open: e,
      onChevronClick: i,
      children: /* @__PURE__ */ h(
        "div",
        {
          className: "didagent__audio__dropdown__container didagent__audio__mic__dropdown__wrapper",
          role: "listbox",
          "aria-label": "Select microphone",
          ref: r,
          children: /* @__PURE__ */ h("div", { className: "didagent__audio__list__wrapper", children: /* @__PURE__ */ h(ma, {}) })
        }
      )
    }
  );
}, Dl = ({ size: t = "24px", color: e = "#010101" }) => /* @__PURE__ */ h(pe, { size: t, color: e, src: Ml }), va = ({ size: t = "24px", color: e = "#fff" }) => /* @__PURE__ */ h(pe, { size: t, color: e, src: kl }), ui = ({ warning: t, isController: e, classNames: n, muted: r, Icon: i, onClick: a, testId: o = "" }) => /* @__PURE__ */ h(
  fa,
  {
    enabled: !!(e && t),
    content: "Microphone access is blocked. Please enable microphone permissions in your browser settings",
    children: /* @__PURE__ */ h(
      "button",
      {
        className: n,
        role: "button",
        "data-active": r,
        onClick: a,
        "data-testid": o,
        "aria-label": r || t ? "Unmute microphone" : "Mute microphone",
        "aria-pressed": r,
        children: [
          t && e && /* @__PURE__ */ h("span", { className: "didagent__button__badge", children: "!" }),
          /* @__PURE__ */ h(i, { color: e ? r ? "#010101" : "#fff" : "#5C5C5C" })
        ]
      }
    )
  }
);
function wa({ isController: t, setPermissionHelper: e, testId: n = "" }) {
  const { isSmallScreen: r } = He(), { handleMicMute: i, micMuted: a, permissionGranted: o, permissionAsked: s, inputDevices: l } = ht(), c = !o && s, d = a || c ? Dl : va, f = W(() => {
    !o && t ? e(!0) : i();
  }, [o, e, i, t]), p = (l == null ? void 0 : l.length) > 1, u = !(r || !t || c || !p), m = [
    t ? "didagent__button " + (u ? "didagent__button__nested__controller didagent__button__nested__big" : "didagent__button__controller") : "didagent__chat__button",
    c && t ? "didagent__button__warning" : ""
  ].filter(Boolean).join(" ");
  return u ? /* @__PURE__ */ h(El, { children: /* @__PURE__ */ h(
    ui,
    {
      warning: c,
      Icon: d,
      isController: t,
      onClick: f,
      classNames: m,
      muted: a,
      testId: n
    }
  ) }) : /* @__PURE__ */ h(
    ui,
    {
      warning: c,
      Icon: d,
      isController: t,
      onClick: f,
      classNames: (!a && !c && t ? "didagent__button__dark " : "") + m,
      muted: a || c,
      testId: n
    }
  );
}
function Ol({ content: t, display: e }) {
  const [n, r] = E(!1), [i, a] = E("");
  return I(() => {
    if (!e)
      r(!1);
    else {
      r(!0), a("fade-in");
      const o = setTimeout(() => {
        a("fade-out");
        const s = setTimeout(() => r(!1), 500);
        return () => clearTimeout(s);
      }, 3e3);
      return () => clearTimeout(o);
    }
  }, [e]), n ? /* @__PURE__ */ h("div", { className: `didagent__info_message_indication ${i}`, children: [
    /* @__PURE__ */ h(pe, { src: ua, size: "16px" }),
    /* @__PURE__ */ h("pre", { className: "didagent__info_message_agent_unavailable_message", children: t })
  ] }) : null;
}
const Jn = "data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M5.37568%205.46967C5.66857%205.17678%206.14344%205.17678%206.43634%205.46967L11.906%2010.9394L17.3757%205.46972C17.6686%205.17683%2018.1434%205.17683%2018.4363%205.46972C18.7292%205.76261%2018.7292%206.23749%2018.4363%206.53038L12.9667%2012L18.4363%2017.4696C18.7292%2017.7625%2018.7292%2018.2374%2018.4363%2018.5303C18.1434%2018.8232%2017.6685%2018.8232%2017.3756%2018.5303L11.906%2013.0607L6.43639%2018.5303C6.14349%2018.8232%205.66862%2018.8232%205.37573%2018.5303C5.08283%2018.2374%205.08283%2017.7626%205.37573%2017.4697L10.8454%2012L5.37568%206.53033C5.08278%206.23744%205.08278%205.76256%205.37568%205.46967Z'%20fill='white'%20/%3e%3c/svg%3e";
function Pl({ onClick: t }) {
  return /* @__PURE__ */ h("button", { onClick: t, role: "button", "aria-label": "Close chat", className: "didagent__chat__button", children: /* @__PURE__ */ h(pe, { src: Jn, size: "16px", color: "#090604" }) });
}
const Rl = "data:image/svg+xml,%3csvg%20viewBox='0%200%2032%2032'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M16%2024L16%208M16%208L22%2014M16%208L10%2014'%20stroke='white'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e", zl = "data:image/svg+xml,%3csvg%20width='40'%20height='40'%20viewBox='0%200%2040%2040'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M13.3333%2019.9997C13.3333%2016.857%2013.3333%2015.2856%2014.3096%2014.3093C15.2859%2013.333%2016.8572%2013.333%2019.9999%2013.333C23.1426%2013.333%2024.714%2013.333%2025.6903%2014.3093C26.6666%2015.2856%2026.6666%2016.857%2026.6666%2019.9997C26.6666%2023.1424%2026.6666%2024.7137%2025.6903%2025.69C24.714%2026.6663%2023.1426%2026.6663%2019.9999%2026.6663C16.8572%2026.6663%2015.2859%2026.6663%2014.3096%2025.69C13.3333%2024.7137%2013.3333%2023.1424%2013.3333%2019.9997Z'%20fill='white'/%3e%3c/svg%3e", jl = () => /* @__PURE__ */ h(pe, { src: Rl, size: "32px", color: "white" }), Fl = () => /* @__PURE__ */ h(pe, { src: zl, size: "32px", color: "white" });
function $l({ onSend: t, disabled: e, className: n, connectionState: r, canInterrupt: i }) {
  const { isAuthenticated: a } = _e(qt), { agentActivityState: o, interrupt: s, interruptLoading: l } = ze(), { configurations: c } = _e(Re), g = i && c.enableInterruptOption.includes(Ct.Click);
  return a && r === F.Connecting || l ? /* @__PURE__ */ h(
    "button",
    {
      className: "didagaent__send__button didagaent__send__button__loader " + n,
      role: "button",
      disabled: !0,
      "data-testid": "send_loader",
      "aria-label": "Sending message",
      children: /* @__PURE__ */ h(pe, { src: ca, size: "24px", color: "white" })
    }
  ) : g && o !== Qe.Idle ? /* @__PURE__ */ h(
    "button",
    {
      className: ["didagaent__send__button", n].filter(Boolean).join(" "),
      role: "button",
      onClick: () => s({ type: "click" }),
      "data-testid": "stop_text",
      "aria-label": "Stop message",
      children: /* @__PURE__ */ h(Fl, {})
    }
  ) : /* @__PURE__ */ h(
    "button",
    {
      className: ["didagaent__send__button", n].filter(Boolean).join(" "),
      role: "button",
      onClick: t,
      disabled: e,
      "data-testid": "send_text",
      "aria-label": "Send message",
      children: /* @__PURE__ */ h(jl, {})
    }
  );
}
const Bl = "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNCIgaGVpZ2h0PSIxNCIgZmlsbD0ibm9uZSI+CiAgICA8cGF0aAogICAgICAgIGZpbGw9J2N1cnJlbnRjb2xvcicKICAgICAgICBkPSJtMTEuOTg2IDcuMS0uNDEtLjA3MS40MS4wN1ptLS4zOTIgMi4yNjYtLjQxLS4wNy40MS4wN1ptLTcuNDA2IDIuMzQtLjQxNS4wMzYuNDE1LS4wMzZabS0uNDUyLTUuMjE4LjQxNi0uMDM2LS40MTYuMDM2Wm00LjM3Mi0zLjI1Ny40MTEuMDY3LS40MS0uMDY3Wk03Ljc0IDUuNDc4bC40MTEuMDY3LS40MS0uMDY3Wm0tMy42ODUuMjI5LS4yNzItLjMxNi4yNzIuMzE2Wm0uNzk5LS42OS4yNzIuMzE3LS4yNzItLjMxNlptMS4zMjMtMi4wMy0uNDA0LS4xMDQuNDA0LjEwNVpNNi40NCAxLjk3bC40MDMuMTA1LS40MDMtLjEwNVptLjkzLS40OTItLjEyOC4zOTcuMTI4LS4zOTdabS4wOC4wMjYuMTI4LS4zOTctLjEyOC4zOTdaTTUuODEyIDMuOTIxbC4zNjguMTk2LS4zNjgtLjE5NlptMi4yNDYtMS43ODctLjQwMy4xMDUuNDAzLS4xMDVaTTYuODIgMS41MTVsLS4xOC0uMzc1LjE4LjM3NVptLTQuMjggMTAuNzQzLS40MTQuMDM2LjQxNS0uMDM2Wk0yIDYuMDE2bC40MTUtLjAzNmEuNDE3LjQxNyAwIDAgMC0uODMyLjAzNkgyWm05LjU3NiAxLjAxMy0uMzkyIDIuMjY2LjgyLjE0Mi4zOTMtMi4yNjYtLjgyMS0uMTQyWm0tMy44ODQgNS4xMDdINS4xMDl2LjgzM2gyLjU4M3YtLjgzM1ptLTMuMDktLjQ2NS0uNDUtNS4yMTktLjgzLjA3Mi40NSA1LjIxOC44My0uMDcxWm02LjU4Mi0yLjM3NmMtLjI4MiAxLjYyOS0xLjc1IDIuODQtMy40OTIgMi44NHYuODM0YzIuMTI1IDAgMy45NTgtMS40ODMgNC4zMTMtMy41MzJsLS44MjEtLjE0MlpNNy42OTcgMy4xNjQgNy4zMyA1LjQxbC44MjIuMTM0LjM2OC0yLjI0Ny0uODIyLS4xMzRabS0zLjM3IDIuODU4Ljc5OS0uNjg4LS41NDQtLjYzMi0uOC42ODkuNTQ1LjYzMVptMi4yNTMtMi45My4yNjQtMS4wMTgtLjgwNi0uMjEtLjI2NSAxLjAyLjgwNy4yMDlabS42NjMtMS4yMTguMDgxLjAyNi4yNTUtLjc5NC0uMDgtLjAyNi0uMjU2Ljc5NFpNNi4xOCA0LjExN2MuMTczLS4zMjUuMzA4LS42NjguNC0xLjAyNGwtLjgwNy0uMjFhMy44MjEgMy44MjEgMCAwIDEtLjMyOC44NDFsLjczNS4zOTNaTTcuMzI0IDEuOWMuMTcuMDU0LjI5MS4xODYuMzMuMzRsLjgwNy0uMjFhMS4zMjUgMS4zMjUgMCAwIDAtLjg4Mi0uOTI0bC0uMjU1Ljc5NFptLS40OC4xNzRBLjI4Ni4yODYgMCAwIDEgNyAxLjg5bC0uMzYyLS43NWExLjExOSAxLjExOSAwIDAgMC0uNi43MjVsLjgwNi4yMDlaTTcgMS44OWEuMzMxLjMzMSAwIDAgMSAuMjQzLS4wMTZsLjI1NS0uNzk0YTEuMTY0IDEuMTY0IDAgMCAwLS44Ni4wNkw3IDEuODlabTEuMTk2IDQuNTQzaDIuODc5di0uODM0SDguMTk2di44MzRabS01LjI0MSA1Ljc5LS41NC02LjI0My0uODMuMDcyLjU0IDYuMjQyLjgzLS4wNzFabS0uNTM4LjA1OVY2LjAxNmgtLjgzNHY2LjI2NmguODM0Wm0tLjI5Mi4wMTJhLjE0Ni4xNDYgMCAwIDEgLjE0NS0uMTU4di44MzNjLjQwNCAwIC43Mi0uMzQ1LjY4NS0uNzQ2bC0uODMuMDcxWm02LjM5NC04Ljk5NmMuMDctLjQyMi4wNS0uODU0LS4wNTgtMS4yNjhsLS44MDYuMjFjLjA3OC4zMDEuMDkzLjYxNi4wNDIuOTI0bC44MjIuMTM0Wm0tMy40MSA4LjgzOGEuNTA5LjUwOSAwIDAgMS0uNTA2LS40NjVsLS44My4wNzFjLjA2LjY5NC42NCAxLjIyNyAxLjMzNiAxLjIyN3YtLjgzM1ptLjAxNy02LjgwMmMuMzc4LS4zMjYuNzg1LS43MTMgMS4wNTQtMS4yMTdsLS43MzUtLjM5M2MtLjE5My4zNi0uNS42NjUtLjg2My45NzhsLjU0NC42MzJabTcuMjcgMS44MzdhMS4zNDIgMS4zNDIgMCAwIDAtMS4zMjEtMS41NzJ2LjgzNGMuMzE1IDAgLjU1NS4yODQuNS41OTZsLjgyMi4xNDJaTTIuMjcgMTIuMTM2Yy4wODIgMCAuMTQ3LjA2Ni4xNDcuMTQ2aC0uODM0YzAgLjM3OS4zMDcuNjg3LjY4Ny42ODd2LS44MzNaTTcuMzMgNS40MWEuODguODggMCAwIDAgLjg2NyAxLjAyMnYtLjgzNGEuMDQ2LjA0NiAwIDAgMS0uMDQ1LS4wNTRsLS44MjItLjEzNFpNNC4xNTIgNi40NTJhLjUxLjUxIDAgMCAxIC4xNzUtLjQzbC0uNTQ0LS42MzFhMS4zNDMgMS4zNDMgMCAwIDAtLjQ2MiAxLjEzM2wuODMtLjA3MloiCiAgICAvPgo8L3N2Zz4=";
function Ul(t, e, n) {
  return t ? e ? "#CC0037" : "#0D7656" : n ? "#B8B8B8" : "#707070";
}
function hi({ negative: t, toggled: e, onClick: n, disabled: r, ariaHidden: i }) {
  const a = t === !0, o = Ul(e, a, r === !0);
  return /* @__PURE__ */ h(
    "button",
    {
      className: "didagent__thumb__container",
      role: "button",
      "data-active": e,
      style: {
        cursor: r === !0 ? "default" : "pointer",
        transform: a ? "rotate(180deg)" : void 0
      },
      onClick: () => !r && (n == null ? void 0 : n(!e)),
      "aria-label": a ? "Rate negatively" : "Rate positively",
      "aria-pressed": e,
      "aria-hidden": i,
      tabIndex: i ? -1 : 0,
      disabled: r,
      children: /* @__PURE__ */ h(pe, { src: Bl, size: "14px", color: o })
    }
  );
}
const Vl = (t, e) => t === "up" ? e === rt.Positive ? rt.Unrated : rt.Positive : e === rt.Negative ? rt.Unrated : rt.Negative;
function Hl({ className: t, show: e, onRate: n, message: r, style: i, ariaHidden: a }) {
  const [o, s] = E(rt.Unrated), [l, c] = E(), [g, d] = E(!1);
  if (!e)
    return null;
  function f(p) {
    return async () => {
      var y;
      const u = Vl(p, o);
      s(u), d(!0);
      const m = await (n == null ? void 0 : n(u, r, l));
      c(m), (y = window.dataLayer) == null || y.push({
        event: "rated_reply",
        rating: u,
        message: r
      });
    };
  }
  return /* @__PURE__ */ h("div", { className: `${t} didagent__rating`, style: i, children: [
    /* @__PURE__ */ h(
      hi,
      {
        disabled: g,
        toggled: o === rt.Positive,
        onClick: f("up"),
        ariaHidden: a
      }
    ),
    /* @__PURE__ */ h(
      hi,
      {
        disabled: g,
        negative: !0,
        toggled: o === rt.Negative,
        onClick: f("down"),
        ariaHidden: a
      }
    )
  ] });
}
function Zl({
  text: t,
  role: e,
  onTypingStatusChange: n,
  scrollToBottom: r,
  canFeedback: i,
  interrupted: a,
  shouldWaitForAvatar: o
}) {
  const [s, l] = E([]), [c, g] = E(0), [d, f] = E([]), p = te(null);
  return I(() => {
    const u = ml(t);
    f(u.length > 0 ? u : t.split(" "));
  }, [t]), I(() => {
    a && p.current && (clearTimeout(p.current), n("done", e));
  }, [a, n, e]), I(() => {
    const u = c > 0;
    if (c < d.length && !a && (!o || u)) {
      const m = d[c], y = fl(m), C = gl(m);
      return p.current = setTimeout(() => {
        l((v) => [...v, v.length ? " " : "", C]), g((v) => v + 1), r();
      }, y), () => {
        p.current && clearTimeout(p.current);
      };
    }
  }, [c, d, a, o]), I(() => {
    c === 0 ? n("start", e) : c >= d.length && n("done", e);
  }, [c, d]), e === "user" ? /* @__PURE__ */ h("span", { children: t }) : s.length > 0 ? /* @__PURE__ */ h("span", { className: "appear-animation", children: [
    s,
    a && /* @__PURE__ */ h("span", { children: "..." }),
    i ? "           " : ""
  ] }) : /* @__PURE__ */ h("span", { className: "didagent__empty__message" });
}
const Kl = "#b8b8b8", Wl = Cs(
  ({ messages: t, isLoading: e, onRate: n, scrollToBottom: r, onScroll: i, isTextual: a }, o) => {
    const [s, l] = E(!1), { isChatOpen: c } = He(), { agentActivityState: g } = ze();
    I(() => {
      c && r();
    }, [c]);
    const d = W(
      (f, p) => {
        l(f === "start" ? !1 : p === "assistant");
      },
      [l]
    );
    return /* @__PURE__ */ h("div", { className: "didagent__messages__wrapper", ref: o, "data-testid": "didagent_messages", onScroll: i, children: [
      t.filter(({ content: f }) => !!f).map((f, p) => {
        const u = f.role === "user" && new Date(f.created_at || /* @__PURE__ */ new Date()).getTime() > Date.now() - 750, m = [
          "didagent__message__container",
          `didagent__message__container__${f.role}`,
          u ? "didagent__delayed__fade" : ""
        ].join(" "), y = p === t.length - 1, C = f.role === "assistant" && y, v = C && g !== Qe.Talking && !a;
        return e && C ? null : /* @__PURE__ */ h(
          "div",
          {
            className: m,
            role: "article",
            "aria-label": `${f.role === "user" ? "Your message" : "Agent response"}`,
            children: /* @__PURE__ */ h("pre", { className: `didagent__message didagent__message__${f.role}`, children: [
              /* @__PURE__ */ h(
                Zl,
                {
                  text: f.content,
                  role: f.role,
                  onTypingStatusChange: d,
                  scrollToBottom: r,
                  canFeedback: y,
                  interrupted: f.interrupted,
                  shouldWaitForAvatar: v
                },
                f.id
              ),
              p > 0 && f.role === "assistant" && /* @__PURE__ */ h(
                Hl,
                {
                  className: "didagent__message__rating",
                  message: f,
                  show: s,
                  onRate: n,
                  style: { display: y ? "flex" : void 0 },
                  ariaHidden: !c
                }
              )
            ] })
          },
          f.id
        );
      }),
      /* @__PURE__ */ h(
        "div",
        {
          className: [
            "didagent__message__container",
            "didagent__message__container__assistant",
            "didagent__message__container_loader",
            e ? "didagent__message__container__assistant__loading" : ""
          ].join(" "),
          "data-testid": e ? "didagent_message_loader_loading" : "didagent_message_loader_done",
          role: "article",
          "aria-label": "Agent is thinking",
          children: /* @__PURE__ */ h("pre", { className: "didagent__message didagent__message__assistant didagent__message__assistant__loader", children: /* @__PURE__ */ h(pe, { src: da, color: Kl, size: "22px" }) })
        }
      )
    ] });
  }
), gi = ({
  enabled: t,
  text: e,
  setText: n,
  onSend: r,
  messageRef: i,
  textRef: a,
  isTextual: o,
  isActualLoading: s,
  scrollToBottom: l,
  setPermissionHelper: c,
  disableSend: g,
  canInterrupt: d,
  isHistoryMode: f
}) => {
  var U, Z;
  const [p, u] = E(!1), [m, y] = E(0), C = te(!0), { configurations: v } = _e(Re), { connectionState: M, agent: k, messages: L, rate: P, reconnect: A, agentActivityState: _, interrupt: S } = ze(), { chatPosition: w, isHorizontal: b, isChatOpen: z, setIsChatOpen: D, isSmallScreen: q } = He(), { t: V } = ut(), B = d && v.enableInterruptOption.includes(Ct.Text), H = (g || e.trim().length === 0) && !f;
  async function Y(x, R, se) {
    if (!k)
      throw new Error("AgentManager is not available");
    return P(R.id, x === rt.Positive ? 1 : -1, se).then((ge) => ge.id).catch((ge) => {
      throw console.error("Error in rating", ge), new Error("Error in rating " + ge.message);
    });
  }
  const X = Ve(
    () => {
      var x, R;
      return t && !!((R = (x = k == null ? void 0 : k.knowledge) == null ? void 0 : x.embedder) != null && R.is_limited_language);
    },
    [t, k]
  ), K = V(f ? "actions.resume" : "inputs.msgPh");
  return /* @__PURE__ */ h(
    "div",
    {
      className: "didagent__messages__container",
      role: "region",
      "aria-label": "Chat conversation",
      "data-chat": w,
      "data-chatmode": v.chatMode,
      "data-orientation": b ? "horizontal" : "vertical",
      children: [
        w !== "closed-bottom" && w !== "closed-side" && /* @__PURE__ */ h("div", { className: "didagent__messages__header", children: [
          w === "bottom" && /* @__PURE__ */ h(wa, { setPermissionHelper: c }),
          /* @__PURE__ */ h("span", { className: "didagent__messages__header__title", children: V("navigation.chat") }),
          (q || !b) && /* @__PURE__ */ h(Pl, { onClick: () => D(!1) })
        ] }),
        /* @__PURE__ */ h(
          "div",
          {
            className: "didagent__messages__scrollable",
            role: "log",
            "aria-label": "Chat messages",
            "aria-hidden": !z,
            tabIndex: z ? 0 : -1,
            "aria-live": "polite",
            onMouseDown: (x) => x.stopPropagation(),
            onTouchStart: (x) => x.stopPropagation(),
            ref: i,
            onScroll: () => {
              i != null && i.current && (C.current = i.current.scrollHeight - i.current.scrollTop <= i.current.clientHeight + 20);
            },
            children: [
              /* @__PURE__ */ h(
                Wl,
                {
                  messages: L,
                  isLoading: s,
                  onRate: Y,
                  scrollToBottom: l,
                  isTextual: o
                }
              ),
              /* @__PURE__ */ h(
                Ol,
                {
                  display: X,
                  content: `This agent only interacts in ${(Z = (U = k == null ? void 0 : k.presenter) == null ? void 0 : U.voice) == null ? void 0 : Z.language}`
                }
              )
            ]
          }
        ),
        /* @__PURE__ */ h("div", { className: "didagent__messages__footer", children: z && /* @__PURE__ */ h(
          "div",
          {
            className: "didagent__main__input",
            style: {
              height: m > 1 ? "44px" : "26px",
              "--focus": p ? "white" : void 0
            },
            children: [
              /* @__PURE__ */ h(
                "textarea",
                {
                  autoFocus: !0,
                  onMouseDown: (x) => x.stopPropagation(),
                  onTouchStart: (x) => x.stopPropagation(),
                  disabled: [T.Maintenance, T.DirectPlayback].includes(v.chatMode) || v.loaderConfig.show,
                  ref: a,
                  placeholder: K,
                  value: e,
                  maxLength: 790,
                  "aria-label": K,
                  "data-testid": "message_input",
                  onFocus: () => u(!0),
                  onBlur: () => u(!1),
                  onInput: (x) => {
                    y(qc(x.currentTarget)), n(x.currentTarget.value), !f && !o && dr.includes(M) && A();
                  },
                  onKeyPress: async (x) => {
                    if (!x.shiftKey && x.key === "Enter") {
                      if (x.preventDefault(), H)
                        return;
                      B && _ === Qe.Talking && S({ type: "text" }), r(e);
                    }
                  }
                }
              ),
              /* @__PURE__ */ h(
                $l,
                {
                  connectionState: M,
                  onSend: () => r(e),
                  disabled: H,
                  className: "didagent__main__input-send",
                  canInterrupt: d
                }
              )
            ]
          }
        ) })
      ]
    }
  );
}, ya = "data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M18.1967%203C18.6%203%2018.927%203.32696%2018.927%203.73029V7.86141C18.927%208.26474%2018.6%208.5917%2018.1967%208.5917H14.0656C13.6622%208.5917%2013.3353%208.26474%2013.3353%207.86141C13.3353%207.45809%2013.6622%207.13113%2014.0656%207.13113H16.3639C13.5933%204.94701%209.56445%205.13306%207.00822%207.68928C4.25133%2010.4462%204.25133%2014.916%207.00822%2017.6728C9.7651%2020.4297%2014.2349%2020.4297%2016.9918%2017.6728C18.5947%2016.0699%2019.2661%2013.8886%2019.0044%2011.7986C18.9543%2011.3984%2019.2381%2011.0333%2019.6383%2010.9832C20.0385%2010.9331%2020.4036%2011.2169%2020.4537%2011.6171C20.769%2014.1352%2019.9598%2016.7704%2018.0246%2018.7056C14.6973%2022.0329%209.30271%2022.0329%205.97544%2018.7056C2.64816%2015.3783%202.64816%209.98378%205.97544%206.6565C9.1225%203.50944%2014.119%203.33899%2017.4664%206.14516V3.73029C17.4664%203.32696%2017.7934%203%2018.1967%203Z'%20fill='white'%20/%3e%3c/svg%3e", Gl = "data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3ccircle%20cx='12'%20cy='12'%20r='3'%20stroke='white'%20stroke-width='1.5'%20/%3e%3cpath%20d='M13.7654%202.15224C13.3978%202%2012.9319%202%2012%202C11.0681%202%2010.6022%202%2010.2346%202.15224C9.74457%202.35523%209.35522%202.74458%209.15223%203.23463C9.05957%203.45834%209.0233%203.7185%209.00911%204.09799C8.98826%204.65568%208.70226%205.17189%208.21894%205.45093C7.73564%205.72996%207.14559%205.71954%206.65219%205.45876C6.31645%205.2813%206.07301%205.18262%205.83294%205.15102C5.30704%205.08178%204.77518%205.22429%204.35436%205.5472C4.03874%205.78938%203.80577%206.1929%203.33983%206.99993C2.87389%207.80697%202.64092%208.21048%202.58899%208.60491C2.51976%209.1308%202.66227%209.66266%202.98518%2010.0835C3.13256%2010.2756%203.3397%2010.437%203.66119%2010.639C4.1338%2010.936%204.43789%2011.4419%204.43786%2012C4.43783%2012.5581%204.13375%2013.0639%203.66118%2013.3608C3.33965%2013.5629%203.13248%2013.7244%202.98508%2013.9165C2.66217%2014.3373%202.51966%2014.8691%202.5889%2015.395C2.64082%2015.7894%202.87379%2016.193%203.33973%2017C3.80568%2017.807%204.03865%2018.2106%204.35426%2018.4527C4.77508%2018.7756%205.30694%2018.9181%205.83284%2018.8489C6.07289%2018.8173%206.31632%2018.7186%206.65204%2018.5412C7.14547%2018.2804%207.73556%2018.27%208.2189%2018.549C8.70224%2018.8281%208.98826%2019.3443%209.00911%2019.9021C9.02331%2020.2815%209.05957%2020.5417%209.15223%2020.7654C9.35522%2021.2554%209.74457%2021.6448%2010.2346%2021.8478C10.6022%2022%2011.0681%2022%2012%2022C12.9319%2022%2013.3978%2022%2013.7654%2021.8478C14.2554%2021.6448%2014.6448%2021.2554%2014.8477%2020.7654C14.9404%2020.5417%2014.9767%2020.2815%2014.9909%2019.902C15.0117%2019.3443%2015.2977%2018.8281%2015.781%2018.549C16.2643%2018.2699%2016.8544%2018.2804%2017.3479%2018.5412C17.6836%2018.7186%2017.927%2018.8172%2018.167%2018.8488C18.6929%2018.9181%2019.2248%2018.7756%2019.6456%2018.4527C19.9612%2018.2105%2020.1942%2017.807%2020.6601%2016.9999C21.1261%2016.1929%2021.3591%2015.7894%2021.411%2015.395C21.4802%2014.8691%2021.3377%2014.3372%2021.0148%2013.9164C20.8674%2013.7243%2020.6602%2013.5628%2020.3387%2013.3608C19.8662%2013.0639%2019.5621%2012.558%2019.5621%2011.9999C19.5621%2011.4418%2019.8662%2010.9361%2020.3387%2010.6392C20.6603%2010.4371%2020.8675%2010.2757%2021.0149%2010.0835C21.3378%209.66273%2021.4803%209.13087%2021.4111%208.60497C21.3592%208.21055%2021.1262%207.80703%2020.6602%207C20.1943%206.19297%2019.9613%205.78945%2019.6457%205.54727C19.2249%205.22436%2018.693%205.08185%2018.1671%205.15109C17.9271%205.18269%2017.6837%205.28136%2017.3479%205.4588C16.8545%205.71959%2016.2644%205.73002%2015.7811%205.45096C15.2977%205.17191%2015.0117%204.65566%2014.9909%204.09794C14.9767%203.71848%2014.9404%203.45833%2014.8477%203.23463C14.6448%202.74458%2014.2554%202.35523%2013.7654%202.15224Z'%20stroke='white'%20stroke-width='1.5'%20/%3e%3c/svg%3e", ql = "data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M20%2012H4M4%2012L10%206M4%2012L10%2018'%20stroke='white'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'%20/%3e%3c/svg%3e", Yl = "data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%3e%3cpath%20d='M13.0867%2021.3877L13.7321%2021.7697L13.0867%2021.3877ZM13.6288%2020.4718L12.9833%2020.0898L13.6288%2020.4718ZM10.3712%2020.4718L9.72579%2020.8539H9.72579L10.3712%2020.4718ZM10.9133%2021.3877L11.5587%2021.0057L10.9133%2021.3877ZM2.3806%2015.9134L3.07351%2015.6264V15.6264L2.3806%2015.9134ZM7.78958%2018.9915L7.77666%2019.7413L7.78958%2018.9915ZM5.08658%2018.6194L4.79957%2019.3123H4.79957L5.08658%2018.6194ZM21.6194%2015.9134L22.3123%2016.2004V16.2004L21.6194%2015.9134ZM16.2104%2018.9915L16.1975%2018.2416L16.2104%2018.9915ZM18.9134%2018.6194L19.2004%2019.3123H19.2004L18.9134%2018.6194ZM19.6125%202.7368L19.2206%203.37628L19.6125%202.7368ZM21.2632%204.38751L21.9027%203.99563V3.99563L21.2632%204.38751ZM4.38751%202.7368L3.99563%202.09732V2.09732L4.38751%202.7368ZM2.7368%204.38751L2.09732%203.99563H2.09732L2.7368%204.38751ZM9.40279%2019.2098L9.77986%2018.5615L9.77986%2018.5615L9.40279%2019.2098ZM13.7321%2021.7697L14.2742%2020.8539L12.9833%2020.0898L12.4412%2021.0057L13.7321%2021.7697ZM9.72579%2020.8539L10.2679%2021.7697L11.5587%2021.0057L11.0166%2020.0898L9.72579%2020.8539ZM12.4412%2021.0057C12.2485%2021.3313%2011.7515%2021.3313%2011.5587%2021.0057L10.2679%2021.7697C11.0415%2023.0767%2012.9585%2023.0767%2013.7321%2021.7697L12.4412%2021.0057ZM10.5%202.75L13.5%202.75V1.25L10.5%201.25V2.75ZM21.25%2010.5V11.5H22.75V10.5H21.25ZM2.75%2011.5V10.5H1.25L1.25%2011.5H2.75ZM1.25%2011.5C1.25%2012.6546%201.24959%2013.5581%201.29931%2014.2868C1.3495%2015.0223%201.45323%2015.6344%201.68769%2016.2004L3.07351%2015.6264C2.92737%2015.2736%202.84081%2014.8438%202.79584%2014.1847C2.75041%2013.5189%202.75%2012.6751%202.75%2011.5H1.25ZM7.8025%2018.2416C6.54706%2018.2199%205.88923%2018.1401%205.37359%2017.9265L4.79957%2019.3123C5.60454%2019.6457%206.52138%2019.7197%207.77666%2019.7413L7.8025%2018.2416ZM1.68769%2016.2004C2.27128%2017.6093%203.39066%2018.7287%204.79957%2019.3123L5.3736%2017.9265C4.33223%2017.4951%203.50486%2016.6678%203.07351%2015.6264L1.68769%2016.2004ZM21.25%2011.5C21.25%2012.6751%2021.2496%2013.5189%2021.2042%2014.1847C21.1592%2014.8438%2021.0726%2015.2736%2020.9265%2015.6264L22.3123%2016.2004C22.5468%2015.6344%2022.6505%2015.0223%2022.7007%2014.2868C22.7504%2013.5581%2022.75%2012.6546%2022.75%2011.5H21.25ZM16.2233%2019.7413C17.4786%2019.7197%2018.3955%2019.6457%2019.2004%2019.3123L18.6264%2017.9265C18.1108%2018.1401%2017.4529%2018.2199%2016.1975%2018.2416L16.2233%2019.7413ZM20.9265%2015.6264C20.4951%2016.6678%2019.6678%2017.4951%2018.6264%2017.9265L19.2004%2019.3123C20.6093%2018.7287%2021.7287%2017.6093%2022.3123%2016.2004L20.9265%2015.6264ZM13.5%202.75C15.1512%202.75%2016.337%202.75079%2017.2619%202.83873C18.1757%202.92561%2018.7571%203.09223%2019.2206%203.37628L20.0044%202.09732C19.2655%201.64457%2018.4274%201.44279%2017.4039%201.34547C16.3915%201.24921%2015.1222%201.25%2013.5%201.25V2.75ZM22.75%2010.5C22.75%208.87781%2022.7508%207.6085%2022.6545%206.59611C22.5572%205.57256%2022.3554%204.73445%2021.9027%203.99563L20.6237%204.77938C20.9078%205.24291%2021.0744%205.82434%2021.1613%206.73809C21.2492%207.663%2021.25%208.84876%2021.25%2010.5H22.75ZM19.2206%203.37628C19.7925%203.72672%2020.2733%204.20752%2020.6237%204.77938L21.9027%203.99563C21.4286%203.22194%2020.7781%202.57144%2020.0044%202.09732L19.2206%203.37628ZM10.5%201.25C8.87781%201.25%207.6085%201.24921%206.59611%201.34547C5.57256%201.44279%204.73445%201.64457%203.99563%202.09732L4.77938%203.37628C5.24291%203.09223%205.82434%202.92561%206.73809%202.83873C7.663%202.75079%208.84876%202.75%2010.5%202.75V1.25ZM2.75%2010.5C2.75%208.84876%202.75079%207.663%202.83873%206.73809C2.92561%205.82434%203.09223%205.24291%203.37628%204.77938L2.09732%203.99563C1.64457%204.73445%201.44279%205.57256%201.34547%206.59611C1.24921%207.6085%201.25%208.87781%201.25%2010.5H2.75ZM3.99563%202.09732C3.22194%202.57144%202.57144%203.22194%202.09732%203.99563L3.37628%204.77938C3.72672%204.20752%204.20752%203.72672%204.77938%203.37628L3.99563%202.09732ZM11.0166%2020.0898C10.8136%2019.7468%2010.6354%2019.4441%2010.4621%2019.2063C10.2795%2018.9559%2010.0702%2018.7304%209.77986%2018.5615L9.02572%2019.8582C9.07313%2019.8857%209.13772%2019.936%209.24985%2020.0898C9.37122%2020.2564%209.50835%2020.4865%209.72579%2020.8539L11.0166%2020.0898ZM7.77666%2019.7413C8.21575%2019.7489%208.49387%2019.7545%208.70588%2019.7779C8.90399%2019.7999%208.98078%2019.832%209.02572%2019.8582L9.77986%2018.5615C9.4871%2018.3912%209.18246%2018.3215%208.87097%2018.287C8.57339%2018.2541%208.21375%2018.2487%207.8025%2018.2416L7.77666%2019.7413ZM14.2742%2020.8539C14.4916%2020.4865%2014.6287%2020.2564%2014.7501%2020.0898C14.8622%2019.936%2014.9268%2019.8857%2014.9742%2019.8582L14.2201%2018.5615C13.9298%2018.7304%2013.7204%2018.9559%2013.5379%2019.2063C13.3646%2019.4441%2013.1864%2019.7468%2012.9833%2020.0898L14.2742%2020.8539ZM16.1975%2018.2416C15.7862%2018.2487%2015.4266%2018.2541%2015.129%2018.287C14.8175%2018.3215%2014.5129%2018.3912%2014.2201%2018.5615L14.9742%2019.8582C15.0192%2019.832%2015.096%2019.7999%2015.2941%2019.7779C15.5061%2019.7545%2015.7842%2019.7489%2016.2233%2019.7413L16.1975%2018.2416Z'%20fill='white'/%3e%3cpath%20d='M8%209L16%209'%20stroke='white'%20stroke-width='1.5'%20stroke-linecap='round'/%3e%3cpath%20d='M8%2012.5H13.5'%20stroke='white'%20stroke-width='1.5'%20stroke-linecap='round'/%3e%3c/svg%3e", Jl = "data:image/svg+xml,%3csvg%20width='272'%20height='288'%20viewBox='0%200%20272%20288'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20clip-path='url(%23clip0_53680_9844)'%3e%3cmask%20id='path-1-outside-1_53680_9844'%20maskUnits='userSpaceOnUse'%20x='0'%20y='0'%20width='272'%20height='288'%20fill='black'%3e%3crect%20fill='white'%20width='272'%20height='288'%20/%3e%3cpath%20d='M1%2013C1%206.37258%206.37258%201%2013%201H272V288H1V13Z'%20/%3e%3c/mask%3e%3cpath%20d='M1%2013C1%206.37258%206.37258%201%2013%201H272V288H1V13Z'%20fill='%23EBEBEB'%20/%3e%3ccircle%20cx='27'%20cy='21'%20r='6'%20fill='%23FF5E5D'%20/%3e%3ccircle%20cx='27'%20cy='21'%20r='5.75'%20stroke='black'%20stroke-opacity='0.56'%20stroke-width='0.5'%20/%3e%3ccircle%20cx='47'%20cy='21'%20r='6'%20fill='%23FFBC4F'%20/%3e%3ccircle%20cx='47'%20cy='21'%20r='5.75'%20stroke='black'%20stroke-opacity='0.56'%20stroke-width='0.5'%20/%3e%3ccircle%20cx='67'%20cy='21'%20r='6'%20fill='%2322CB58'%20/%3e%3ccircle%20cx='67'%20cy='21'%20r='5.75'%20stroke='black'%20stroke-opacity='0.56'%20stroke-width='0.5'%20/%3e%3crect%20x='1.25'%20y='37.25'%20width='270.5'%20height='0.5'%20stroke='black'%20stroke-width='0.5'%20/%3e%3crect%20x='1.25'%20y='82.25'%20width='270.5'%20height='0.5'%20stroke='black'%20stroke-width='0.5'%20/%3e%3cpath%20d='M41%2060L25%2060M25%2060L31%2054M25%2060L31%2066'%20stroke='%23090604'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'%20/%3e%3cpath%20d='M57%2060L73%2060M73%2060L67%2066M73%2060L67%2054'%20stroke='%23090604'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'%20/%3e%3cpath%20d='M109.364%2056.0512L108.657%2055.3441C105.533%2052.2199%20100.467%2052.2199%2097.3431%2055.3441C94.219%2058.4683%2094.219%2063.5336%2097.3431%2066.6578C100.467%2069.782%20105.533%2069.782%20108.657%2066.6578C110.474%2064.841%20111.234%2062.3677%20110.938%2060.0015M109.364%2056.0512H105.121M109.364%2056.0512V51.8086'%20stroke='%23090604'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'%20/%3e%3crect%20x='126'%20y='48'%20width='187'%20height='27'%20rx='13.5'%20fill='%23CAE6FC'%20/%3e%3cpath%20d='M149.493%2067.204C148.794%2067.204%20148.203%2066.9626%20147.72%2066.4797C147.237%2065.9969%20146.996%2065.4058%20146.996%2064.7065C146.996%2064.0072%20147.237%2063.4161%20147.72%2062.9332C148.203%2062.4504%20148.794%2062.2089%20149.493%2062.2089C150.192%2062.2089%20150.783%2062.4504%20151.266%2062.9332C151.749%2063.4161%20151.991%2064.0072%20151.991%2064.7065C151.991%2065.4058%20151.749%2065.9969%20151.266%2066.4797C150.783%2066.9626%20150.192%2067.204%20149.493%2067.204ZM149.493%2065.872C149.815%2065.872%20150.09%2065.7582%20150.317%2065.5306C150.545%2065.3031%20150.659%2065.0284%20150.659%2064.7065C150.659%2064.3846%20150.545%2064.1098%20150.317%2063.8823C150.09%2063.6547%20149.815%2063.5409%20149.493%2063.5409C149.171%2063.5409%20148.896%2063.6547%20148.669%2063.8823C148.441%2064.1098%20148.328%2064.3846%20148.328%2064.7065C148.328%2065.0284%20148.441%2065.3031%20148.669%2065.5306C148.896%2065.7582%20149.171%2065.872%20149.493%2065.872ZM140.335%2065.3725V64.0405H145.664V65.3725H140.335ZM141.834%2061.2099C141.135%2061.2099%20140.544%2060.9685%20140.061%2060.4856C139.578%2060.0028%20139.336%2059.4117%20139.336%2058.7124C139.336%2058.0131%20139.578%2057.422%20140.061%2056.9391C140.544%2056.4563%20141.135%2056.2148%20141.834%2056.2148C142.533%2056.2148%20143.124%2056.4563%20143.607%2056.9391C144.09%2057.422%20144.331%2058.0131%20144.331%2058.7124C144.331%2059.4117%20144.09%2060.0028%20143.607%2060.4856C143.124%2060.9685%20142.533%2061.2099%20141.834%2061.2099ZM141.834%2059.8779C142.156%2059.8779%20142.431%2059.7641%20142.658%2059.5366C142.886%2059.309%20142.999%2059.0343%20142.999%2058.7124C142.999%2058.3905%20142.886%2058.1157%20142.658%2057.8882C142.431%2057.6606%20142.156%2057.5469%20141.834%2057.5469C141.512%2057.5469%20141.237%2057.6606%20141.01%2057.8882C140.782%2058.1157%20140.668%2058.3905%20140.668%2058.7124C140.668%2059.0343%20140.782%2059.309%20141.01%2059.5366C141.237%2059.7641%20141.512%2059.8779%20141.834%2059.8779ZM145.664%2059.3784V58.0464H150.992V59.3784H145.664Z'%20fill='%23010101'%20/%3e%3cg%20clip-path='url(%23clip1_53680_9844)'%3e%3crect%20x='126'%20y='41'%20width='55'%20height='39'%20rx='19.5'%20fill='%23CAE6FC'%20/%3e%3cpath%20d='M161.325%2071.0558C159.982%2071.0558%20158.847%2070.5921%20157.92%2069.6649C156.992%2068.7377%20156.529%2067.6026%20156.529%2066.2597C156.529%2064.9168%20156.992%2063.7817%20157.92%2062.8545C158.847%2061.9273%20159.982%2061.4637%20161.325%2061.4637C162.668%2061.4637%20163.803%2061.9273%20164.73%2062.8545C165.657%2063.7817%20166.121%2064.9168%20166.121%2066.2597C166.121%2067.6026%20165.657%2068.7377%20164.73%2069.6649C163.803%2070.5921%20162.668%2071.0558%20161.325%2071.0558ZM161.325%2068.4979C161.943%2068.4979%20162.47%2068.2794%20162.907%2067.8424C163.344%2067.4054%20163.563%2066.8779%20163.563%2066.2597C163.563%2065.6415%20163.344%2065.114%20162.907%2064.677C162.47%2064.24%20161.943%2064.0215%20161.325%2064.0215C160.707%2064.0215%20160.179%2064.24%20159.742%2064.677C159.305%2065.114%20159.087%2065.6415%20159.087%2066.2597C159.087%2066.8779%20159.305%2067.4054%20159.742%2067.8424C160.179%2068.2794%20160.707%2068.4979%20161.325%2068.4979ZM143.739%2067.5387V64.9808H153.971V67.5387H143.739ZM146.617%2059.5452C145.274%2059.5452%20144.139%2059.0816%20143.212%2058.1544C142.284%2057.2271%20141.821%2056.0921%20141.821%2054.7492C141.821%2053.4063%20142.284%2052.2712%20143.212%2051.344C144.139%2050.4167%20145.274%2049.9531%20146.617%2049.9531C147.96%2049.9531%20149.095%2050.4167%20150.022%2051.344C150.949%2052.2712%20151.413%2053.4063%20151.413%2054.7492C151.413%2056.0921%20150.949%2057.2271%20150.022%2058.1544C149.095%2059.0816%20147.96%2059.5452%20146.617%2059.5452ZM146.617%2056.9873C147.235%2056.9873%20147.763%2056.7688%20148.2%2056.3319C148.637%2055.8949%20148.855%2055.3673%20148.855%2054.7492C148.855%2054.131%20148.637%2053.6035%20148.2%2053.1665C147.763%2052.7295%20147.235%2052.511%20146.617%2052.511C145.999%2052.511%20145.471%2052.7295%20145.034%2053.1665C144.597%2053.6035%20144.379%2054.131%20144.379%2054.7492C144.379%2055.3673%20144.597%2055.8949%20145.034%2056.3319C145.471%2056.7688%20145.999%2056.9873%20146.617%2056.9873ZM153.971%2056.0281V53.4702H164.202V56.0281H153.971Z'%20fill='%23010101'%20/%3e%3c/g%3e%3cpath%20d='M37.958%20123.457C37.958%20116.741%2044.0208%20111.297%2051.4997%20111.297C58.9785%20111.297%2065.0413%20116.741%2065.0413%20123.457V130.753C65.0413%20137.468%2058.9785%20142.913%2051.4997%20142.913C44.0208%20142.913%2037.958%20137.468%2037.958%20130.753V123.457Z'%20fill='%23FFB074'%20stroke='%23FFB074'%20stroke-width='1.9898'%20/%3e%3cpath%20d='M54.2087%20123.457L65.042%20123.457'%20stroke='%23FFB074'%20stroke-width='1.9898'%20stroke-linecap='round'%20/%3e%3cpath%20d='M54.2087%20130.754L65.042%20130.754'%20stroke='%23FFB074'%20stroke-width='1.9898'%20stroke-linecap='round'%20/%3e%3cpath%20d='M73.1663%20128.316V130.748C73.1663%20141.494%2063.4658%20150.204%2051.4997%20150.204C39.5335%20150.204%2029.833%20141.494%2029.833%20130.748V128.316'%20stroke='%23FFB074'%20stroke-width='1.9898'%20stroke-linecap='round'%20/%3e%3cpath%20d='M51.5%20150.207V157.503'%20stroke='%23FFB074'%20stroke-width='1.9898'%20stroke-linecap='round'%20/%3e%3crect%20x='100'%20y='123.184'%20width='89'%20height='20'%20rx='10'%20fill='white'%20/%3e%3ccircle%20cx='114.75'%20cy='133.551'%20r='17.625'%20fill='%23FFB074'%20stroke='%23010101'%20stroke-width='1.5'%20/%3e%3crect%20x='33'%20y='179.5'%20width='30'%20height='30'%20rx='15'%20fill='%23DBDBDB'%20/%3e%3crect%20x='100'%20y='188.5'%20width='40'%20height='12'%20rx='6'%20fill='%23DBDBDB'%20/%3e%3cg%20opacity='0.3'%3e%3crect%20x='33'%20y='236.5'%20width='30'%20height='30'%20rx='15'%20fill='%23DBDBDB'%20/%3e%3crect%20x='100'%20y='245.5'%20width='40'%20height='12'%20rx='6'%20fill='%23DBDBDB'%20/%3e%3c/g%3e%3crect%20x='120.5'%20y='29.5'%20width='63'%20height='63'%20rx='31.5'%20stroke='black'%20/%3e%3cpath%20d='M180.112%20155.397L200.633%20129.385L232.094%20118.998L161.991%2074.1994L180.112%20155.397Z'%20fill='white'%20stroke='black'%20stroke-width='1.30784'%20/%3e%3c/g%3e%3cpath%20d='M0%2013C0%205.8203%205.8203%200%2013%200H272V2H13C6.92487%202%202%206.92487%202%2013H0ZM272%20288H1H272ZM0%20288V13C0%205.8203%205.8203%200%2013%200V2C6.92487%202%202%206.92487%202%2013V288H0ZM272%201V288V1Z'%20fill='%23010101'%20mask='url(%23path-1-outside-1_53680_9844)'%20/%3e%3cdefs%3e%3cclipPath%20id='clip0_53680_9844'%3e%3cpath%20d='M1%2013C1%206.37258%206.37258%201%2013%201H272V288H1V13Z'%20fill='white'%20/%3e%3c/clipPath%3e%3cclipPath%20id='clip1_53680_9844'%3e%3crect%20width='51'%20height='39'%20fill='white'%20transform='translate(126%2041)'%20/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e", Ql = "data:image/svg+xml,%3csvg%20width='28'%20height='52'%20viewBox='0%200%2028%2052'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3crect%20x='1'%20y='1'%20width='26'%20height='50'%20rx='3'%20stroke='white'%20stroke-width='2'%20/%3e%3cpath%20d='M19.5%2019.9969V22.9969C19.5%2023.1295%2019.4473%2023.2567%2019.3536%2023.3504C19.2598%2023.4442%2019.1326%2023.4969%2019%2023.4969H16C15.8674%2023.4969%2015.7402%2023.4442%2015.6464%2023.3504C15.5527%2023.2567%2015.5%2023.1295%2015.5%2022.9969C15.5%2022.8643%2015.5527%2022.7371%2015.6464%2022.6433C15.7402%2022.5496%2015.8674%2022.4969%2016%2022.4969H17.7931L16.8788%2021.5825C15.9495%2020.649%2014.6878%2020.1223%2013.3706%2020.1181H13.3425C12.0364%2020.1151%2010.7815%2020.6263%209.84938%2021.5412C9.75389%2021.6304%209.62731%2021.6786%209.49672%2021.6756C9.36612%2021.6726%209.24189%2021.6186%209.15059%2021.5252C9.05929%2021.4318%209.00817%2021.3064%209.00818%2021.1757C9.00819%2021.0451%209.05932%2020.9197%209.15063%2020.8262C10.2803%2019.7221%2011.7999%2019.108%2013.3795%2019.1173C14.9592%2019.1265%2016.4714%2019.7583%2017.5881%2020.8756L18.5%2021.79V19.9969C18.5%2019.8643%2018.5527%2019.7371%2018.6464%2019.6433C18.7402%2019.5496%2018.8674%2019.4969%2019%2019.4969C19.1326%2019.4969%2019.2598%2019.5496%2019.3536%2019.6433C19.4473%2019.7371%2019.5%2019.8643%2019.5%2019.9969ZM17.1506%2028.4525C16.2093%2029.372%2014.9434%2029.8834%2013.6275%2029.8756C12.3116%2029.8679%2011.0517%2029.3418%2010.1213%2028.4112L9.20688%2027.4969H11C11.1326%2027.4969%2011.2598%2027.4442%2011.3536%2027.3504C11.4473%2027.2567%2011.5%2027.1295%2011.5%2026.9969C11.5%2026.8643%2011.4473%2026.7371%2011.3536%2026.6433C11.2598%2026.5496%2011.1326%2026.4969%2011%2026.4969H8C7.86739%2026.4969%207.74021%2026.5496%207.64645%2026.6433C7.55268%2026.7371%207.5%2026.8643%207.5%2026.9969L7.5%2029.9969C7.5%2030.1295%207.55268%2030.2567%207.64645%2030.3504C7.74021%2030.4442%207.86739%2030.4969%208%2030.4969C8.13261%2030.4969%208.25979%2030.4442%208.35355%2030.3504C8.44732%2030.2567%208.5%2030.1295%208.5%2029.9969V28.2037L9.41438%2029.1181C10.5295%2030.2389%2012.044%2030.871%2013.625%2030.8756H13.6581C15.2257%2030.8797%2016.7317%2030.266%2017.85%2029.1675C17.9413%2029.0741%2017.9924%2028.9486%2017.9924%2028.818C17.9925%2028.6874%2017.9413%2028.5619%2017.85%2028.4685C17.7587%2028.3751%2017.6345%2028.3211%2017.5039%2028.3181C17.3733%2028.3151%2017.2467%2028.3634%2017.1513%2028.4525H17.1506Z'%20fill='white'%20/%3e%3c/svg%3e", Ca = ({ size: t = "80px", color: e = "#fff" }) => /* @__PURE__ */ h("div", { className: "didagent__loader", style: { "--loader-size": t, "--loader-color": e }, children: /* @__PURE__ */ h("svg", { viewBox: "0 0 100 100", className: "didagent__svg", children: /* @__PURE__ */ h("circle", { className: "didagent__arc", cx: "50", cy: "50", r: "40" }) }) }), ba = (t = "25px") => /* @__PURE__ */ h(va, { size: t, color: "#010101" }), _n = ({
  onClick: t,
  icon: e,
  label: n,
  testId: r = "",
  variant: i = "primary",
  className: a = "",
  width: o,
  disabled: s = !1
}) => {
  const l = te(null);
  return I(() => {
    l.current && o && l.current.style.setProperty("--button-width", `${o}px`);
  }, [o]), /* @__PURE__ */ h(
    "button",
    {
      ref: l,
      onClick: t,
      className: `didagent__intro__button didagent__intro__button__${i} ${a}`,
      role: "button",
      "data-testid": r,
      disabled: s,
      children: [
        e && /* @__PURE__ */ h(e, {}),
        /* @__PURE__ */ h("span", { children: n })
      ]
    }
  );
}, Xl = ({ hideAgentTitle: t, agentIcon: e, agentName: n }) => {
  const { chatPosition: r } = He();
  return t || r === "bottom" ? null : /* @__PURE__ */ h(
    "div",
    {
      "data-testid": "didagent__header__name",
      className: `didagent__header__name ${e ? "" : "didagent__header-bg"}`,
      children: e ? /* @__PURE__ */ h("img", { src: e, alt: "Agent Logo" }) : n
    }
  );
}, Sa = ({ children: t }) => /* @__PURE__ */ h("div", { className: "didagent__intro__footer", children: t }), Yt = ({ children: t = null, isTop: e = !1, className: n = "" }) => /* @__PURE__ */ h("div", { className: `didagent__intro__content ${e ? "didagent__intro__content__top" : ""} ${n}`, children: t }), Tt = ({
  children: t,
  backdrop: e = !1,
  delayed: n = !1,
  bgBlur: r = !1,
  blur: i = !1,
  ariaLabel: a,
  className: o = ""
}) => {
  const s = [
    "didagent__intro",
    e ? "didagent__intro__backdrop" : "",
    r ? "didagent__intro__bgblur" : "",
    n ? "didagent__delayed__fade" : "",
    i ? "didagent__intro__blur" : "",
    o
  ].filter(Boolean).join(" ");
  return /* @__PURE__ */ h("div", { "aria-label": a, className: s, role: "dialog", "aria-modal": "true", children: t });
}, e2 = ({ reconnect: t }) => {
  const { isSmallScreen: e, isChatOpen: n, setIsChatOpen: r } = He(), { triggersAvailable: i, restart: a } = ze(), { trackUi: o } = bt(), { t: s } = ut();
  I(() => {
    i && n && r(!1);
  }, [i, n, r]);
  const l = () => {
    o("agent-reconnect", {
      event: "click",
      action: i ? "new-chat" : "reconnect"
    }), i ? a() : t();
  }, c = s(i ? "actions.newConversation" : "actions.reconnect");
  return /* @__PURE__ */ h(Tt, { backdrop: !0, bgBlur: !0, delayed: !0, ariaLabel: "Reconnect overlay", children: /* @__PURE__ */ h(
    Yt,
    {
      className: `didagent__intro__content__reconnect ${e ? "didagent__intro__content__reconnect__mobile" : ""}`,
      children: [
        /* @__PURE__ */ h("h2", { children: s("prompts.stillHere") }),
        /* @__PURE__ */ h(
          _n,
          {
            onClick: l,
            icon: () => /* @__PURE__ */ h(pe, { size: "25px", color: "#010101", src: ya }),
            label: c
          }
        ),
        !i && /* @__PURE__ */ h(
          _n,
          {
            onClick: () => r((g) => !g),
            icon: () => /* @__PURE__ */ h(pe, { size: "25px", src: Yl }),
            label: s("navigation.chatHistory"),
            className: `didagent__intro__button__chat__history ${n ? "didagent__intro__button__chat__history__active" : ""}`
          }
        )
      ]
    }
  ) });
}, t2 = () => /* @__PURE__ */ h(Tt, { backdrop: !0, bgBlur: !0, ariaLabel: "Mobile Landscape Blocked", children: /* @__PURE__ */ h(Yt, { children: /* @__PURE__ */ h("div", { className: "didagent__mobile__rotate", children: [
  /* @__PURE__ */ h(pe, { src: Ql, size: "44px" }),
  /* @__PURE__ */ h("div", { className: "didagent__mobile__rotate__content", children: [
    /* @__PURE__ */ h("div", { className: "didagent__mobile__rotate__title", children: "Rotate your phone" }),
    /* @__PURE__ */ h("div", { className: "didagent__mobile__rotate__description", children: "Switch to portrait mode for an optimal experience" })
  ] })
] }) }) }), n2 = () => {
  const { configurations: t } = _e(Re), e = t.mode === "fabio", { t: n } = ut();
  return /* @__PURE__ */ h(Tt, { bgBlur: !0, ariaLabel: "Connecting overlay", className: e ? "" : "didagent__connecting__overlay", children: /* @__PURE__ */ h(Yt, { children: [
    /* @__PURE__ */ h(Ca, { size: "60px", color: "#fff" }),
    /* @__PURE__ */ h("span", { className: "didagent__connecting__text", "data-testid": "didagent__connecting__text", children: n("connectionStatus.connecting") })
  ] }) });
}, r2 = ({ requestMicrophoneAccess: t }) => /* @__PURE__ */ h(Tt, { backdrop: !0, delayed: !0, ariaLabel: "Permission request", children: [
  /* @__PURE__ */ h(Yt, { isTop: !0, children: [
    /* @__PURE__ */ h("h2", { children: "Lets get your permission" }),
    /* @__PURE__ */ h("p", { children: "Your browser needs permission to use your microphone." })
  ] }),
  /* @__PURE__ */ h(Sa, { children: /* @__PURE__ */ h(_n, { onClick: t, icon: () => ba("25px"), label: "Turn microphone on" }) })
] }), i2 = ({ startConversation: t, loading: e }) => {
  const { t: n } = ut();
  return /* @__PURE__ */ h(Tt, { ariaLabel: "Welcome message", className: "didagent__start__conversation__overlay", children: [
    /* @__PURE__ */ h(Yt, {}),
    /* @__PURE__ */ h(Sa, { children: /* @__PURE__ */ h(
      _n,
      {
        onClick: t,
        icon: e ? () => /* @__PURE__ */ h(Ca, { size: "20px", color: "#000" }) : () => ba("20px"),
        label: n(e ? "connectionStatus.starting" : "actions.start"),
        testId: "send_record",
        className: "didagent__start__conversation__button",
        width: e ? 130 : 190,
        disabled: e
      }
    ) })
  ] });
}, a2 = ({ setModalOpen: t }) => {
  const { isChatOpen: e } = He();
  return /* @__PURE__ */ h("div", { className: "didagent__mic__permission__container", "data-chat": e, children: [
    /* @__PURE__ */ h(
      "button",
      {
        onClick: () => t(!1),
        className: "didagent__mic__permission__container__close",
        "aria-label": "Close microphone permission help",
        children: /* @__PURE__ */ h(pe, { src: ql, size: "24px", color: "#fff" })
      }
    ),
    /* @__PURE__ */ h("div", { children: [
      /* @__PURE__ */ h("img", { src: Jl, alt: "Microphone permission instructions" }),
      /* @__PURE__ */ h("h3", { children: "We are blocked from using your microphone" }),
      /* @__PURE__ */ h("ol", { children: [
        /* @__PURE__ */ h("li", { children: "Click the page info icon in your browsers address bar" }),
        /* @__PURE__ */ h("li", { children: "Turn on microphone access" })
      ] }),
      /* @__PURE__ */ h("button", { onClick: () => t(!1), children: "Understood" })
    ] })
  ] });
};
function Ma() {
  const { outputDevices: t, selectedOutputDevice: e, setSelectedOutputDevice: n } = ht(), { t: r } = ut();
  return /* @__PURE__ */ h(
    pa,
    {
      devices: t,
      selectedDevice: e,
      setSelectedDevice: n,
      header: r("devices.spk")
    }
  );
}
const o2 = () => /* @__PURE__ */ h(pe, { size: "24px", src: Gl });
function s2() {
  const [t, e] = E(!1), n = Mn(() => e(!1), t), r = W(() => e(!t), [t]), { inputDevices: i, outputDevices: a } = ht(), o = i.length > 1, s = a.length > 1;
  return I(() => {
    const l = (c) => {
      c.key === "Escape" && t && e(!1);
    };
    if (t)
      return document.addEventListener("keydown", l), () => document.removeEventListener("keydown", l);
  }, [t]), !o && !s ? null : /* @__PURE__ */ h(We, { children: [
    /* @__PURE__ */ h(
      "button",
      {
        onClick: r,
        title: "Audio Settings",
        "aria-label": "Audio Settings",
        role: "button",
        "aria-haspopup": "dialog",
        "aria-expanded": t,
        className: "didagent__button didagent__button__header",
        children: /* @__PURE__ */ h(o2, {})
      }
    ),
    t && /* @__PURE__ */ h("div", { className: "didagent__audio__mobile__dropdown__wrapper", children: /* @__PURE__ */ h(Tt, { backdrop: !0, ariaLabel: "Audio Settings", children: /* @__PURE__ */ h(
      "div",
      {
        className: "didagent__audio__mobile__dropdown__container didagent__audio__dropdown__container",
        role: "dialog",
        "aria-labelledby": "audio-settings-title",
        ref: n,
        children: [
          /* @__PURE__ */ h("div", { id: "audio-settings-title", className: "didagent__audio__list__title", children: "Audio Settings" }),
          o && /* @__PURE__ */ h(
            "div",
            {
              className: "didagent__audio__list__wrapper " + (s ? "didagent__audio__dropdown__bottom__spacer" : ""),
              children: /* @__PURE__ */ h(ma, {})
            }
          ),
          s && /* @__PURE__ */ h("div", { className: "didagent__audio__list__wrapper", children: /* @__PURE__ */ h(Ma, {}) })
        ]
      }
    ) }) })
  ] });
}
const c2 = "data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M20.3334%2012.917C20.7476%2012.917%2021.0834%2013.2528%2021.0834%2013.667V13.7225C21.0834%2015.2467%2021.0834%2016.4668%2020.9547%2017.4245C20.8215%2018.4154%2020.5382%2019.2369%2019.8874%2019.8877C19.2367%2020.5384%2018.4151%2020.8217%2017.4243%2020.9549C16.4665%2021.0837%2015.2465%2021.0837%2013.7222%2021.0837H13.6667C13.2525%2021.0837%2012.9167%2020.7479%2012.9167%2020.3337C12.9167%2019.9194%2013.2525%2019.5837%2013.6667%2019.5837C15.2593%2019.5837%2016.3783%2019.5821%2017.2244%2019.4683C18.0489%2019.3575%2018.5012%2019.1526%2018.8268%2018.827C19.1524%2018.5014%2019.3572%2018.0492%2019.4681%2017.2246C19.5818%2016.3785%2019.5834%2015.2595%2019.5834%2013.667C19.5834%2013.2528%2019.9192%2012.917%2020.3334%2012.917Z'%20fill='white'%20/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M3.66675%2012.917C4.08096%2012.917%204.41675%2013.2528%204.41675%2013.667C4.41675%2015.2595%204.41834%2016.3785%204.5321%2017.2246C4.64296%2018.0492%204.84781%2018.5014%205.17339%2018.827C5.49897%2019.1526%205.95123%2019.3575%206.77578%2019.4683C7.6219%2019.5821%208.74086%2019.5837%2010.3334%2019.5837C10.7476%2019.5837%2011.0834%2019.9194%2011.0834%2020.3337C11.0834%2020.7479%2010.7476%2021.0837%2010.3334%2021.0837H10.2779C8.7537%2021.0837%207.53362%2021.0837%206.57591%2020.9549C5.58503%2020.8217%204.76346%2020.5384%204.11273%2019.8877C3.462%2019.2369%203.1787%2018.4154%203.04548%2017.4245C2.91671%2016.4668%202.91673%2015.2467%202.91675%2013.7225C2.91675%2013.704%202.91675%2013.6855%202.91675%2013.667C2.91675%2013.2528%203.25254%2012.917%203.66675%2012.917Z'%20fill='white'%20/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M10.2779%202.91699L10.3334%202.91699C10.7476%202.91699%2011.0834%203.25278%2011.0834%203.66699C11.0834%204.08121%2010.7476%204.41699%2010.3334%204.41699C8.74086%204.41699%207.6219%204.41859%206.77578%204.53234C5.95123%204.6432%205.49897%204.84806%205.17339%205.17363C4.84781%205.49921%204.64296%205.95148%204.5321%206.77602C4.41834%207.62214%204.41675%208.74111%204.41675%2010.3337C4.41675%2010.7479%204.08096%2011.0837%203.66675%2011.0837C3.25254%2011.0837%202.91675%2010.7479%202.91675%2010.3337L2.91675%2010.2782C2.91673%208.75394%202.91671%207.53386%203.04548%206.57615C3.1787%205.58527%203.462%204.76371%204.11273%204.11297C4.76346%203.46224%205.58503%203.17894%206.57591%203.04572C7.53362%202.91696%208.75369%202.91697%2010.2779%202.91699Z'%20fill='white'%20/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M17.2244%204.53234C16.3783%204.41859%2015.2593%204.41699%2013.6667%204.41699C13.2525%204.41699%2012.9167%204.08121%2012.9167%203.66699C12.9167%203.25278%2013.2525%202.91699%2013.6667%202.91699C13.6853%202.91699%2013.7038%202.91699%2013.7222%202.91699C15.2465%202.91697%2016.4665%202.91696%2017.4243%203.04572C18.4151%203.17894%2019.2367%203.46224%2019.8874%204.11297C20.5382%204.76371%2020.8215%205.58527%2020.9547%206.57615C21.0834%207.53386%2021.0834%208.75394%2021.0834%2010.2782V10.3337C21.0834%2010.7479%2020.7476%2011.0837%2020.3334%2011.0837C19.9192%2011.0837%2019.5834%2010.7479%2019.5834%2010.3337C19.5834%208.74111%2019.5818%207.62214%2019.4681%206.77602C19.3572%205.95148%2019.1524%205.49921%2018.8268%205.17363C18.5012%204.84806%2018.0489%204.6432%2017.2244%204.53234Z'%20fill='white'%20/%3e%3c/svg%3e", l2 = "data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M9%2015L2%2022M2%2022H7.85714M2%2022V16.1429'%20stroke='white'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M15%209L22%202M22%202H16.1429M22%202V7.85714'%20stroke='white'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e", d2 = "data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M2%2022L9%2015M9%2015H3.14286M9%2015V20.8571'%20stroke='white'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'%20/%3e%3cpath%20d='M22%202L15%209M15%209H20.8571M15%209V3.14286'%20stroke='white'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'%20/%3e%3c/svg%3e", u2 = () => /* @__PURE__ */ h(pe, { src: c2, size: "24px", color: "#fff" }), h2 = () => /* @__PURE__ */ h(pe, { src: l2, size: "24px", color: "#fff" }), g2 = () => /* @__PURE__ */ h(pe, { src: d2, size: "24px", color: "#fff" });
function fi({ value: t, onClick: e, blurred: n = !1, mode: r = "theater" }) {
  const a = t ? g2 : r === "browser" ? h2 : u2, o = t ? "Exit fullscreen" : "Enter fullscreen";
  return /* @__PURE__ */ h(
    "button",
    {
      className: "didagent__button didagent__button__header didagent__hide__sm didagent__button__dark " + (n ? "didagent__button__blurred" : ""),
      role: "button",
      onClick: () => e(!t),
      "aria-label": o,
      "aria-pressed": t,
      children: /* @__PURE__ */ h(a, {})
    }
  );
}
const f2 = ({ label: t, value: e, onClick: n }) => {
  const r = W(() => {
    n(e);
  }, [n, e]), i = W(
    (a) => {
      (a.key === "Enter" || a.key === " ") && (a.preventDefault(), n(e));
    },
    [n, e]
  );
  return /* @__PURE__ */ h(
    "div",
    {
      className: "didagent__dropdown__item",
      onClick: r,
      onKeyDown: i,
      title: t,
      role: "menuitem",
      tabIndex: 0,
      children: t
    }
  );
};
function p2() {
  var p, u;
  const [t, e] = E(!1), { agent: n, language: r, setLanguage: i, enrichSdkAnalytics: a, setTranslationLanguage: o } = ze(), s = (u = (p = n == null ? void 0 : n.presenter) == null ? void 0 : p.voice) == null ? void 0 : u.language, l = Mn(() => e(!1), t), c = W(() => e(!t), [t]), g = W(
    (m) => {
      i(m), e(!1), o(m);
    },
    [i, o]
  ), d = pn(s), f = Ve(() => d ? r.split("-")[0] : null, [d, r]);
  return I(() => {
    a({ language: f });
  }, [f]), d ? /* @__PURE__ */ h(We, { children: [
    /* @__PURE__ */ h(
      "button",
      {
        onClick: c,
        title: "Select Language",
        className: "didagent__button didagent__button__header didagent__language__button didagent__button__dark",
        role: "button",
        "aria-label": "Select language",
        "aria-haspopup": "true",
        "aria-expanded": t,
        children: f
      }
    ),
    t && /* @__PURE__ */ h("div", { className: "didagent__dropdown__container", ref: l, role: "menu", children: /* @__PURE__ */ h("div", { className: "didagent__dropdown__list", children: [
      /* @__PURE__ */ h("div", { className: "didagent__dropdown__header", children: "Language" }),
      mn.map(({ label: m, value: y }) => /* @__PURE__ */ h(f2, { label: m, value: y, onClick: g }, y))
    ] }) })
  ] }) : null;
}
const m2 = ({ children: t }) => {
  const [e, n] = E(!1), r = W(() => {
    n((a) => !a);
  }, [n]), i = Mn(() => n(!1), e);
  return /* @__PURE__ */ h(
    _a,
    {
      className: "didagent__speaker__selector__container",
      controller: t,
      down: e,
      open: e,
      onChevronClick: r,
      children: /* @__PURE__ */ h(
        "div",
        {
          className: "didagent__audio__dropdown__container didagent__audio__speaker__dropdown__wrapper",
          role: "listbox",
          "aria-label": "Select speaker",
          ref: i,
          children: /* @__PURE__ */ h("div", { className: "didagent__audio__list__wrapper", children: /* @__PURE__ */ h(Ma, {}) })
        }
      )
    }
  );
}, _2 = "data:image/svg+xml,%3csvg%20width='20'%20height='21'%20viewBox='0%200%2020%2021'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M13.5417%2010.2484C13.5417%209.90318%2013.2618%209.62336%2012.9167%209.62336C12.5715%209.62336%2012.2917%209.90318%2012.2917%2010.2484H13.5417ZM5.84683%206.04679L5.9509%206.66307L5.84683%206.04679ZM7.1661%205.43188L6.82206%204.91009L6.82206%204.91009L7.1661%205.43188ZM6.43996%205.86885L6.69231%206.44064L6.43996%205.86885ZM2.78323%2014.184L2.5208%2014.7512L2.78323%2014.184ZM1.27899%2011.1054L0.655149%2011.1434L1.27899%2011.1054ZM1.63212%2013.1009L2.18233%2012.8044L1.63212%2013.1009ZM11.4167%2016.9775L11.2149%2016.3859L11.4167%2016.9775ZM12.8439%2012.4195L13.4683%2012.4485L12.8439%2012.4195ZM11.8997%2016.7317L12.2591%2017.243L11.8997%2016.7317ZM7.34855%205.31159L7.69258%205.83338L7.69258%205.83338L7.34855%205.31159ZM11.4167%203.51926L11.2149%204.11077L11.4167%203.51926ZM11.8997%203.76506L12.2591%203.25371L11.8997%203.76506ZM2.78323%206.31276L2.5208%205.74553L2.78323%206.31276ZM1.27899%209.39136L0.655149%209.35333L1.27899%209.39136ZM1.63212%207.39586L2.18233%207.69232L1.63212%207.39586ZM8.25923%2015.0362C7.97052%2014.847%207.5831%2014.9277%207.39391%2015.2164C7.20472%2015.5051%207.28539%2015.8926%207.57411%2016.0817L8.25923%2015.0362ZM7.51013%205.95367L7.69258%205.83338L7.00451%204.7898L6.82206%204.91009L7.51013%205.95367ZM1.90283%2011.0673C1.88521%2010.7782%201.875%2010.501%201.875%2010.2484H0.625C0.625%2010.533%200.636444%2010.8365%200.655149%2011.1434L1.90283%2011.0673ZM1.875%2010.2484C1.875%209.99567%201.88521%209.71852%201.90283%209.42938L0.655149%209.35333C0.636444%209.66022%200.625%209.96371%200.625%2010.2484H1.875ZM12.2917%2010.2484C12.2917%2010.6748%2012.263%2011.4575%2012.2196%2012.3905L13.4683%2012.4485C13.5114%2011.5194%2013.5417%2010.7084%2013.5417%2010.2484H12.2917ZM5.00007%206.70669C5.40642%206.70669%205.68068%206.7087%205.9509%206.66307L5.74276%205.43052C5.59964%205.45469%205.44717%205.45669%205.00007%205.45669V6.70669ZM6.82206%204.91009C6.4488%205.1562%206.3204%205.23846%206.18761%205.29706L6.69231%206.44064C6.94302%206.32999%207.17089%206.17735%207.51014%205.95367L6.82206%204.91009ZM5.9509%206.66307C6.2063%206.61994%206.45534%206.54522%206.69231%206.44064L6.18761%205.29706C6.04543%205.35981%205.896%205.40464%205.74276%205.43052L5.9509%206.66307ZM5.00007%2015.04C5.44717%2015.04%205.59964%2015.042%205.74276%2015.0662L5.9509%2013.8337C5.68068%2013.788%205.40642%2013.79%205.00007%2013.79V15.04ZM5.00007%2013.79C3.79701%2013.79%203.39093%2013.7765%203.04567%2013.6167L2.5208%2014.7512C3.17442%2015.0536%203.91327%2015.04%205.00007%2015.04V13.79ZM0.655149%2011.1434C0.713737%2012.1046%200.741742%2012.766%201.0819%2013.3973L2.18233%2012.8044C2.00044%2012.4668%201.96704%2012.1208%201.90283%2011.0673L0.655149%2011.1434ZM3.04567%2013.6167C2.71204%2013.4624%202.3567%2013.128%202.18233%2012.8044L1.0819%2013.3973C1.38451%2013.959%201.9418%2014.4833%202.5208%2014.7512L3.04567%2013.6167ZM12.2196%2012.3905C12.1603%2013.6661%2012.1175%2014.5594%2012.0013%2015.2051C11.8855%2015.848%2011.7209%2016.0934%2011.5404%2016.2203L12.2591%2017.243C12.8475%2016.8295%2013.0965%2016.1762%2013.2315%2015.4266C13.3659%2014.68%2013.4107%2013.6874%2013.4683%2012.4485L12.2196%2012.3905ZM11.6186%2017.569C11.8451%2017.4916%2012.0632%2017.3807%2012.2591%2017.243L11.5404%2016.2203C11.4414%2016.2899%2011.3294%2016.3469%2011.2149%2016.3859L11.6186%2017.569ZM7.69258%205.83338C8.76742%205.1247%209.52165%204.62895%2010.1169%204.33981C10.7104%204.05147%2011.0072%204.03991%2011.2149%204.11077L11.6186%202.92775C10.9368%202.69508%2010.259%202.88107%209.57067%203.21546C8.88394%203.54906%208.04882%204.10124%207.00451%204.7898L7.69258%205.83338ZM11.2149%204.11077C11.3294%204.14984%2011.4414%204.20686%2011.5404%204.27642L12.2591%203.25371C12.0632%203.11606%2011.8451%203.00507%2011.6186%202.92775L11.2149%204.11077ZM5.00007%205.45669C3.91327%205.45669%203.17442%205.44313%202.5208%205.74553L3.04567%206.88C3.39093%206.72026%203.79701%206.70669%205.00007%206.70669V5.45669ZM1.90283%209.42938C1.96704%208.37591%202.00044%208.02991%202.18233%207.69232L1.0819%207.0994C0.741742%207.73072%200.713737%208.39208%200.655149%209.35333L1.90283%209.42938ZM2.5208%205.74553C1.9418%206.01341%201.38451%206.53777%201.0819%207.0994L2.18233%207.69232C2.3567%207.36869%202.71204%207.03435%203.04567%206.88L2.5208%205.74553ZM7.57411%2016.0817C8.43976%2016.649%209.15622%2017.1023%209.76703%2017.3725C10.3856%2017.6461%2011.0002%2017.78%2011.6186%2017.569L11.2149%2016.3859C11.027%2016.45%2010.7656%2016.4474%2010.2727%2016.2293C9.77201%2016.0079%209.14153%2015.6144%208.25923%2015.0362L7.57411%2016.0817ZM13.4359%207.36502C13.3854%206.3424%2013.3303%205.50424%2013.1891%204.85648C13.046%204.19945%2012.792%203.62818%2012.2591%203.25371L11.5404%204.27642C11.7036%204.39113%2011.8545%204.60276%2011.9678%205.1226C12.0831%205.65169%2012.1359%206.38434%2012.1874%207.42669L13.4359%207.36502Z'%20fill='%23090604'/%3e%3cpath%20d='M16.6665%2015.2487C16.6665%2015.2487%2017.9165%2013.7487%2017.9165%2010.2487C17.9165%208.22085%2017.4969%206.86438%2017.1439%206.08203'%20stroke='%23090604'%20stroke-width='1.25'%20stroke-linecap='round'/%3e%3cpath%20d='M15%2012.7487C15%2012.7487%2015.4167%2011.9987%2015.4167%2010.2487C15.4167%209.53046%2015.3465%208.98066%2015.2637%208.58203'%20stroke='%23090604'%20stroke-width='1.25'%20stroke-linecap='round'/%3e%3cpath%20d='M18.3332%201.91797L1.6665%2018.5846'%20stroke='%23090604'%20stroke-width='1.25'%20stroke-linecap='round'/%3e%3c/svg%3e", v2 = "data:image/svg+xml,%3csvg%20width='20'%20height='20'%20viewBox='-2%200%2020%2020'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M1.27899%209.14136C1.34039%208.134%201.37109%207.63031%201.63212%207.14586C1.87061%206.70323%202.32692%206.27388%202.78323%206.06276C3.28268%205.83169%203.85514%205.83169%205.00007%205.83169C5.4268%205.83169%205.64016%205.83169%205.84683%205.79679C6.05115%205.76229%206.25039%205.70252%206.43996%205.61885C6.63171%205.53423%206.80984%205.41678%207.1661%205.18188L7.34855%205.06159C9.46769%203.66435%2010.5273%202.96573%2011.4167%203.26926C11.5872%203.32746%2011.7523%203.41146%2011.8997%203.51506C12.6687%204.05544%2012.7271%205.3127%2012.8439%207.8272C12.8872%208.75826%2012.9167%209.55512%2012.9167%209.99836C12.9167%2010.4416%2012.8872%2011.2385%2012.8439%2012.1695C12.7271%2014.684%2012.6687%2015.9413%2011.8997%2016.4817C11.7523%2016.5853%2011.5872%2016.6693%2011.4167%2016.7275C10.5273%2017.031%209.46769%2016.3324%207.34854%2014.9351L7.1661%2014.8148C6.80984%2014.5799%206.63171%2014.4625%206.43996%2014.3779C6.25039%2014.2942%206.05115%2014.2344%205.84683%2014.1999C5.64016%2014.165%205.4268%2014.165%205.00007%2014.165C3.85514%2014.165%203.28268%2014.165%202.78323%2013.934C2.32692%2013.7228%201.87061%2013.2935%201.63212%2012.8509C1.37109%2012.3664%201.34039%2011.8627%201.27899%2010.8554C1.26083%2010.5573%201.25%2010.267%201.25%209.99836C1.25%209.72969%201.26083%209.43937%201.27899%209.14136Z'%20stroke='white'%20stroke-width='1.5'/%3e%3cpath%20d='M15%207.5C15%207.5%2015.4167%208.25%2015.4167%2010C15.4167%2011.75%2015%2012.5%2015%2012.5'%20stroke='white'%20stroke-width='1.5'%20stroke-linecap='round'/%3e%3c/svg%3e", pi = ({ onClick: t, className: e, muted: n, title: r }) => /* @__PURE__ */ h("button", { onClick: t, title: r || "Mute Sound", className: e, "data-active": n, children: /* @__PURE__ */ h(pe, { src: n ? _2 : v2, color: n ? "#090604" : "#fff", size: "24px" }) });
function w2({ show: t }) {
  const { isSmallScreen: e } = He(), { speakerMuted: n, outputDevices: r, setSpeakerMuted: i } = ht();
  if (!t)
    return null;
  const a = (r == null ? void 0 : r.length) > 1, o = () => i((c) => !c), s = a && !e, l = [
    "didagent__button",
    s && "didagent__button__nested__controller",
    !s && !n && "didagent__button__dark"
  ].filter(Boolean).join(" ");
  return s ? /* @__PURE__ */ h(m2, { children: /* @__PURE__ */ h(pi, { onClick: o, className: l, muted: n }) }) : /* @__PURE__ */ h(pi, { onClick: o, className: l, muted: n });
}
function y2({
  displayRestart: t,
  restartDisabled: e,
  isRestarting: n,
  isFullScreen: r,
  showControllers: i,
  blurControllers: a,
  setExpanded: o,
  onClose: s
}) {
  const { restart: l } = ze(), { configurations: c } = _e(Re), { isSmallScreen: g, isBrowserFullscreen: d, expanded: f, handleBrowserFullscreen: p } = He(), u = Lc("full_screen_enabled", !1), m = c.chatMode === T.Playground, y = [T.Playground, T.TextOnly].includes(c.chatMode), C = !u || !d, v = u && !f;
  return /* @__PURE__ */ h("div", { className: "didagent__header", role: "toolbar", "aria-label": "Control header", children: [
    /* @__PURE__ */ h("div", { className: "didagent__header-left", children: i && t && /* @__PURE__ */ h(
      "button",
      {
        onClick: l,
        disabled: e,
        title: "Restart conversation",
        "aria-label": "Restart conversation",
        role: "button",
        className: "didagent__button didagent__button__dark " + (a ? "didagent__button__blurred" : ""),
        children: /* @__PURE__ */ h(
          pe,
          {
            src: ya,
            size: "24px",
            className: n ? "didagent__header__menu__item-rotate" : ""
          }
        )
      }
    ) }),
    /* @__PURE__ */ h("div", { className: "didagent__header-right", children: [
      i && !a && /* @__PURE__ */ h(We, { children: [
        g && !m && /* @__PURE__ */ h(s2, {}),
        /* @__PURE__ */ h(p2, {}),
        !y && /* @__PURE__ */ h(w2, { show: i }),
        c.mode !== "full" && C && /* @__PURE__ */ h(fi, { value: r, onClick: o, blurred: a }),
        v && /* @__PURE__ */ h(
          fi,
          {
            value: d,
            onClick: p,
            blurred: a,
            mode: "browser"
          }
        ),
        !!s && !g && /* @__PURE__ */ h(
          "button",
          {
            onClick: s,
            title: "Close",
            "aria-label": "Close",
            role: "button",
            className: "didagent__button didagent__button__dark",
            children: /* @__PURE__ */ h(pe, { src: Jn, size: "1.5rem", width: "24px" })
          }
        )
      ] }),
      g && !!s && /* @__PURE__ */ h(
        "button",
        {
          onClick: s,
          title: "Close",
          "aria-label": "Close",
          role: "button",
          className: "didagent__button didagent__button__dark",
          children: /* @__PURE__ */ h(pe, { src: Jn, size: "1.5rem", width: "24px" })
        }
      )
    ] })
  ] });
}
function C2(t) {
  return t ? {
    maxHeight: "180px",
    paddingbottom: "8px",
    marginBottom: "-8px"
  } : {
    opacity: "0",
    maxHeight: "0",
    paddingBottom: "0",
    marginBottom: "0",
    pointerEvents: "none"
  };
}
function b2({ messages: t, onClick: e, show: n, enabled: r }) {
  const i = (a) => {
    var o;
    r && e(a), (o = window.dataLayer) == null || o.push({
      event: "clicked_starter_message",
      message: a
    });
  };
  return /* @__PURE__ */ h("div", { className: "didagent__starter_messages__container", style: C2(n), children: t.map(
    (a, o) => o > 4 ? null : /* @__PURE__ */ h(
      "button",
      {
        title: (a == null ? void 0 : a.length) > 25 ? a : void 0,
        className: "didagent__starter_message__container",
        role: "button",
        disabled: !r,
        onClick: () => i(a),
        children: /* @__PURE__ */ h("div", { className: "didagent__starter_message__container_text", children: a })
      },
      o
    )
  ) });
}
const S2 = (t) => {
  t.style.display = "none", t.offsetHeight, t.offsetWidth, t.style.display = "";
};
function M2({ idleVideo: t, isBlur: e, muted: n, onIdleLoad: r, isStreamConnecting: i, enabled: a = !0 }) {
  const { configurations: o } = _e(Re), { connectionState: s, streamState: l, streamType: c, srcObject: g } = ze(), { trackUi: d } = bt(), f = te(null), p = te(null), { selectedOutputDevice: u } = ht(), { chatPosition: m, isHorizontal: y } = He(), [C, v] = E(!1), M = Jc(), k = c !== $e.Legacy || C, L = (c === $e.Fluent ? !i : l === Pe.Streaming) && k && s === F.Connected;
  return I(() => {
    g && p.current && (v(!1), p.current.srcObject = g);
  }, [g, p.current]), I(() => {
    var P;
    p.current && (d("agent-stream-state-change", {
      streamState: Pe[l],
      connectionState: s,
      muted: n,
      "stream-type": c
    }), L ? (M && Qc() && (p.current.volume = 1), (P = p.current) != null && P.paused && p.current.play()) : (f.current && (f.current.currentTime = 0), setTimeout(() => {
      p.current && S2(p.current);
    }, 500)));
  }, [L]), I(() => {
    s === F.Connected && v(!0);
  }, [s]), I(() => {
    var P, A;
    p.current && u && "setSinkId" in p.current && typeof p.current.setSinkId == "function" && ((A = (P = p == null ? void 0 : p.current) == null ? void 0 : P.setSinkId) == null || A.call(P, u).catch((_) => {
      console.error("Error setting audio output device:", u, _);
    }));
  }, [u, l]), /* @__PURE__ */ h(
    "div",
    {
      className: "didagent__embedded__video__container",
      "data-orientation": y ? "horizontal" : "vertical",
      "data-chatmode": o.chatMode,
      "data-chat": m,
      "data-blur": e,
      children: [
        /* @__PURE__ */ h(
          "video",
          {
            className: "didagent__embedded__video__idle",
            "data-testid": "didagent__video_idle",
            "aria-label": "Agent idle video",
            onLoadedData: r,
            poster: a ? o.posterSrc : void 0,
            src: t,
            playsInline: !0,
            autoPlay: !0,
            muted: !0,
            ref: f,
            loop: !0
          }
        ),
        /* @__PURE__ */ h(
          "video",
          {
            className: "didagent__embedded__video__stream",
            "data-testid": "didagent__video_stream",
            "aria-label": "Agent video stream",
            "data-active": L,
            muted: n || !k,
            onPause: (P) => {
              P.currentTarget.play();
            },
            ref: p,
            autoPlay: !0,
            playsInline: !0
          }
        )
      ]
    }
  );
}
function k2({ enabled: t, offline: e, onError: n, onClose: r }) {
  var O;
  const {
    streamedMessage: i,
    streamState: a,
    connectionState: o,
    agent: s,
    srcObject: l,
    messages: c,
    terminating: g,
    errorState: d,
    starterMessages: f,
    setError: p,
    reconnect: u,
    disconnect: m,
    setStreamState: y,
    changeMode: C,
    sendChatMessage: v,
    greeted: M,
    streamType: k,
    agentActivityState: L,
    setAgentActivityState: P,
    interruptAvailable: A,
    fluentStarted: _,
    legacyStarted: S,
    isRestarting: w
  } = ze(), {
    micMuted: b,
    speakerMuted: z,
    conversationStarted: D,
    permissionAsked: q,
    permissionGranted: V,
    startConversation: B,
    requestMicrophoneAccess: H
  } = ht(), {
    expanded: Y,
    isBrowserFullscreen: X,
    wrapperRef: K,
    chatPosition: U,
    isHorizontal: Z,
    isMobileOrientationBlocked: x,
    setIsChatOpen: R,
    setExpanded: se,
    isSmallScreen: ge
  } = He(), { configurations: ee, configure: N } = _e(Re), { isAuthenticated: $ } = _e(qt), { trackUi: J } = bt(), ae = te(null), oe = te(null), ce = te(null), [ye, ke] = E(""), [Ne, Ze] = E(!1), [je, qe] = E(""), [gt, xe] = E(!1), [pt, Xe] = E(!1), et = ee.chatMode === T.Playground, G = ee.chatMode === T.TextOnly || et, { isResponseIdle: le, isResponseDelayed: me, isResponseLoading: fe } = Wc(L), { t: Ce } = ut();
  Hi(Se, [L]), el();
  function Se() {
    setTimeout(() => {
      oe.current && oe.current.scrollTo({ top: oe.current.scrollHeight, behavior: "smooth" });
    }, 0);
  }
  I(() => {
    l && ae.current && (ae.current.srcObject = l);
  }, [l]), I(() => {
    var j;
    L === de.Idle && ((j = ce.current) == null || j.focus());
  }, [L, i]), I(() => {
    (Ne || [T.Maintenance, T.Playground].includes(ee.chatMode)) && N({ loaderConfig: { ...ee.loaderConfig, show: !1 } });
  }, [N, Ne, ee.chatMode]), I(() => {
    ee.chatMode === T.Maintenance && (p(`${(s == null ? void 0 : s.preview_name) || "Agent"} is not available at the moment`), m());
  }, [s, ee.chatMode]), I(() => {
    qe(Ce(Cc[d][di ? Yn.OwnerChat : Yn.EndUser]));
  }, [d, Ce, di]), I(() => {
    o === F.Connecting ? Xe(!0) : _ || S ? Xe(!1) : [F.Connected, F.Connecting].includes(o) || Xe(!1);
  }, [o, _, S]);
  async function De(j) {
    var re;
    if ((re = ce.current) == null || re.blur(), ee.chatMode !== T.Off && (j = j.trim(), j !== "")) {
      if (!G && dr.includes(o) && await u(), !$)
        return J("agent-offline-onsend", { event: "click" }), e == null ? void 0 : e.onSend(ye);
      f && f.indexOf(j) > -1 && J("agent-starter-question", { event: "click", question: j }), ke(""), P(de.Loading);
      try {
        const we = await v(j).catch(async (Ue) => {
          var ie;
          if ((ie = Ue == null ? void 0 : Ue.message) != null && ie.includes("Playground chat limit exceeded"))
            throw new Error("Playground chat limit exceeded");
          return console.error("Error in sending message ", Ue), {
            chatMode: T.Maintenance,
            result: "Sorry, I am not available right now",
            matches: []
          };
        });
        if (we.chatMode && (C(we.chatMode), we.chatMode === T.Maintenance))
          return n == null || n(new Error("Agent is in maintenance mode"), we), m();
        [T.TextOnly, T.Playground].includes(we.chatMode) ? (y(Pe.New), P(de.Idle)) : P(de.Buffering);
      } catch (we) {
        throw y(Pe.New), P(de.Idle), we;
      }
    }
  }
  const Le = W(() => {
    var re, we;
    const j = { opacity: +!!((re = ee.loaderConfig) != null && re.show) };
    if (et && U === "bottom") {
      const Ue = (we = oe.current) == null ? void 0 : we.parentElement, ie = (Ue == null ? void 0 : Ue.getBoundingClientRect().height) ?? 0;
      j.paddingBottom = `${ie}px`;
    }
    return ee.loaderConfig.style === "opaque" ? {
      ...j,
      "--background-color": "var(--did-primary-black-90)"
    } : {
      ...j,
      "--background-color": "var(--did-primary-black-00030)",
      "--backdrop-filter": "blur(4px)"
    };
  }, [ee.loaderConfig, U, et]), Ye = ee.mode === "fabio", tt = [T.Maintenance].includes(ee.chatMode), ct = (s == null ? void 0 : s.preview_name) ?? "Agent", mt = [
    F.Connected,
    F.New,
    F.Disconnected,
    F.Fail
  ].includes(o), Te = x, Ge = !Te && !Ye && !D, Fe = !b && !Te && !Ge && q && V === null, Ae = !Te && !Ge && !Fe && pt, nt = [ue.TrialInsufficientCredits, ue.InsufficientCredits].includes(
    d
  ), Ke = !Te && !Ge && !Fe && o === F.Disconnected && !G && T.Maintenance !== ee.chatMode && !w && !nt, Jt = !M && ![T.Playground, T.TextOnly].includes(ee.chatMode), Qt = A && !Jt && L === de.Talking, Xt = Te || Ae || Ge || Fe || Ke, kn = [
    ue.InsufficientCredits,
    ue.DeletedVoice,
    ue.DeletedAvatar
  ].includes(d), _t = A && ![de.Idle, de.Talking].includes(L) || !G && !kn && !le && !A || Jt || L !== de.Idle && !A || (k === $e.Fluent ? a === Pe.Fail : a !== Pe.New);
  I(() => {
    Ke && U !== "closed-bottom" && U !== "closed-side" && R(!1);
  }, [Ke, R]), I(() => {
    o === F.Closed && R(!1);
  }, [o]), I(() => {
    var j;
    U !== "closed-bottom" && U !== "closed-side" && ((j = ce == null ? void 0 : ce.current) == null || j.focus());
  }, [U]);
  const en = et || (O = s == null ? void 0 : s.presenter) == null ? void 0 : O.idle_video;
  return /* @__PURE__ */ h(We, { children: [
    Y && !X && /* @__PURE__ */ h("div", { className: "didagent__backdrop" }),
    /* @__PURE__ */ h(
      "div",
      {
        className: "didagent__main__wrapper",
        role: "application",
        "aria-label": "AI Agent Video Chat",
        "data-expanded": Y && !X,
        "data-chatmode": ee.chatMode,
        "data-orientation": Z ? "horizontal" : "vertical",
        ref: K,
        children: [
          U.includes("side") && /* @__PURE__ */ h(
            gi,
            {
              enabled: t,
              text: ye,
              setText: ke,
              onSend: De,
              messageRef: oe,
              textRef: ce,
              isTextual: G,
              isActualLoading: me || fe,
              scrollToBottom: Se,
              setPermissionHelper: xe,
              disableSend: _t,
              canInterrupt: Qt,
              isHistoryMode: Ke
            }
          ),
          /* @__PURE__ */ h(
            "div",
            {
              className: "didagent__embedded__container",
              "data-chat": U,
              "data-orientation": Z ? "horizontal" : "vertical",
              children: [
                /* @__PURE__ */ h("div", { className: "didagent__embedded__container__loading", style: Le(), children: [
                  /* @__PURE__ */ h(
                    pe,
                    {
                      src: ca,
                      size: "64px",
                      color: "var(--did-secondary-60)",
                      className: "didagent__embedded__loader"
                    }
                  ),
                  /* @__PURE__ */ h("span", { children: ee.loaderConfig.text || "" })
                ] }),
                ee.posterSrc && /* @__PURE__ */ h("img", { className: "didagent__background", src: ee.posterSrc, alt: "" }),
                /* @__PURE__ */ h(
                  M2,
                  {
                    idleVideo: en,
                    muted: z,
                    isBlur: ee.chatMode === T.Maintenance,
                    onIdleLoad: () => Ze(!0),
                    isStreamConnecting: pt
                  }
                ),
                /* @__PURE__ */ h(
                  y2,
                  {
                    isFullScreen: Y || X,
                    setExpanded: se,
                    displayRestart: c.length > 1 || ee.chatMode === T.Maintenance,
                    restartDisabled: !mt,
                    isRestarting: g,
                    showControllers: Ke || !Xt,
                    blurControllers: Ke,
                    onClose: r
                  }
                ),
                /* @__PURE__ */ h(ul, { hide: d === ue.NoError || !je, content: je }),
                /* @__PURE__ */ h("div", { className: "didagent__filler" }),
                /* @__PURE__ */ h(Xl, { hideAgentTitle: tt, agentIcon: s == null ? void 0 : s.logo, agentName: ct }),
                gt && /* @__PURE__ */ h(a2, { setModalOpen: xe }),
                (o !== F.Connected && o !== F.Disconnected || Ae) && !Ye && /* @__PURE__ */ h(i2, { startConversation: B, loading: Ae }),
                Ae && /* @__PURE__ */ h(n2, {}),
                Fe && /* @__PURE__ */ h(r2, { requestMicrophoneAccess: H }),
                Ke && /* @__PURE__ */ h(e2, { reconnect: u }),
                Te && /* @__PURE__ */ h(t2, {}),
                !Xt && ee.chatMode !== T.Maintenance && /* @__PURE__ */ h(We, { children: [
                  /* @__PURE__ */ h(
                    b2,
                    {
                      show: c.length <= 1 && !ee.loaderConfig.show,
                      enabled: !_t,
                      messages: f ?? [],
                      onClick: De
                    }
                  ),
                  /* @__PURE__ */ h(
                    "div",
                    {
                      className: "didagent__main__container",
                      role: "navigation",
                      "aria-label": "Main controls",
                      "data-orientation": Z ? "horizontal" : "vertical",
                      "data-chat": U,
                      children: [
                        ee.showMicToggle && /* @__PURE__ */ h(
                          wa,
                          {
                            isController: !0,
                            setPermissionHelper: xe,
                            testId: "mic_on_off"
                          }
                        ),
                        /* @__PURE__ */ h(
                          dl,
                          {
                            isDelayed: me,
                            isLoading: fe,
                            isPlaying: L === de.Talking,
                            isIdle: L === de.Idle,
                            isTextual: G,
                            onSend: De,
                            disableSend: _t
                          }
                        ),
                        ee.showChatToggle && /* @__PURE__ */ h(Sl, {})
                      ]
                    }
                  )
                ] }),
                U.includes("bottom") && /* @__PURE__ */ h(
                  gi,
                  {
                    enabled: t,
                    text: ye,
                    setText: ke,
                    onSend: De,
                    messageRef: oe,
                    textRef: ce,
                    isTextual: G,
                    isActualLoading: me || fe,
                    scrollToBottom: Se,
                    setPermissionHelper: xe,
                    disableSend: _t,
                    canInterrupt: Qt,
                    isHistoryMode: Ke
                  }
                )
              ]
            }
          )
        ]
      }
    )
  ] });
}
function ka({
  offline: t,
  isOwner: e,
  didApiUrl: n,
  didSocketApiUrl: r,
  customMixpanelKey: i,
  enabled: a = !0,
  onAgentReady: o,
  onError: s,
  onClose: l
}) {
  const { configurations: c } = _e(Re);
  return window.localStorage.setItem("track_enabled", (c.track ?? !0).toString()), $n.mixpanelKey = i || $n.mixpanelKey, _s((g) => s == null ? void 0 : s(g, {})), /* @__PURE__ */ h(ln, { fallback: null, children: /* @__PURE__ */ h(
    Tc,
    {
      auth: c.auth,
      didApiUrl: n ?? $o,
      didSocketApiUrl: r ?? Bo,
      children: /* @__PURE__ */ h(
        Pc,
        {
          agentId: c.agentId,
          enabled: a,
          onAgentReady: o,
          onError: s,
          children: /* @__PURE__ */ h(zc, { children: /* @__PURE__ */ h(Kc, { children: /* @__PURE__ */ h(
            k2,
            {
              enabled: a,
              offline: t,
              isOwner: e,
              onError: s,
              onClose: l
            }
          ) }) })
        }
      )
    }
  ) });
}
const x2 = 400, Qn = 330, xa = 640, vn = 2, La = (t) => t ? 16 / 9 : 2 / 3.3, Xn = (t, e) => e ? t >= 1440 ? 984 : t >= 1280 ? 752 : 656 : xa, L2 = (t, e) => {
  const n = La(t);
  let r;
  t ? r = Xn(window.innerWidth, e) : r = Qn;
  const i = t ? r / n : Qn / n;
  return { width: r, height: i };
}, I2 = (t, e, n) => {
  if (t.useTargetElementPosition) {
    const o = t.targetElement.getBoundingClientRect();
    return {
      x: t.position === "left" ? o.x - e : o.x,
      y: o.y - n
    };
  }
  const r = window.innerHeight * vn / 100, i = window.innerHeight * vn / 100;
  return {
    x: t.position === "right" ? window.innerWidth - e - i : i,
    y: window.innerHeight - n - r
  };
}, zt = (t, e, n) => {
  const r = L2(e, n);
  return { position: I2(t, r.width, r.height), size: r };
}, N2 = (t, e) => {
  if (t.useTargetElementPosition) {
    const r = t.targetElement.getBoundingClientRect(), i = e.getBoundingClientRect();
    return {
      left: t.position === "left" ? r.x - i.width : r.x,
      top: r.top - i.height
    };
  }
  return null;
}, T2 = ({ children: t, show: e }) => {
  const n = te(!1), { configurations: r } = _e(Re), { expanded: i, wrapperRef: a, chatPosition: o, isSmallScreen: s, updateLayout: l, isChatOpen: c } = He(), g = Ve(() => !i && !s, [i, s]), d = r.orientation === "horizontal" && g, f = La(d), p = te(c), { enrichSdkAnalytics: u } = ze();
  I(() => {
    p.current = c;
  }, [c]);
  const [m, y] = E(zt(r, d, c).position), [C, v] = E(zt(r, d, c).size), M = te(m), k = te(C);
  I(() => {
    M.current = m;
  }, [m]), I(() => {
    k.current = C;
  }, [C]);
  const L = (w, b, z = window.innerWidth) => {
    let D;
    const q = z;
    return r.orientation === "vertical" ? D = Qn : D = Xn(z, p.current), w = Math.max(w, D), w = Math.min(w, q), d ? b = w / f : b = Math.max(b, x2), { width: w, height: b };
  };
  I(() => (n.current = !0, () => {
    n.current = !1;
  }), []);
  const P = (w, b, z, D, q = !1) => {
    let V = 0, B = 0, H = Math.max(window.innerWidth - z, 0), Y = Math.max(window.innerHeight - D, 0);
    if (q) {
      const X = window.innerHeight * vn / 100, K = window.innerHeight * vn / 100;
      V = X, H = Math.max(window.innerWidth - z - X, V), B = K, Y = Math.max(window.innerHeight - D - K, B);
    }
    return {
      x: Math.min(Math.max(0, w), H),
      y: Math.min(Math.max(0, b), Y)
    };
  }, A = W(() => {
    const w = zt(r, d, c);
    y(w.position), v(w.size);
  }, [zt]);
  I(() => {
    e && !i && !s && A();
  }, [r.position, e, i, s, A]), I(() => {
    const w = () => {
      var V, B;
      const b = (B = (V = a == null ? void 0 : a.current) == null ? void 0 : V.getBoundingClientRect) == null ? void 0 : B.call(V);
      if (!b) return;
      const { width: z, height: D } = L(b.width, b.height, window.innerWidth), q = P(M.current.x, M.current.y, z, D);
      v({ width: z, height: D }), k.current = { width: z, height: D }, y(q), M.current = q;
    };
    return window.addEventListener("resize", w), () => window.removeEventListener("resize", w);
  }, [a, r.orientation, c]);
  const _ = W(
    (w) => {
      const b = w.target;
      if (!(a != null && a.current)) return;
      const z = b.classList.contains("didagent__resize__handle"), D = w.clientX, q = w.clientY, V = { x: M.current.x, y: M.current.y }, B = { width: k.current.width, height: k.current.height }, H = (X) => {
        const K = X.clientX - D, U = X.clientY - q;
        let Z = B.width, x = B.height;
        const R = { ...V };
        if (z) {
          switch (b.dataset.edge || "bottom-right") {
            case "right":
              Z = B.width + K, x = Z / f;
              break;
            case "left":
              Z = B.width - K, R.x = V.x + K, x = Z / f;
              break;
            case "bottom":
              x = B.height + U, Z = x * f;
              break;
            case "top":
              x = B.height - U, R.y = V.y + U, Z = x * f;
              break;
            case "bottom-right":
              Z = B.width + K, x = Z / f;
              break;
            case "bottom-left":
              Z = B.width - K, R.x = V.x + K, x = Z / f;
              break;
            case "top-right":
              Z = B.width + K, x = Z / f, R.y = V.y + U;
              break;
            case "top-left":
              Z = B.width - K, R.x = V.x + K, R.y = V.y + U, x = Z / f;
              break;
          }
          const ge = L(Z, x), ee = P(
            R.x,
            R.y,
            ge.width,
            ge.height
          );
          v(ge), k.current = ge, y(ee), M.current = ee;
        } else {
          const se = V.x + K, ge = V.y + U, ee = P(se, ge, B.width, B.height);
          y(ee), M.current = ee;
        }
      }, Y = () => {
        l(), window.removeEventListener("mousemove", H), window.removeEventListener("mouseup", Y), u({
          agents_component_size: `${k.current.width}x${k.current.height}`,
          window_size: `${window.innerWidth}x${window.innerHeight}`
        });
      };
      window.addEventListener("mousemove", H), window.addEventListener("mouseup", Y);
    },
    [a, r.orientation, l]
  );
  I(() => {
    if (g && (a != null && a.current))
      return a.current.addEventListener("mousedown", _), () => a.current.removeEventListener("mousedown", _);
  }, [g, _, a]);
  const S = Ve(() => {
    const w = {};
    return g && (w.position = "fixed", w.left = `${m.x}px`, w.top = `${m.y}px`, w.zIndex = 999999, w.width = `${C.width}px`, w.height = `${C.height}px`), w;
  }, [g, m, C]);
  return I(() => {
    if (r.orientation === "horizontal") {
      const w = k.current.width || xa, b = window.innerWidth, z = Xn(b, c);
      if (w !== z) {
        const D = z, q = D / f, V = { width: D, height: q };
        let B = M.current.x;
        D > w && (B = M.current.x + w / 2 - D / 2);
        const H = P(B, M.current.y, D, q, !0);
        v(V), k.current = V, y(H), M.current = H;
      }
      l();
    }
  }, [c, r.orientation, f, l]), I(() => {
    const w = () => {
      var D, q;
      if (!(a != null && a.current)) return;
      const z = (q = (D = a.current).getBoundingClientRect) == null ? void 0 : q.call(D);
      if (z)
        if (c) {
          const { width: V, height: B } = L(z.width, z.height), H = P(M.current.x, M.current.y, V, B);
          v({ width: V, height: B }), k.current = { width: V, height: B }, y(H), M.current = H;
        } else {
          const V = zt(r, d, c);
          v(V.size), k.current = V.size, y(V.position), M.current = V.position;
        }
    }, b = () => {
      w();
    };
    return window.addEventListener("resize", b), w(), () => {
      window.removeEventListener("resize", b);
    };
  }, [c, r.orientation]), I(() => {
    e || setTimeout(() => {
      n.current && A();
    }, 500);
  }, [e, A]), I(() => {
    s || A();
  }, [s]), /* @__PURE__ */ h(
    "div",
    {
      className: "didagent__fabio__container " + (g ? " didagent__draggable__resizable" : ""),
      "data-dragged": g,
      "data-enabled": e,
      "data-position": r.position,
      "data-chat": o,
      "data-orientation": r.orientation,
      ref: a,
      style: S,
      children: [
        t,
        g && /* @__PURE__ */ h(We, { children: [
          /* @__PURE__ */ h("div", { className: "didagent__resize__handle top-left", "data-edge": "top-left" }),
          /* @__PURE__ */ h("div", { className: "didagent__resize__handle top-right", "data-edge": "top-right" }),
          /* @__PURE__ */ h("div", { className: "didagent__resize__handle bottom-left", "data-edge": "bottom-left" }),
          /* @__PURE__ */ h("div", { className: "didagent__resize__handle bottom-right", "data-edge": "bottom-right" }),
          /* @__PURE__ */ h("div", { className: "didagent__resize__handle left", "data-edge": "left" }),
          /* @__PURE__ */ h("div", { className: "didagent__resize__handle right", "data-edge": "right" }),
          /* @__PURE__ */ h("div", { className: "didagent__resize__handle top", "data-edge": "top" }),
          /* @__PURE__ */ h("div", { className: "didagent__resize__handle bottom", "data-edge": "bottom" })
        ] })
      ]
    }
  );
};
function A2(t, e) {
  return {
    cursor: t ? "pointer" : "progress",
    opacity: e || !t ? "0" : "1",
    pointerEvents: e || !t ? "none" : "auto",
    border: "none"
  };
}
function E2(t) {
  var v;
  const [e, n] = E(), [r, i] = E(!1), { configurations: a } = _e(Re), { trackUi: o } = bt(), { opened: s, setOpened: l, setIsChatOpen: c, setExpanded: g } = He(), [d, f] = E(!s), p = te(null), u = p.current ? N2(a, p.current) : null;
  if (I(() => {
    s && f(!1);
  }, [s]), I(() => {
    var M;
    e && !((M = e.presenter) != null && M.idle_video) && e.preview_thumbnail && i(!0);
  }, [e]), !a.visible)
    return null;
  const m = (M) => {
    n(M);
  }, y = () => {
    var M;
    l(!1), setTimeout(() => {
      c(!1), g(!1);
    }, 500), (M = window.dataLayer) == null || M.push({ event: "close_widget" });
  }, C = (e == null ? void 0 : e.preview_url) ?? ((v = e == null ? void 0 : e.presenter) == null ? void 0 : v.idle_video);
  return /* @__PURE__ */ h(
    "span",
    {
      ref: p,
      className: "didagent__fabio",
      "data-position": u ? "" : a.position,
      "data-enabled": s,
      style: u ? { left: `${u.left}px`, top: `${u.top}px` } : {},
      children: [
        /* @__PURE__ */ h(
          "button",
          {
            "data-testid": "didagent__fabio__button",
            style: A2(r, s),
            onClick: () => {
              var M;
              (M = window.dataLayer) == null || M.push({ event: "open_widget" }), r && (o("agent-fab", { event: "click" }), l(!0));
            },
            "aria-label": "Open video chat",
            "aria-hidden": s,
            tabIndex: s ? -1 : 0,
            children: [
              d && /* @__PURE__ */ h("span", { className: "didagent__fabio__notification", children: "1" }),
              /* @__PURE__ */ h(
                "video",
                {
                  src: C,
                  poster: C || e == null ? void 0 : e.preview_thumbnail,
                  "aria-label": "toggle fabio",
                  autoPlay: !0,
                  playsInline: !0,
                  loop: !0,
                  muted: !0,
                  style: { WebkitUserSelect: "none" },
                  disableRemotePlayback: !0,
                  onLoadedData: () => {
                    i(!0), o("agent-fab", { event: "view" });
                  }
                }
              )
            ]
          }
        ),
        /* @__PURE__ */ h(T2, { show: s, children: /* @__PURE__ */ h(ka, { ...t, enabled: s, onAgentReady: m, onClose: y }) })
      ]
    }
  );
}
let Dn = [];
function D2() {
  if (Dn.length === 0) {
    const t = document.getElementById("d-id-agent-style");
    Dn = t ? [t] : [];
  }
  return Dn;
}
function O2(t) {
  const e = te(null), { configurations: n } = _e(Re), [r, i] = E();
  return I(() => {
    const a = D2();
    if (n.agentId) {
      if (!n.auth)
        throw new Error("No auth provider");
    } else throw new Error("No agent provider");
    if (n.mode === "fabio") {
      if (e.current) {
        const o = e.current.shadowRoot ? e.current.shadowRoot : e.current.attachShadow({ mode: "open" });
        a.forEach((s) => o.appendChild(s)), i(Xr(/* @__PURE__ */ h(E2, { ...t }), o));
      }
    } else if (n.mode === "full") {
      const o = typeof n.targetElement == "string" ? document.getElementById(n.targetElement) : n.targetElement;
      if (n.targetElement) {
        if (!o)
          throw new Error(`No target element for id: ${n.targetElement}`);
      } else throw new Error("No target element id");
      const s = o.shadowRoot ? o.shadowRoot : o.attachShadow({ mode: "open" });
      a.forEach((l) => s.appendChild(l)), i(Xr(/* @__PURE__ */ h(ka, { ...t }), s));
    } else
      throw new Error("Invalid mode");
  }, [n.mode, n.targetElement, n.agentId, n.auth]), /* @__PURE__ */ h(We, { children: [
    /* @__PURE__ */ h("div", { ref: e, "data-testid": "didagent_root" }),
    r
  ] });
}
function Ia(t) {
  "requestIdleCallback" in window ? requestIdleCallback(t, { timeout: 2e3 }) : setTimeout(t, 0);
}
const P2 = async () => {
  if (window.DD_RUM)
    return;
  const { datadogRum: t } = await import("./main-D6iamsOH.js").then((e) => e.a2);
  t.init({
    applicationId: Uo,
    clientToken: Vo,
    site: "us3.datadoghq.com",
    service: "agents-ui",
    env: xi,
    sessionSampleRate: 100,
    sessionReplaySampleRate: 0,
    defaultPrivacyLevel: "mask-user-input",
    trackResources: !0,
    trackLongTasks: !0,
    trackUserInteractions: !0,
    enablePrivacyForActionName: !0
  });
}, R2 = (t) => {
  t && Ia(() => P2());
};
function z2() {
  const t = document.querySelector('link[href="https://fonts.googleapis.com"]'), e = document.querySelector('link[href="https://fonts.gstatic.com"]');
  if (!t) {
    const n = document.createElement("link");
    n.rel = "preconnect", n.href = "https://fonts.googleapis.com", document.head.appendChild(n);
  }
  if (!e) {
    const n = document.createElement("link");
    n.rel = "preconnect", n.href = "https://fonts.gstatic.com", n.crossOrigin = "anonymous", document.head.appendChild(n);
  }
}
function j2() {
  const t = document.createElement("link");
  t.href = "https://fonts.googleapis.com/css2?family=Inter:wght@400..700&display=swap", t.rel = "stylesheet", t.media = "print", t.onload = () => {
    t.media = "all";
  }, document.head.appendChild(t);
}
function F2() {
  const t = document.createElement("link");
  t.href = "https://fonts.googleapis.com/css2?family=Manrope:wght@400..700&display=swap", t.rel = "stylesheet", t.media = "print", t.onload = () => {
    t.media = "all";
  }, document.head.appendChild(t);
}
function $2() {
  z2(), Ia(() => {
    j2(), F2();
  });
}
function mi(t) {
  window.DID_AGENTS_API = {
    callbacks: t.callbacks,
    functions: {},
    events: {
      on: xt.on,
      off: xt.off
    }
  }, window.dataLayer = window.dataLayer || [], $2();
  const {
    onError: e,
    isOwner: n,
    enabled: r,
    didSocketApiUrl: i,
    didApiUrl: a,
    customMixpanelKey: o,
    offline: s,
    monitor: l = !0,
    enableFeatureFlags: c = !0,
    ...g
  } = t;
  if (R2(l), g.mode === "full" && g.orientation !== "vertical" && (g.orientation = "vertical"), !t.targetElement && g.mode === "full")
    throw new Error("No target element provided for full mode");
  if (g.agentId) {
    if (!g.auth)
      throw new Error("No auth provider");
  } else throw new Error("No agent provider ");
  const d = typeof t.targetElement == "string" ? document.getElementById(t.targetElement) : t.targetElement, f = document.createElement("div");
  f.className = "didagent_target", document.body.appendChild(f);
  const p = (y, C) => {
    var v;
    (v = window.DD_RUM) == null || v.addError(y, C), e == null || e(y, C);
  }, u = setInterval(() => {
    d && !document.body.contains(d) && (Ft(null, f), f.remove(), clearInterval(u));
  }, 2e3);
  Ft(
    /* @__PURE__ */ h(We, { children: /* @__PURE__ */ h(_c, { children: /* @__PURE__ */ h(kc, { enableFeatureFlags: c, children: /* @__PURE__ */ h(vc, { initialConfigurations: { ...g, targetElement: d }, children: /* @__PURE__ */ h(Rc, { children: /* @__PURE__ */ h(
      O2,
      {
        isOwner: n,
        offline: s,
        didApiUrl: a,
        didSocketApiUrl: i,
        customMixpanelKey: o,
        enabled: r,
        onError: p
      }
    ) }) }) }) }) }),
    f
  );
  const m = () => {
    clearInterval(u), Ft(null, f), f.parentNode && f.remove();
  };
  return { api: window.DID_AGENTS_API, dataLayer: window.dataLayer, destroy: m };
}
function _i(t) {
  const { token: e, username: n, password: r, clientKey: i } = t;
  if (!i) {
    if (!e) {
      if (!n || !r)
        throw new Error("Failed to load agent. No auth method provided");
      return { type: "basic", username: n, password: r };
    }
    return { type: "bearer", token: e };
  }
  return { type: "key", clientKey: i };
}
const B2 = (t) => {
  const e = {};
  return Array.from(t).forEach((n) => {
    if (n.name.startsWith("data-mixpanel-property-")) {
      const r = n.name.replace("data-mixpanel-property-", "");
      e[r] = n.value;
    }
  }), e;
};
{
  const t = document.querySelector('script[data-name="did-agent"]');
  if (t) {
    const e = new URLSearchParams(""), n = e.get("mode") || (t.getAttribute("data-mode") ?? "fabio"), r = t.getAttribute("data-target-id"), i = e.get("agent_id") || t.getAttribute("data-agent-id"), a = t.getAttribute("data-api-url"), o = t.getAttribute("data-token"), s = t.getAttribute("data-username"), l = t.getAttribute("data-password"), c = e.get("key") || t.getAttribute("data-client-key"), g = e.get("chat_mode") || (t.getAttribute("data-chat-mode") ?? T.Functional), d = t.getAttribute("data-track") !== "false", f = t.getAttribute("data-monitor") !== "false", p = t.getAttribute("data-feature-flag") !== "false", u = t.getAttribute("data-position") ?? "right", m = t.getAttribute("data-orientation") ?? "vertical", y = t.getAttribute("data-external-id") || void 0, C = t.getAttribute("data-mixpanel-key") || void 0, v = B2(t.attributes), M = t.getAttribute("data-speech-silence-timeout-ms") || void 0, k = t.getAttribute("data-auto-connect") === "true";
    if (i) {
      if (!Object.values(T).includes(g))
        throw new Error(`Invalid chat mode, must be one of: ${Object.values(T).join(", ")}`);
    } else throw new Error("No agent id");
    window.DID_AGENTS_API = {};
    const L = { didApiUrl: a, monitor: f, enableFeatureFlags: p }, P = {
      mode: n,
      targetElement: r,
      auth: _i({ token: o, username: s, password: l, clientKey: c }),
      agentId: i,
      track: d,
      chatMode: g,
      position: u,
      orientation: m,
      externalId: y,
      customMixpanelKey: C,
      mixpanelAdditionalProperties: v,
      speechSilenceTimeoutMs: M,
      autoConnect: k
    };
    mi({ ...P, ...L });
  } else
    window.DID_AGENT_INIT = ({ token: e, username: n, password: r, clientKey: i, ...a }) => mi({ ...a, auth: _i({ token: e, username: n, password: r, clientKey: i }) });
}
export {
  _i as getAuth,
  mi as init,
  Z2 as testMode
};
